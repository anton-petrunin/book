%%!TEX root = all.tex
\chapter{Ghost of Riemann}

In Section~\ref{sec:rank+},
we study of the set of points with upper bound on rank.
In this section we use the result about webs and barycentric simplexes (\ref{thm:web})
as well as existence of strongly concave subfunctions in finite dimensional $\Alex{}$ spaces (see ???).
This property will be used later to show that, with exception for a neglectable set, all points in a finite dimensional $\Alex{}$ space can be covered by distance charts.

In dimension 2, the Riemannian metric on Alexandrov spaces
was investigated in ???.
This method was quite successful due to existence of isotropic coordinates.

In higher dimension, it was first studied in \cite{otsu-shioya} and developed further in \cite{perelman:DC}.


\section{Hierarchy of singularities}

Let $\spc{L}$ be a complete length $\Alex{}$ space and $p\in\spc{L}$.
The point $p$ is called 
\emph{regular}\index{regular point}
if $\T_p\iso\EE^m$
or equivalently 
if $\Sigma_p\iso\SS^{m-1}$;
otherwise the point $p$ is called \emph{singular}\index{singular point}.
The set of regular and singular points will be denoted as 
$\Reg=\Reg_{\spc{L}}$ 
and $\Sing=\Sing_{\spc{L}}$ correspondingly.

Next we introduce a  \emph{double hierarchy} of singular points;
it will measure how far the tangent cone is from a product of Euclidean $\kay$-space and a cone.

We say that point $p$ is $\kay$-regular if $\T_p$
contains a copy of $\EE^\kay$;
according to ???, this is equivalent to
$\Sigma_p\ge\SS^{\kay-1}$.
Further, 
according to \ref{thm:tan-split},
a point $p$ is $\kay$-regular if and only if
$\T_p=W\oplus W^\bot$, where $W$ is a subcone of $\T_p$ which is isometric to $\EE^\kay$ 
and $W^\bot$ is its orthogonal complement; that is,
\[W^\bot
\df
\set{v\in\T_p}{\<v,w\>=0\ \t{for any}\ w\in W}.\]
The set of $\kay$-regular and $\kay$-singular points will be denoted as $\Reg(\kay)=\Reg_{\spc{L}}(\kay)$
and $\Sing(\kay)=\Sing_{\spc{L}}(\kay)$ correspondingly.
Clearly 
\begin{itemize}
\item $\Reg(\kay)=\emptyset$ for $\kay>m$;
\item $\Reg(m)=\Reg$;
\item if $\kay\ge n$ then $\Reg(\kay)\subset \Reg(n)$.
\end{itemize}
 
Further we introduce approximate analogs of the above definitions.
Given $\eps>0$ and an integer $\kay\ge 0$,
a point $p\in\spc{L}$ is called \emph{$(\kay,\eps)$-regular}\index{regular point!$(\kay,\eps)$-regular} if
$\Sigma_p>\SS^{\kay-1}-\eps$;
otherwise $p$ is called 
\emph{$(\kay,\eps)$-singular}\index{$(\kay,\eps)$-singular point}.
The set of $(\kay,\eps)$-regular and $(\kay,\eps)$-singular points will be denoted as $\Reg(\kay,\eps)=\Reg_{\spc{L}}(\kay,\eps)$
and $\Sing(\kay,\eps)=\Sing_{\spc{L}}(\kay,\eps)$ correspondingly.

We will be interested in the sets $\Reg(\kay,\eps)$ and $\Sing(\kay,\eps)$ only for sufficiently small values $\eps>0$.

\begin{thm}{Proposition}\label{prop:Reg(k)}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space and $\kay\le m$ and $\eps>0$.
Then 

\begin{subthm}{prop:Reg(k):a}
$\Reg(\kay,\eps)\subset \Reg(\kay,\delta)$ if $\eps<\delta$
and 
\[\Reg(\kay)=\bigcap_{\delta>0}\Reg(\kay,\delta).\]
\end{subthm}

\begin{subthm}{prop:Reg(k):G-delta}
$\Reg(\kay,\eps)$ is an open everywhere dense subset in $\spc{L}$
and 
$\Reg(\kay)$ is a dense G-delta set in $\spc{L}$.
\end{subthm}

\begin{subthm}{prop:Reg(k):convex}
 $\Reg(\kay)$ as well as $\Reg(\kay,\delta)$ are convex sets in $\spc{L}$;
that is, any geodesic with ends from $\Reg(\kay)$ or from $\Reg(\kay,\delta)$ 
lies in $\Reg(\kay)$ or correspondingly in $\Reg(\kay,\delta)$.
\end{subthm}


%\begin{subthm}{prop:Reg(k):rank} Given $\kay$, there is $\delta_0>0$ ($\delta_0=\arcsin\tfrac1\kay$ will do) such that  $\rank_p\ge \kay$ for any $p\in\Reg(\kay,\delta)$ and $\delta<\delta_0$.\end{subthm}

\end{thm}

\parit{Proof.}
Part (\ref{SHORT.prop:Reg(k):a}) is obvious.

The first part of (\ref{SHORT.prop:Reg(k):G-delta}) follows from Corollary~\ref{cor:simicont-Sigma}.
By \ref{E=T},
if $\kay\le m$ then  $\Reg(\kay)$ is everywhere dense in $\spc{L}$.
Hence the set $\Reg(\kay)$ is a dense G-delta set of $\spc{L}$.
Hence the second part follows.

Part (\ref{SHORT.prop:Reg(k):convex}) follows from \ref{cor:reg-conv}.
\qeds


 

Let $f\:\RR^m\subto\RR$ be a semicontinuous subfunction.
Recall that $\Sing_f(\kay,\eps)$ denotes the set of $(\kay,\eps)$-singular points of $f$; this set is defined in Section~\ref{sec:sing-of-conv}.




\begin{thm}{Theorem}\label{thm:reg-point}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space
and $\bm{x}=(x^1,x^2,\dots,x^m)\:\spc{L}\subto\RR^m$ be a distant chart with strut $y\:\spc{L}\subto\RR$.
Set $f=y\circ\bm{x}^{-1}\:\RR^m\subto \RR$.

Then for any $\kay\in\ZZ_+$
and $\eps>0$ there is $\eps'>0$ such that
\[\bm{x}[\Sing_{\spc{L}}(\kay,\eps)]\subset \Sing_f(\kay,\eps').\]

In particular, by Zaj\'{\i}\v{c}ek's theorem~\ref{thm:zajicek}, $\Sing_{\spc{L}}(\kay,\eps)$ is locally $\kay$-rectifiable in $\Dom \bm{x}$. 
\end{thm} 

\parit{Proof.}
Consider map 
\[\map\:\T_p\to\RR^{m+1}\:z\mapsto(\d_py(z),\d_px^1(z),\dots,\d_px^m(z)).\]
Recall that for two arrays $\bm{v},\bm{w}\in\RR^{m+1}$
we write $\bm{v}\preccurlyeq\bm{w}$ if $v^i\le w^i$ for all $i$
(see Section~\ref{sec:web-general}).

Note that the differentials $\d_py$ and each $\d_px^i$ are concave on $\T_p$
(see ???);
therefore for any point $\bm{v}\in\Conv\map(\T_p)$ there is $z\in \T_p$ such that $\bm{v}\preccurlyeq\map(z)$.
It follows that $\bm0\in\partial_{\RR^{m+1}}\Conv \map(\T_p)$.
Moreover there is a choice of positive $\alpha^i$,
such that the vector $(1,\alpha^1,\dots,\alpha^m)\in\RR^{m+1}$
supports $\Conv \map(\T_p)$ at $\bm{0}$; 
that is,
\[\d_py(z)+\sum_i\alpha^i\cdot\d_px^i(z)\le 0
\eqlbl{eq:bary-inq}\]
for any $z\in\T_p$.

Since $f$ is linear on $V$, we have equality in \ref{eq:bary-inq} for any  $z\in W$.
Thus, the set $W$ is a convex subcone in $\T_p$ 
and the restriction $(\d_p\bm{x}|W)$ is affine;
that is, for any geodesic curve $\gamma$ in $W$, 
the composition $\bm{x}\circ\gamma$ is a geodesic curve in $V$.

Therefore the theorem follows from Lemma~\ref{lem:affine=>isom}
and Exercise~\ref{mink+alex=euclid} (the fact that $\T_p$ is geodesic is proved in ???).
Finally, the splitting $\T_p=W\oplus W^\bot$ follows from Toponogov splitting theorem (\ref{thm:splitting}).
\qeds

Let  $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space,
denote by $\spc{L}_{\rank\ge\kay}$ and $\spc{L}_{\rank\le\kay}$ the set of points in $\spc{L}$
with rank $\ge\kay$ or, correspondingly $\le \kay$.
Clearly 
\[\spc{L}_{\rank\le\kay}=\spc{L}\backslash\spc{L}_{\rank\ge\kay+1}\]
for any $\kay$.
Further
\[\spc{L}
=
\spc{L}_{\rank\ge0}\supset\spc{L}_{\rank\ge1}\supset\dots\subset\spc{L}_{\rank\ge m}\supset\spc{L}_{\rank\ge m+1}=\emptyset.
\]
Recall that according to ???, $\spc{L}_{\rank\ge\kay}$ is an open subset of $\spc{L}$ which is also everywhere dense for any $\kay\le m$.

\begin{thm}{Theorem}\label{thm:rank+rect}
Let  $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space.
Then $\spc{L}_{\rank\le\kay}$ is locally $\kay$-rectifiable in $\spc{L}_{\rank\ge\kay}$.
\end{thm}







\section{Smooth points in distant chart}

\begin{thm}{Definition}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space
and $\bm{x}=(x^1,x^2,\dots,x^m)\:\spc{L}\subto\RR^m$ be a distant chart with strut $y\:\spc{L}\subto\RR$.
Set $f=y\circ\bm{x}^{-1}\:\RR^m\subto \RR$.

We say that the distance chart is 
\emph{differentiable}\index{differentiable distance chart} at 
point $p\in\Dom\bm{x}$ 
if the function $f$ is differentiable at $\bm{w}=\bm{x}(p)$.

We say that the distance chart is 
\emph{twice differentiable}\index{twice differentiable distance chart} at 
point $p\in\Dom\bm{x}$ 
if the function $f$ is twice Peano-differentiable at $\bm{w}=\bm{x}(p)$;
that is, if there are a linear and bilinear forms 
$\d_{\bm{w}}f$ 
and 
$\Hess_{\bm{w}}f$
on $\RR^m$ such that
\[f(\bm{w}+\bm{v})
=
f(\bm{w})
+
(\d_{\bm{w}}f)(\bm{v})
+
(\Hess_{\bm{w}}f)(\bm{v},\bm{v})
+
o(|\bm{v}|^2).
\]

\end{thm}

The reason for this definition will become clear in theorems ??? and ???.

Note that according to ???, 
Rademacher's theorem (\ref{thm:rademacher}) 
and Alexandrov's theorem (\ref{thm:alexandrov-f''})
the distance chart is differentiable and twice differentiable at 
almost all points.




\begin{thm}{Theorem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space and $\bm{x}\:\spc{L}\subto\RR^m$ be a distance chart and $\Omega=\Im\bm{x}\subset\RR^m$. 
Let $f\:\Im\bm{x}\to\RR$ be a locally Lipshcitz function,
then $f\circ\bm{x}$ is locally 1-Lipschitz if and only if
$\bm{g}(d_{\bm{w}}f,d_{\bm{w}}f)\le 1$ for almost all $\bm{w}\in\Omega$.
\end{thm}




\begin{thm}{Corollary}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space and $\Euk^m=\Euk^m\spc{L}$ be the subset of all points $p\in \spc{L}$ such that $\T_p\iso\EE^m$. 
Then $\Euk^m\spc{L}$ contains almost all points of $\spc{L}$.

Moreover, the set 
$\spc{L}\backslash\Euk^m$ is countably $(m-1)$-rectifible;
that is, it can be presented as a countable union of $(m-1)$-rectifible sets.
\end{thm}

\parit{Proof.}
Recall that the set $\spc{L}\backslash\Reg(\kay)$ is countably $(\kay-1)$-rectifiable, see \ref{cor:k-str=>k-rect}.

Clearly, any point in $\Reg(m)$ can be covered by a distance chart. 
Thus, it reamins to show that set of singular points in the domain of a distance chart is countably $(m-1)$-rectifiable.

Let $\bm{x}\:\spc{L}\subto\RR^m$ be a distant chart with strut $y$.
By Perelman's lemma (\ref{thm:inverse-function:concave}) $f\z=y\circ\bm{x}^{-1}\:\RR^m\subto \RR$ is semiconcave.
Thus, according to Zaj\'{\i}\v{c}ek's theorem (\ref{thm:zajicek}),
$f$ is differentiable outside of a countably $(m-1)$-rectifible set in $\Im \bm{x}$.
Thus, according to Theorem~\ref{thm:reg-point}, 
$\Dom\bm{x}\backslash\Euk^m$ is countably $(m-1)$-rectifible.
\qeds



\begin{thm}{Definition}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space, $a^i,b,p\in\spc{L}$

Assume $\dist{\bm{a}}{}{}=(\dist{a^1}{}{},\dist{a^2}{}{},\dots,\dist{a^m}{}{})$ 
give a distance chart with stutt $\dist{b}{}{}$
in an open set $\Omega\subset\spc{L}$.
The following matrix 
$g^{ij}(p)=\<\nabla_p x^i,\nabla_p x^j\>$,
will be called \emph{metric tensor} of $\spc{L}$
at $p$ in the distance chart $\bm{x}$.
We say that $g^{ij}$ is defined if the hinge $\hinge{p}{a^i}{a^j}$ is unique.
\end{thm}


\begin{thm}{Theorem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space
and $\bm{x}=(x^1,x^2,\dots,x^m)\:\spc{L}\subto\RR^m$ be a distant chart with strut $y\:\spc{L}\subto\RR$.
Assume $f=y\circ\bm{x}^{-1}$ is differentiable at $\bm{x}(p)$
then the metric tensor of $\spc{L}$ is continuous at $p$.

Moreover if $\spc{L}_n$ is a sequence of $m$-dimensional complete length $\Alex{}$ spaces,
$\spc{L}_n\GHto\spc{L}$,
and $\bm{x}_n\:\spc{L}_n\to\RR^m$ with $y_n\:\spc{L}_n\to\RR$ be the liftings of the distance chart $\bm{x}$ with strutt $y$ then
for any lifting $\spc{L}_n\ni p_n\GH\to p$, we have
\[g_n(p_n)\to g(p)\]
where $g_n$ denotes the metric tensor of $\spc{L}_n$ in $\bm{x}_n$.
\end{thm}




\section{Short volume preserving maps}

A closely related statement to following theorem 
was proved by Li, see \cite[Theorem A]{li}.

\begin{thm}{Theorem}\label{thm:li}
Let $\spc{L},\spc{M}$ be $m$-dimensional complete length $\Alex{}$ spaces
and $\map\:\spc{L}\subto \spc{M}$ 
be a short volume preserving submap;
that is,
\[\vol_m[\map(A)]=\vol_m A\]
for any Borel set $A\subset \Dom \map$.
Assume $\Dom\map\cap\partial\spc{L}=\emptyset$.
Then $\map$
is locally distance preserving;
that is, for any $p\in \Dom \map$
there is a neighborhood $\Omega\ni p$
such that the restriction $\map|\Omega$ is distance preserving.
\end{thm}

\begin{thm}{Lemma}\label{lem:almost-li}
Given a positive integer $m$ and $\eps>0$  
there is $\delta>0$ 
such that the following holds.

If $\Omega\subset\EE^m$ is an open subset
and $f\:\Omega\to\EE^m$ is a $e^\delta$-Lipschitz map
such that 
\[\vol_m [f(A)]\ge e^{-\delta}\cdot\vol_m A\]
for any Borel set $A\subset \Omega$.
Then $f$ is locally $e^{\mp\eps}$-bi-Lipschitz.
\end{thm}

\parit{Proof.}
It is sufficient to show that if $x,y\in \Omega$
be a pair of points such that $\cBall(x,10\cdot|x-y|)\subset\Omega$
then 
\[|f(x)-f(y)|\ge???\cdot|x-y|.\]

Further set $x'=f(x)$, $y'=f(y)$
and %???+PIC
\begin{align*}
W&=\cBall[x,|x-y|]\cup\cBall[y,|x-y|],
\\
W'&=\cBall[x',e^\delta\cdot|x-y|]\cup\cBall[y',e^\delta\cdot|x-y|].
\end{align*}

Since $f$ is $e^\delta$-Lipschitz, we get
\[f(W)\subset W'.\]
Since $f$ is volume non-decreasing,
\[\vol_m W
\le
\vol_mW'.
\]
Note that $\vol_mW'$ is completely determined by three real numbers
$|x'-y'|$, $|x-y|$ and $\delta$ and the function
\[f\:(|x'-y'|,|x-y|,\delta)\mapsto\vol_mW'\] is continuous.
Further $f(|x-y|,|x-y|,0)=\vol_mW$.
Hence the result follows.
\qeds

\parit{Proof of Theorem~\ref{thm:li}.}
Given $\delta>0$,
denote by $\Omega_\delta$ the subset of all $\delta$-regular points in $\Omega$.
First let us prove the following.

\begin{clm}{}\label{omega-delta}
Given $\eps>0$ there is $\delta>0$
such that the restriction $\map|\Omega_\delta$ is injective and locally $e^{\mp\eps}$-bi-Lipschitz.
\end{clm}

According to ???,
for any point $x\in \Omega_\delta$ 
there is ???-bi-Lipschitz chart $\phi\:\spc{L}\subto\EE^m$
with $\Dom\phi\ni x$.

In particular 
\[\vol_m\cBall[x,r]\ge (\alpha_m-???)\cdot r^m\]
for all small $r>0$.

Note that $\map(\cBall[x,r])\subset \cBall[\map(x),r]$.
Therefore 
\[\vol_m(\cBall[\map(x),r])
\ge
(\alpha_m-???)\cdot r^m\]
for all small $r>0$.
According to ???, $\map(x)$ is a ???-regular point.
According to ???, there is a ???-bi-Lipschitz chart $\psi\:\spc{M}\subto\EE^m$
with $\Dom\phi\ni \map(x)$.

Note that ???,
that is, we can apply Lemma~\ref{lem:almost-li}
to the composition 
\[\psi\circ\map\circ\phi^{-1}\:\EE^m\subto\EE^m.\]
Hence Claim \ref{omega-delta} follows.


Set $\mathfrak{C}_\delta=\Omega\backslash \Omega_\delta$.
Since $\Omega\cap\partial\spc{L}=\emptyset$,
Theorem ??? implies that $\HausDim\mathfrak{C}_\delta<m-1$.
Since $\map$ is Lipschitz, we get 
\[\HausDim[\map(\mathfrak{C}_\delta)]<m-1.\]

In particular???, for any fixed point $p\notin\map(\mathfrak{C}_\delta)$
\[[px]\cap \map(\mathfrak{C}_\delta)\ae\emptyset;\]
that is, for almost all $x\in\spc{M}$ any geodesic $[px]$ has no points in $\map(\mathfrak{C}_\delta)$.

Fix two points $x$ and $y$ in $\Omega$ which are sufficiently close to each other, 
say $x$ and $y$ 
are such that $\cBall[x,10\cdot\dist{x}{y}{}]\subset\Omega$.
Set $x'=\map(x)$ and $y'=\map(y)$.
Clearly 
\[\dist{x'}{y'}{}
\le
e^{\eps}\cdot\dist{x}{y}{}\]
Let us show that
\[\dist{x'}{y'}{}
\ge
e^{-\eps}\cdot\dist{x}{y}{}
\eqlbl{eq:|x'y'|}\]

Since $\map$ is Lipschitz, 
it is sufficient to consider the case $x,y\in \Omega_\delta$;
in particular $x',y'\in\map(\Omega_\delta)$.
Let $w$ be the midpoint of $[x'y']$,
From above, we can choose a point $z$ arbitrary close to $w$
such that both geodesics $[x'z]$ and $[y'z]$ do not intersect 
$\Phi(\mathfrak{C})$.
Note that if $[x'z]$ or $[y'z]$ lie in $\map(\Omega_\delta)$
then \ref{eq:|x'y'|} follows.

Since $\map$ is bi-Lipschitz 
has points in $\partial [\map(\Omega_\delta)]$.
Note that $\partial [\map(\Omega_\delta)]=\map(\mathfrak{C}_\delta)\cup\partial[\map(\Omega)]$.
From above, we can fix $z$ arbitrary close to $w$
such that both $[x'z]$ and $[y'z]$
do not have points in $\map(\mathfrak{C}_\delta)$.
for almost all $z$.
In this case we can assume that $[x'z]$ has points in $\partial[\map(\Omega)]$.
Let $\bar z\in [x'z]\cap\partial[\map(\Omega)]$ be the closest point to $x'$.
Note that $\l[x'\bar z\r[$ lies in $\map(\Omega_\delta)$


The later implies that $\map(\partial \Omega_\delta)\cap \oBall(x',???)$ has Hausdorff dimension at least $m-1$,
a contradiction.
\qeds



\section{Remarks and open problems}

\parbf{Coarea formula.}
We decided to use only the most basic form of coarea formula
in order to keep things simple.
Alternatively, our coarea formula can be obtained
by a minor modification of Federer's proof,
in a way similar to what is explained in \cite[3.2.46]{federer}.
Our coarea formula can be also obtained as a corollary of these theorems in ???, ??? and ???, where a generalized versions of coarea formula were obtained in a context of general metric spaces.

Is it true that image of any $\DC$-map $\RR^\kay\to\RR^m$ can be covered by countable number of $\DC$-graphs? 
That might give a nice description of the set of singular points as image of a countable collection of DC-maps from $\RR^{m-1}$ --- a $\DC$-map $\map\:\RR^\kay\to\spc{L}$ can be defined as a map such that for any $p\in\spc{L}$, the composition $\dist{p}{}{}\circ\map$ is a $\DC$-function.

The following question was asked by A.~Lytchak.

\begin{thm}{Open problem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex\kappa$ space.
Assume that for some $p\in \spc{L}$ and $R>0$,
\[\vol_m\oBall(p,2\cdot R)\ge (1-\eps)\cdot\vol_m\cBall[2\cdot R]_{\EE^m}.\]
Is it true that there is a constant $\Const=\Const(m)$ such that
\[\GHdist(\cBall[p,R],\cBall[R]_{\EE^m})\le \Const\cdot\eps.\]
\end{thm}

\begin{thm}{Open problem}
Is it true that $\spc{L}\backslash\Reg^{\kay+1}$ 
is locally $\kay$-rectifiable for any $m$-dimensional complete length $\Alex{}$ space $\spc{L}$?
\end{thm}


\section{???Strongly concave functions}

The following proposition follows directly from Proposition~\ref{prop:conv-comp}.

\begin{thm}{Proposition}\label{prop:conv-comp-cbb}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space, 
$\bm{a}=(a^1,a^2,\dots,a^\kay)$ be an array of points in $\spc{L}$
and $\phi\:\RR\to\RR$ is an increasing concave function.

Given a point $p\in \spc{L}$ distinct from each $a^i$,
 consider the function
$$f(x)=\sum_{i=1}^\kay\phi(\dist{a^i}{x}{}-\dist{a^i}{p}{}).$$
Assume $\lambda^1,\lambda^2,\dots,\lambda^\kay$ are real numbers such that
$\dist[\prime\prime]{a^i}{}{}(p)\le\lambda^i$ for each $i$
and $\theta\ge 0$ is such that
$$|\dist{\bm{a}}{x}{}-\dist{\bm{a}}{x}{}|
\ge 
\theta\cdot\dist[{{}}]{x}{y}{}$$
for any points $x$ and $y$ in a neighborhood of $p$.

Then 
$$f''(p)\le \phi''(0)\cdot \theta^2+\phi'(0)\cdot\lambda^i.$$

\end{thm}


\begin{thm}{Theorem}\label{thm:concave-thereis}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space.
Then for any $p\in\spc{L}$ there is a strongly concave subfunction $f\: \spc{L}\to\RR$ with
$\Dom f\ni p$.

Moreover, given a direction $\xi\in\Sigma_p$  and $\eps>0$,
the function $f$ can be chousen 
$f=\sum\phi(\dist{a^i}{x}{}-\dist{a^i}{p}{})$
for a smooth increasing concave subfunction $\phi$ with $\Dom \phi\ni0$
and an array of points $(a^1,a^2,\dots,a^\kay)$ in $\spc{L}$
such that $\mangle(\xi,\dir p{a^i})<\eps$. 
\end{thm}

\parit{Proof.}
Applying Theorem~\ref{thm:dist-emb},
we can choose a point array $\bm{a}=(a^1,a^2,\dots,a^\kay)$ so that for some $\eps>0$
the distance map $\dist{\bm{a}}{}{}$ defines an $[\eps,\kay]$-bi-Lipschitz embedding 
of $\oBall(p,\eps)$.

Applying Proposition~\ref{prop:conv-comp-cbb},
for $\phi(x)={\tfrac1\kay}\cdot x-\tfrac{b}{\kay}\cdot x^2$ 
with sufficiently large $b$, we get the first part of the theorem.

To prove the second part choose $z\in\Str(p)$ so that $\mangle(\xi, \dir{p}{z})<\eps$.
Since geodesic $[pz]$ is unique,
we have $\mangle\hinge pxz\to 0$ as $x\to z$.
It follows that for sufficiently small radius $r>0$
we have 
$\mangle(\xi,\dir px)<\eps$
for any $x\in\oBall(z,r)$.

Applying Theorem~\ref{thm:dist-emb}, we can choose a point array $\bm{a}=(a^1,a^2,\dots,a^\kay)$ in $\oBall(z,r)$ such that the distance map $\dist{\bm{a}}{}{}$ defines an $[\eps,\kay]$-bi-Lipschitz embedding 
of $\oBall(p,\eps)$ for some $\eps>0$.
Then apply Proposition~\ref{prop:conv-comp-cbb} the same way as above, we get the second part of theorem.
\qeds


\begin{thm}{Theorem}\label{thm:rank=kay}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space,
$p\in\spc{L}$ and $\rank_p=\kay\le m$.
Then there is Lipschitz submap $\sigma_p\:\RR^\kay\subto\spc{L}$
and a neigborhood $\Omega\ni p$
such that for any $q\in\Omega$ we have 
$\rank_q\ge \kay$  
and in case of equality we have $q\in\Im \sigma_p$.
\end{thm}

This theorem implies in particular that the set of points with rank zero in a finite-dimensional complete length $\Alex{}$ space consists of isolated points. 
On the contrary the set of points of rank zero in a Hilbert cube %(see ???)
is homeomorphic to the Cantor set;
thus the conlussion of the above theorem does not hold in infinite dimensional case.

\parit{Proof.}
Choose array of directions $\xi_0,\xi_1,\dots,\xi_\kay\in\Sigma_p$ 
such that $\mangle(\xi_i,\xi_j)>\tfrac\pi2$ for all $i\not=j$.

Apply the second part of Theorem~\ref{thm:concave-thereis} for each direction $\xi_i$ and sufficiently small $\eps>0$
(any $\eps>0$ such that $10\cdot\eps< \mangle(\xi_i,\xi_j)-\tfrac\pi2$ for all $i\not=j$ will do).
Let us denote by $f_0,f_1,\dots, f_\kay$ the constructed subfunctions.

From the existance of convex neighborhood (\ref{thm:convex-nbhd}),
we can assume that $\Omega$ is the interior of 
a compact convex set $K\subset \oBall(p,\eps)$.

Hence we are in position to apply Theorem~\ref{thm:web} to the space $K$ 
and the function array $(-f^0,-f^1,\dots,-f^\kay)$.
Set $\sigma_p$ to be the corresponding baricentric map;
this is a Lipschitz map from $\Delta^\kay$ to $K$. 

Take any $x\in\Omega\backslash\Im \sigma_p$.
According to Theorem~\ref{thm:web},
there is a point $y\in K$ such that $f^i(y)>f^i(x)$ for each $i$.
Since $f^i$ are strongly concave,
we get 
\[f^i(\bar y)>f^i(x)+\eps\cdot\dist[{{}}]x{\bar y}{}+o(\dist{x}{\bar y}{})\] 
for each $i$ and $\bar y\in \l]xy\r]$.
In particular, for each $i$, 
we can choose $\bar a^i=a^{i,j(i)}$  such that
\[\mangle\hinge{x}{\bar a^i}{y}>\tfrac\pi2.\]
According to Strong angle lemma (\ref{lem:strong-angle}),
for any $\bar y\in\l]xy\r]$ sufficiently close to $x$ we have
\[\angk{\kappa}{x}{\bar a^i}{\bar y}>\tfrac\pi2;\]
that is, the array $(\bar  a^0,\bar  a^1,\dots,\bar  a^\kay,\bar y)$ strutts $x$.
\qeds


\section{Riemannian metric}

First, let us show that Riemannian metric in the distance chart of a $\Alex{}$ space is defined almost everywhere.

Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space
and $\bm{x}\:\spc{L}\subto\RR^m$ be a distance chart with a strutt $y\:\spc{L}\subto\RR$.
According to ???, $\bm{x}$ is bi-Lipschitz.
Therfore Rademacher's theorem (???) implies that
for almost all points $\bm{z}\in\Im\bm{x}\subset\RR^m$,
the differential 
$\d_{\bm{z}}\bm{x}^{-1}\:\RR^m
\to
\T_{\bm{x}(\bm{z})}$ 
is defined and linear 
and the map $\bm{g}(\bm{z})\:\bm{v}\mapsto|\d_{\bm{z}}\bm{x}^{-1}(\bm{v})|^2$
is a quadratic form.
The quadratic form $\bm{g}=\bm{g}(\bm{z})$ is the Riemannian metric $\spc{L}$ in the chart $\bm{x}$.

\begin{thm}{Proposition}
Let $\spc{L}_1,\spc{L}_2,\dots,\spc{L}_\infty$ be an $m$-dimensional complete length $\Alex\kappa$ spaces
and $\GH\:\spc{L}_n\GHto \spc{L}_\infty$.

???

Denote by $\bm{g}_n$ and $\bm{g}_\infty$ the Riemannian metrics of $\spc{L}_n$ and $\spc{L}_\infty$ in the distance charts $\bm{x}_n$ and $\bm{x}_\infty$.

Then $g_n$ converges to $g$ almost everywhere. 
\end{thm}

\parit{Proof.}
??? I see two ways. First to use few strutts and Riemann expression for metric tensor then use tha $g$ can be expressed through the derivatives of strutts.
Second more direct using  simcontinuity of angles.
???
\qeds












\section{Lipschitz vs. Sobolev}

The following theorem roughly states that class of Lipschitz functions on a finite dimensional $\Alex{}$ space 
coinsides with class of Sobolev functions $W^{1,\infty}$;
moreover for any such functions $f$ we have $\lip f=\|f\|_{1,\infty}$. 

\parbf{Remark for AKP.} 
Maybe we will need $\lip$ and $\lip_{loc}$???

\begin{thm}{Theorem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space and $f\:\spc{L}\subto\RR$ be a locally Lipschhtz subfunction.
Then $f$ is locally $1$-Lipschitz if and only if $\|\d_pf\|\le1$ almosteverywhere in $\Dom f$.

Moreover, if $\Dom f=\spc{L}$ then for any functions $f$
$\lip f=\|f\|_{1,\infty}$
\end{thm}

\parbf{Remark for AKP.} I see how to prove it using Bishop--Gromov inequality.
Is there a better way?

\parit{Proof.}
First note that for any a locally Lipschitz subfunction $f:\spc{L}\subto\RR$,
its differential is defined almost everywhere ???.

Further, assume $f:\spc{L}\subto\RR$ is locally Lipschitz subfunction which is not locally $1$-Lipschitz.
I.e. for some point $p\in \Dom f$, given $\eps>0$ there are points $x,z\in\oBall(p,\eps)$ such that $|f(x)-f(z)|>\dist{x}{z}{}$.
Then some small $\delta>0$,
$|f(x)-f(y)|>\dist{x}{y}{}$
for any $y\in\oBall(z,\eps)$.
Choose a geodesic $[xy]$ for each point $y\in\oBall(z,\eps)$
and let $\gamma_y$ be corresponding geodesic path;
that is, $\gamma_y(t)=\geod_{[x y]}(\tfrac{t}{\dist{x}{y}{}})$.

Note that if $A\subset \spc{L}$ contains almost all points of $\spc{L}$ then for some point $y\in\oBall(z,\eps)$, we have $\gamma_y(t)\in A$ for almost all values $t\in[0,1]$.
Thus 
\[|f(y)-f(x)|
\le
\int\limits_0^1\d_{\gamma_y(t)}f(\gamma_y^+)\cdot\d t
\le
\dist{x}{y}{}.\]

\qeds

\section{$\DC'$-metric tensor}

Assume $g$ be a metric tensor,
which is positive definite and defined almost everywhere in an open domain $U\in\RR^m$.
Let us define a metric on $U$ by setting
\[\dist{x}{y}{}
=
\sup_f{|f(x)-f(y)|},\]
where $f$ runs along all locally Lipschitz functions on $U$, such that $g(\d f,\d f)\le 1$ almost everywhere in $U$.
This metric can be used to define \emph{length structure}\index{length structure} on $U$;
that is, define given a curve $\alpha\:[a,b]\to U$, 
set 
\[\length_g\alpha=\sup\sum_{i=1}^n\dist{\alpha(t_{i-1})}{\alpha(t_{i})}{},\]
where supremum is taken for all partitions $a=t_0<t_1<\dots<t_n=b$.

Change of coordinates???

\begin{thm}{Theorem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space 
and $\bm{x}=(x^1,x^2,\dots,x^m)\:\spc{L}\to\RR^m$ be a distant chart, $x^i=\dist{p_i}{}{}|{\Dom \bm{x}}$.
Then metric tensor $g$ on $\Im\bm{x}$
defined as $g^{ij}(\bm{x}(q))=\cos\mangle\hinge{q}{p^i}{p^j}$ 
is positive definite almost everywhere 
and the pullback of length structure induced  by $g$ 
coinsides with length structure on $\spc{L}$;
that is, 
\[\length_g\bm{x}\circ\alpha=\length\circ\alpha.\] 
for any curve $\alpha\:[a,b]\to \Dom\bm{x}$.
\end{thm}

Our next aim is to show that defined metric tensor is sufficientl regular.
Let us construct the metric tensor, using a bunch of distant functions.
The following construction appears already in the Riemann's lecture. 

For $q\in\spc{L}$,
consider function $y=\bm{x}^{-1}\circ\dist{q}{}{}$ on $\Im\bm{x}$.
Clearly, 
$g(\d y,\d y)\ae1$, 
or
\[g^{ij}\cdot\partial_iy\cdot\partial_jy
\ae
1.
\eqlbl{eq:riemann}\]
I.e., for any point $q$,
we have a linear equasion \ref{eq:riemann} on components $g^{ij}$ of metric tensor.
Thus, to detrmine the metric tensor $g^{ij}$, 
it is sufficient to provide an array of points $(q^1,q^2,\dots, q^s)$ in $\spc{L}$ 
such that system of equasions for different $y^\kay=\dist{q^\kay}{}{}$ 
completely determins $g^{ij}$ almost everywhere in $\Im\bm{x}$.
(The idea of determining metric tensor using \ref{eq:riemann}
noticed already by Riemann in \cite{riemann},
but we did not see it used untill the paper of Perelman.)

Given an array of points 

Note that for any regular point $p$ of distant chart $\bm{x}$ there is a collection of points $q^1,q^2,\dots,q^{m(m+1)/2}$ such that the determinat of $\tfrac{n}{2}\cdot(n+1)\times\tfrac{n}{2}\cdot(n+1) $-matrix with components
\[a_{(i,j)\ \alpha}=\partial_iy_\alpha\cdot\partial_jy_\alpha\]
is bounded away from zero almost everywhere in a neigborhood of $p$.

Indeed that is easy to arange in case $\spc{L}\iso\EE^m$ with linear coordinate chart around $p$.
Since $\lam\blow(\spc{L})\GHto\T_p\iso\EE^m$???,

\begin{thm}{Theorem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space.
Then components of metric tensor in distance chart belong to $\DC'$.
\end{thm}

\begin{thm}{Theorem}
Assume $g_1$ and $g_2$ be two metric tensors defined on an open domain $U\subset\RR^m$ with components in $\DC'$
 then if $\length_{g_1}\equiv\length_{g_2}$ if and only if $g_1\ae g_2$. 
\end{thm}












\section{Riemannian metric}

Let $U$ be an open domain in $\RR^m$.
Assume that for each $\bm{x}\in U$ given a choice of a convex subset $G_{\bm{x}}$ in the space of quadratic forms on $\RR^m$.
Such a choice will be called \emph{meric tensor} on $U$.

A metric tensor is said to be semicontinuous if for any sequence $\bm{x}_n\to\bm{x}_\infty\in U$ and for any seqence $g_n\in G_{\bm{x}_n}$ we have 
$g_n(\bm{x}_\infty-\bm{x}_n)$



Let  $U$ be an open domain in $\RR^m$.
A choice of a linear subspace $V_x\subset \RR^m$.
at each point $\bm{x}\in U$, will be called ??? \emph{distribution}\index{distribution} on $U$.
(The dimension of $V_x$ might depend on $x$.)
A distribution will be called \emph{almost complete???}\index{almost complete??? distribution}
if for any Lipschitz curve $\alpha\:\II\to U$,
we have $\alpha'(t)\in V_{\alpha(t)}$ for almost all $t\in\II$.

Let $U$ be an open domain in $\RR^m$ with a distribution $V$.
An open bi-Lipschitz embedding $\map\:U\to \RR^m$ is called $V$-smooth if 
$\d_x\map$ is defined for each $x$ and lenar on $V_x$.

Further, let $V_x$ be an almost complete distribution on $U\subset \RR^m$
and at each point $x$ there is a choice of quadratic form $g=g(x)$ on $V_x$.
 

\parbf{Otsu--Shioya atlas.}
For an $m$-dimensional complete length $\Alex{}$ space $\spc{L}$, let us denote by $???$ the class of all Otsu--Shioya charts.
Given $\bm{f}\in???$, note that $\d_x\bm{f}\:\Lin_p\to\RR^m$ is a linear map.
In particular for any pair of Otsu--Shioya carts,
the transition map ??? is differentable almost everywhere and more over,
for any Lipschitz curve $\gamma$

Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space 
and $\bm{f}=(f^1,f^2,\dots,f^m)\:\spc{L}\subto\RR^m$ be ???chart.
Let us define tensor $g^{ij}(\bm{f}(x))=\<\nabla_x f^i,\nabla_x f^j\>$.

\begin{thm}{Theorem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex\kappa$ space
and $\bm{v}\:\spc{L}\subto\RR^m$ be a Otsu--Shioya chart.
Let us defines a Riemannian metric on $\Im \bm{v}$ the following way:???
Then the components $g_{ij}$ are functions of bounded variation and  continous in $\bm{v}(\spc{L}^{reg}$.
for any Lipschitz curve $\gamma\:[a,b]\to\Dom\bm{v}$, we have
\[\length\gamma= ???.\]


Morover, 

for each distance chart 
the metric tensor $g_{ij}=\<\partial_i,\partial_j\>$ is in class BV???

for each Otsu--Shioya chart 
the metric tensor $g_{ij}=\<\partial_i,\partial_j\>$ is in class BV$_0$???
\end{thm}


\section{???}

The other series is the regularity results on an Alexandrov's space. 
These results obtained in \cite{perelman:DC} are improvements of earlier results in \cite{otsu-shioya}, \cite{otsu:second-der}. 
It use mainly
Corollary~\ref{cor:conv-chart} and the smoothing trick; see Subsection~\ref{smooth}. 
\begin{itemize}
\item Components of metric tensor of an Alexandrov's space in a chart are continuous
at each Euclidean point\footnote{that is, at each point with Euclidean tangent
space}. 
Moreover they have bounded variation and are differentiable almost everywhere.
\item The Christoffel symbols  in a chart are defined as signed Radon measures.
\item Hessian of a semiconcave function on an Alexandrov's space is defined almost
everywhere. I.e. if $f\:\spc{L}\subto\RR$ is a semiconcave subfunction, then for almost
any $x_0\in \Dom\bm{f}$ there is a symmetric bi-linear form $\Hess_f$ such that
\[f(x)=f(x_0)+(\d_{x_0}f)(v)+\Hess_f(v,v)+o(|v|^2),\]
where $v=\ddir{x_0}x$. 
Moreover, $\Hess_f$ can be calculated using  standard formulas in the above
chart.
\end{itemize}








\section{Regularity of web embedding}\label{sec:web-embedding}

Let $\spc{U}$ be an $m$-dimensional complete length $\CAT{}$ space
and $\map\:\RR^m\subto \spc{U}$ is a web embedding with strutt
$\dist{b}{}{}$.
According to Theorem~\ref{thm:loc-lip-inverse} the function $f=\dist{b}{}{}\circ\map$ is locally Lipchitz and semiconvex.
In particular, 
\begin{itemize}
\item according to Rademacher's theorem (???), $f$ is differentiable almost everywhere in $\Dom f$.
\item according to Alexandrov's theorem (???), 
$f$ is twice Peano-differentiable almost everywhere in $\Dom f$;
that is, there are 
linear form $d_{\bm{x}}f$ 
and a bilinear form $\Hess_{\bm{x}}f$ 
on $\RR^\kay$ 
such that
\[f(\bm{x}+\bm{y})
=
f(\bm{x})+[\d_{\bm{x}}f](\bm{y})+[\Hess_{\bm{x}}f](\bm{y},\bm{y})
+o(|\bm{y}|^2).\] 
\end{itemize}
The following theorem states the consequences for $\map$ 
of the differentiability of $f$ at a given point. 


\begin{thm}{Theorem}\label{thm:loc-lip-inverse+}
Let $\spc{U}$ be an $m$-dimensional complete length $\CAT\kappa$ space, 
$\bm{a}=(a^0,a^1,\dots a^m)$ be a nondegenerate point array in $\spc{U}$
and $\map\:\RR^m\subto\spc{U}$ be the $\dist{\bm{a}}{}{}$-web embedding 
with strutt $\dist{a^0}{}{}$.

Set $f=\dist{a^0}{}{}\circ\map$.
For $\bm{y}_0$ and $\bm{y}_1\in\Dom\map$,
set $\bm{y}_t=(1-t)\cdot \bm{y}_0+t\cdot \bm{y}_1 $, $t\in [0,1]$
and $r=\max\{|\bm{y}_0-\bm{x}|,|\bm{y}_1-\bm{x}|\}$.

\begin{subthm}{}
If $f$ is differentiable at $\bm{x}$ then so is $\map$.
Moreover, $\map$ is almost affine at $\bm{x}$;
that is,
\[\dist{\map(\bm{y}_0)}{\map(\bm{y}_t)}{}
=
t
\cdot
\l[
\dist{\map(\bm{y}_0)}{\map(\bm{y}_1)}{}
+
o(r)
\r].
\]
and 
\[
\dist{\map(\bm{y}_1)}{\map(\bm{y}_0)}{}
\lege
|\d_{\bm{x}}f(\bm{y}_1-\bm{y}_0)|(1\pm\eps(r))%???EPS???
\]

\end{subthm}

\begin{subthm}{}
If $f$ is twice Piano-differentiable at $\bm{x}$ 
then 
\[\dist{\map(\bm{y}_0)}{\map(\bm{y}_t)}{}
=
t
\cdot
\l[
\dist{\map(\bm{y}_0)}{\map(\bm{y}_1)}{}
+
O(r^2)
\r].
\]
\end{subthm}

\end{thm}
%???for sba: do we need it???

\parbf{Remark for AKP.}
The Lemma~\ref{lem:affine=>isom} might help.











\parit{Proof.} 
According to Rademacher's theorem (\ref{thm:rademacher}) 
$v\mapsto |\d_{\bm{x}}\map(v)|^2$
is a quadratic form.
Note that $\dist{\bm{a}^{\without 0}}{}{}$ is $m$-Lipshitz;
therefore $|\d_{\bm{x}}\map(v)|>\tfrac1{m^2}>0$.
In particular, 
\[
\|\bm{y}\|
\df
|\d_{\bm{x}}\map(\bm{y})|
\eqlbl{eq:diff-isom}
\]
defines a Euclidean norm $\|{*}\|$ on $\RR^m$.

Let $\bm{y}_0,\bm{y}_1\in\oBall(\bm{x},r)$;
the equality \ref{eq:diff-isom} can be rewritten as
\[\dist{\map(\bm{y}_0)}{\map(\bm{y}_1)}{}=\|\bm{y}_1-\bm{y}_2\|+o(r).
\eqlbl{eq:almost-isom}\]

The next claim states that $\map$ is almost affine at $\bm{x}$;
this will be used to get a stronger verssion of \ref{eq:almost-isom}.

\begin{clm}{}\label{clm:almost-affine}
For $\bm{y}_0,\bm{y}_1\in\oBall(\bm{x},r)$
\[\dist{\map(\bm{y}_0)}{\map(\bm{y}_t)}{}
=
t
\cdot
\l[
\dist{\map(\bm{y}_0)}{\map(\bm{y}_1)}{}
+
o(r)
\r]
\eqlbl{eq:diff=affine}
\]
where 
$\bm{y}_t=(1-t)\cdot \bm{y}_0+t\cdot o(r)$ and $t\in [0,1]$.
\end{clm}

\parit{Proof of the claim.}
Set $f=(\dist{a^0}{}{})\circ\map$.
Accordig to ???,
that $f$ is convex.
Define
\[\delta
=
\sup
\set{|\d_{\bm{x}}f(\bm{v})-\d_{\bm{y}}f(\bm{v})|}%
{\bm{y}\in\oBall(\bm{x},r)\ \t{and}\ |\bm{v}|=1}.\]
Since $f$ is differentiable at $\bm{x}$,
we have $\delta\to 0$ as $r\to0$.
Hence we get 
\[f(\bm{y}_t)
\ge 
(1-t)\cdot f(\bm{y}_0)+t\cdot f(\bm{y}_1)-t\cdot o(r).
\eqlbl{eq:f(y_t)}\]

Further, set 
\begin{align*}
 p_0&=\map(\bm{y}_0),
&p_1&=\map(\bm{y}_1),
&p_t&=\map(\bm{y}_t),
&b_t&=\geodpath_{[p_0p_1]}(t).
\end{align*}

Fix $i>0$.
Since the distance function $\dist{a^i}{}{}$ is convex, 
we get
\begin{align*}
 \dist{a^i}{b_t}{}
&\le 
t\cdot\dist[{{}}]{a^i}{p_0}{}
+
(1-t)\cdot\dist[{{}}]{a^i}{p_1}{}=
\\
&=\dist{a^i}{p_t}{}.
\end{align*}
In particular,
\[ \mangle\hinge{p_t}{a^i}{b_t}\le \tfrac\pi2.
\eqlbl{<qt-ai-pt=<pi/2}\]

From the assumtion of theorem,
the point array $(b_t,a^0,\dots,a^m)$ is degenerate.
Note that \ref{<qt-ai-pt=<pi/2}
together with Lemma \ref{lem:nondeg-bs-test} applied to for ???,
implies
\[\mangle\hinge{p_t}{a^0}{b_t}>\tfrac\pi2+\eps.
\eqlbl{<qt-a0-pt>=pi/2+eps}\]
Since the distance function $\dist{a^0}{}{}$ is convex, 
we get
\[
\dist{a^0}{b_t}{}
\le 
t\cdot\dist[{{}}]{a^0}{p_0}{}
+
(1-t)\cdot\dist[{{}}]{a^0}{p_1}{}.
\eqlbl{eq:dist-a0-bt}
\]
In particular, if $r$ is sufficiently small, 
??? comparison 
together with \ref{eq:f(y_t)}, \ref{<qt-a0-pt>=pi/2+eps} and \ref{eq:dist-a0-bt} 
imply
\[\dist[]{p_t}{b_t}{}
\le 
\tfrac{2}{\eps}\cdot\l( \dist{a^0}{b_t}{}-\dist{a^0}{p_t}{}\r)\le t\cdot o(r).\]
Hence 
\begin{align*}
\dist{\map(\bm{y}_0)}{\map(\bm{y}_t)}{}
&=\dist{p_0}{p_t}{}
\\
&=\dist{p_0}{b_t}{}+t\cdot o(r)
\\
&
t
\cdot
\l[
\dist{\map(\bm{y}_0)}{\map(\bm{y}_1)}{}
+
o(r)
\r] 
\end{align*}
\claimqedsf

Note that \ref{eq:almost-isom} and \ref{eq:diff=affine}, imply 
\[
\begin{aligned}
\dist{\map(\bm{y}_0)}{\map(\bm{y}_t)}{}
&= \|\bm{y}_0-\bm{y}_t\|\cdot
\l(
1+\frac{o(r)}{\|\bm{y}_0-\bm{y}_1\|} 
\r)
\end{aligned}
%\eqlbl{eq:eps-bi-lip}
\]
The result follows if one applyes \ref{eq:eps-bi-lip}
for $\bm{y}=\bm{y}_0$, $\bm{z}=\bm{y}_t$ and appropriate choice of $t$.
\qeds


\section{Remarks and open problems}

\begin{thm}{Questions}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space and $???$ be an Otsu--Shioya chart
and $g_{ij}$ be corresponding Riemannian metric.
\begin{subthm}{q:curv-tensor}
Is it possible to define curvature tensor of $g_{ij}$ 
in the class of measure-valued tensors.
\end{subthm}

\begin{subthm}{} If the answer to \ref{SHORT.q:curv-tensor} is YES;
does this tensor has any geometric meaning.
In particular, assume $\spc{L}$ is an $m$-dimensional complete length $\Alex{-1}$ space and all sectional curvature of $\spc{L}$ are at least $0$; 
is it true that $\spc{L}$ is $\Alex{0}$?
\end{subthm}
\end{thm}

In the recent work \cite{lebedeva-curv}, it was shown that answer to \ref{SHORT.q:curv-tensor} is YES if the space $\spc{L}$ can be smoothed in class of Riemannian manifolds with uniform lower curvature bound.


\begin{thm}{Open problem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space,
is it true that set of all points with rank smaller than $\kay$ is a (countable) union of images of DC maps from $\RR^\kay\to\spc{L}$? 
\end{thm}

\begin{thm}{Open problem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space,
is it true that set of all points with rank smaller than $\kay$ is locally $\kay$-rectifiable.
\end{thm}



\section{Exercises}

\begin{thm}{Otsu--Shioya smoothing}
Let $\spc{L}$ be a complete length $\Alex{}$ space and $p\in\spc{L}$.
Assume $(\dist{a^1}{}{},\dist{a^2}{}{},\dots,\dist{a^m}{}{})$
gives a distance chart 
in a neighborhood at $p$ with a strutt $\dist{b}{}{}$.

Given $\eps>0$ and consider functions 
\[f^i(q)=\oint\limits_{\oBall(a^i,\eps)}\dist[{{}}]{z}{q}{}\cdot\d_z\vol_m.\]

Show that for all sufficiently small $\eps$,
the map $\bm{f}\:\spc{L}\to\RR^m$ is bi-Lipschitz in a neighborhood of $p$ and moreover, ths map is linearly differentiable at each Euclidean point of this neighborhood.
\end{thm}










