\chapter{Polyhedral spaces}

\section{Definitions}

\begin{thm}{Definition}\label{def:poly}
A length space $\spc{P}$ is called \emph{piecewise
$\Lob{}\kappa$ space}
if it admits a finite triangulation $\tau$ 
such that an arbitrary simplex $\sigma$ in $\tau$ is isometric to a simplex in the model space $\Lob{\dim \sigma}{\kappa}$.

By a 
\index{triangulation of a polyhedral space}\emph{triangulation of a polyhedral space} 
we will understand the triangulation as in the definition.
If we do not wish to specify $\kappa$, we will say that $\spc{P}$ is a \emph{polyhedral space}. 

Applying scaling we can assume that $\kappa=1$, $0$, or $-1$.
\begin{subthm}{}
The $\Lob{}1$-polyhedral spaces will also be 
called 
\index{spherical polyhedral space}\emph{spherical polyhedral spaces};
\end{subthm}

\begin{subthm}{}
The $\Lob{}0$-polyhedral spaces will also be 
called 
\index{Euclidean polyhedral space}\emph{Euclidean polyhedral spaces};
\end{subthm}

\begin{subthm}{}
The $\Lob{}{-1}$-polyhedral spaces will also be 
called 
\emph{hyperbolic polyhedral space}\index{hyperbolic polyhedral space}.
\end{subthm}
\end{thm}

Note that according to the above definition,
all polyhedral spaces are compact.
However, 
most of the statements below admit straightforward generalizations 
to \index{polyhedral spaces!locally polyhedral spaces}\emph{locally polyhedral spaces};
that is, complete length spaces,  
any point of which admits a closed neighborhood isometric to a polyhedral space.
The latter class of spaces includes in particular the infinite covers of polyhedral spaces.

The dimension of a polyhedral space $\spc{P}$
is defined as the maximal dimension of the simplex 
in one (and therefore any) triangulation of $\spc{P}$.

\parbf{Links.}
Let $\spc{P}$ be a polyhedral space
and $\sigma$ be a simplex in a triangulation $\tau$ of $\spc{P}$.

The simplices that contain $\sigma$
form an abstract simplicial complex called the \emph{link} of $\sigma$, 
denoted by $\Link_\sigma$.
If $m=\dim\sigma$,
then the set of vertices of $\Link_\sigma$
is formed by the $(m+1)$-simplices that contain $\sigma$;
the set of its edges are formed by the $(m+2)$-simplices 
that contain $\sigma$, and so on.

The link $\Link_\sigma$
can be identified with the subcomplex of $\tau$ 
formed by all the simplices $\sigma'$ 
such that $\sigma\cap\sigma'=\emptyset$ 
but both $\sigma$ and $\sigma'$ are faces a simplex of $\tau$.

The points in $\Link_\sigma$ can be identified with the normal directions to $\sigma$ at a point in $\sigma$.
The angle metric between directions makes  $\Link_\sigma$ into a spherical polyhedral space.
We will always consider the link with this metric.

\parbf{Tangent space and space of directions.}
Let $\spc{P}$ be a polyhedral space and let  $\tau$ be a triangulation of $\spc{P}$.
If a point $p\in \spc{P}$ 
lies in the interior of a $\kay$-simplex $\sigma$ of $\tau$ 
then the tangent space $\T_p\spc{P}$
is  naturally isometric to
\[\EE^\kay\times(\Cone\Link_\sigma).\]
Equivalently, the space of directions $\Sigma_p$
can be isometrically identified with the 
$\kay$-th spherical suspension over $\Link_\sigma$;
that is, 
\[\Sigma_p\iso\Susp^{\kay}(\Link_\sigma).\]

If $\spc{P}$ is an $m$-dimensional polyhedral space,
then for any $p\in \spc{P}$
the space of directions $\Sigma_p$ is a spherical polyhedral space
of dimension at most $m-1$. 

In particular, 
for any point $p$ in $\sigma$,
the isometry class of $\Link_\sigma$ together with $\kay=\dim\sigma$
determines the isometry class of $\Sigma_p$ 
 and the other way around.

A small neighborhood of $p$ is isometric to a neighborhood of the tip of the $\kappa$-cone over $\Sigma_p$.
In fact, if this propery holds at any point of a compact length space $\spc{P}$
then  $\spc{P}$ is a piecewise
$\Lob{}\kappa$ space;
see \cite{lebedeva-petrunin-poly}.

\section{Curvature bounds}


Recall that the definition of $\ell$-simply connected space is 
given in \ref{def:l-s.c.}.

The following theorem provides a combinatorial description of polyhedral spaces with curvature bounded above.


\begin{thm}{Theorem}\label{thm:PL-CAT}
Let $\spc{P}$ be a piecewise
$\Lob{}\kappa$ space and $\tau$ be its triangulation. Then 

\begin{subthm}{thm:PL-CAT:curc>=k}
$\spc{P}$  is locally $\Alex\kappa$
if and only if any connected component of the link of any simplex $\sigma$ in $\tau$
is $(2\cdot\pi)$-simply connected.
Equivalently, if and only if any closed local geodesic in $\Link_\sigma$ has length at least $2\cdot\pi$.
\end{subthm}

\begin{subthm}{thm:PL-CAT:CAT}
$\spc{P}$ is a complete length $\CAT\kappa$ space
if and only if $\spc{P}$ is $(2\cdot\varpi\kappa)$-simply connected and any connected component of the link of any simplex $\sigma$ in $\tau$
is $(2\cdot\pi)$-simply connected.
\end{subthm}

\end{thm}


\parit{Proof.}
We will only give a proof of the ``if'' part;
the ``only if'' part is evident.

Let us apply induction on $\dim\spc{P}$.
The {}\emph{base} case $\dim\spc{P}=0$ is evident.

\parit{Step.}
Assume that the theorem is proved in the case $\dim\spc{P}<m$. Suppose  $\dim\spc{P}=m$.

Fix a point $p\in\spc{P}$.
A neighborhood of $p$ 
is isometric to the $\kappa$-cone over 
the $\Sigma_p$.
By Theorem~\ref{thm:warp-curv-bound:cbb:a}, 
it is sufficient to show that 
\begin{clm}{}\label{eq:Sigma-in-CAT(1)}
 $\Sigma_p$ is $\CAT1$
\end{clm}

Note that $\Sigma_p$ is a spherical polyhedral space 
and its  links are isometric to  links of $\spc{P}$. 
By the  induction hypothesis, $\Sigma_p$ is locally $\Alex1$.
Applying Generalized Hadamard--Cartan theorem (\ref{thm:hadamard-cartan-gen}),
we get \ref{eq:Sigma-in-CAT(1)}.

To prove (\ref{SHORT.thm:PL-CAT:CAT}) apply Generalized Hadamard--Cartan theorem (\ref{thm:hadamard-cartan-gen}) to $\spc{P}$.
\qeds

\begin{thm}{Exercise}\label{ex:poly-unique-geodesic}
Show that if in a Euclidean polyhedral space $\spc{P}$
any two points can be connected by a unique geodesic 
then $\spc{P}$ is $\CAT0$.
\end{thm}

The following theorem provides a combinatorial description of polyhedral spaces with curvature bounded below.

\begin{thm}{Theorem}\label{thm:poly-CBB} Let $\spc{P}$ be a piecewise
$\Lob{}\kappa$ space and $\tau$ its a triangulation.
Then $\spc{P}$ is $\Alex\kappa$ if and only if the following conditions hold.

\begin{subthm}{} $\tau$ is \emph{pure}; 
that is, any simplex in $\tau$ is  a face of some simplex of dimension exactly $m$. 
\end{subthm}

\begin{subthm}{thm:poly-CBB:m-1}
The link of any simplex of dimension $m-1$ is formed by single point or two points.
\end{subthm}

\begin{subthm}{thm:poly-CBB:2pi}
Any link of any simplex of dimension $m-2$
has diameter at most $\pi$.
\end{subthm}

\begin{subthm}{thm:poly-CBB:connected}
The link of any simplex of dimension $\le m-2$ is connected.
\end{subthm}

\end{thm}

\parbf{Remarks.}
The condition (\ref{SHORT.thm:poly-CBB:connected})
can be reformulated in the following way:

\begin{itemize}
 \item[{\it \ref{SHORT.thm:poly-CBB:connected}$\,'\!$)}] 
Any path $\gamma\:[0,1]\to \spc{P}$ can be approximated by paths
$\gamma_n\:[0,1]\to \spc{P}$ 
that cross only simplexes of dimension $m$ and $m-1$.
\end{itemize}

Further, modulo the other conditions,
the condition (\ref{SHORT.thm:poly-CBB:2pi})
is equivalent to the following:


\begin{itemize}
 \item[{\it \ref{SHORT.thm:poly-CBB:2pi}$\,'\!$)}] 
The link of any simplex of dimension $m-2$ is 
isometric to a circle of length $\le 2\cdot\pi$
or a closed real interval of length $\le \pi$.
\end{itemize}

\parit{Proof.}
We will only give a proof of the ``if'' part.
The ``only if'' par is similar and is left to the reader.

We apply induction on $m$.
The {}\emph{base} case $m=1$ follows from the assumption (\ref{SHORT.thm:poly-CBB:m-1}).

\parit{Step.}
Assume that the theorem is proved for polyhedral spaces  of dimesnion less than $m$.
Suppose  $\dim\spc{P}=m$.

According to the globalization theorem (\ref{thm:glob}),
it is sufficient to show that 
$\spc{P}$  is locally $\Alex\kappa$. 

Fix $p\in \spc{P}$.
Note that a spherical neighborhood of $p$
is isometric
to a  spherical neighborhood of the tip of the tangent $\kappa$-cone 
$$\T_p\mc\kappa\z
=
\Cone\mc\kappa(\Sigma_p).$$
Hence it is sufficient to show that 
\begin{clm}{}
 $\T_p\mc\kappa$ is $\Alex\kappa$ for any $p\in \spc{P}$.
\end{clm}

By Theorem~\ref{thm:warp-curv-bound:cbb:a}, 
the latter is equivalent to 
\begin{clm}{}\label{clm:curv+diam}
$\diam\Sigma_p\le \pi$ and $\Sigma_p$ is $\Alex1$.
\end{clm}


If $m=2$, then \ref{clm:curv+diam} follows from (\ref{SHORT.thm:poly-CBB:m-1}).

To prove the case $m\ge 3$,
note that $\Sigma_p$ is an $(m-1)$-dimensional spherical polyhedral space and all the conditions of the theorem hold for $\Sigma_p$.
It remains to apply the induction hypothesis.\qeds

\begin{thm}{Exercise}\label{ex:polyKk}
Assume $\spc{P}$ is a piecewise
$\Lob{}\kappa$ space and $\dim \spc{P}\ge 2$. 
Show that 

\begin{subthm}{} if $\spc{P}$ is $\Alex{\kappa'}$, then $\kappa'\le \kappa$ and $\spc{P}$ is $\Alex{\kappa}$.
\end{subthm}

\begin{subthm}{}
if $\spc{P}$ is $\CAT{\kappa'}$ space, then $\kappa'\ge \kappa$ and $\spc{P}$ is $\CAT\kappa$.
\end{subthm}

\end{thm}

\section{Flag complexes}


\begin{thm}{Definition}
A simplicial complex $\mathcal{S}$ 
is called \index{flag complex}\emph{flag} if whenever $\{v_0,\z\dots,v_\kay\}$
is a set of distinct vertices of $\mathcal{S}$
that pairwise joined by edges, then the vertexes $v_0,\dots,v_\kay$
span a $\kay$-simplex in $\mathcal{S}$.

If the above condition is satisfied only for $\kay=2$, 
then we say $\mathcal{S}$ satisfies 
the \emph{no-triangle condition}\index{no-triangle condition}.
\end{thm}

Note that every flag complex is determined by its 1-skeleton.

\begin{thm}{Exercise}\label{ex:baricenric-flag}
Show that the barycentric subdivision of any simplicial complex is a flag complex.
Conclude that any simplicial complex is homeomorphic to a compact length $\CAT1$ space.
\end{thm}


\begin{thm}{Proposition}\label{prop:no-trig}
A simplicial complex $\mathcal{S}$ is flag if and only if 
$\mathcal{S}$ as well as all the links of all its simplices
satisfies the no-triangle condition.
\end{thm}

From the definition of flag complex 
we get the following.

\begin{thm}{Lemma}\label{lem:link-of-flag}
Any link of a flag complex is flag.
\end{thm}


\parit{Proof of Proposition~\ref{prop:no-trig}.}
By Lemma~\ref{lem:link-of-flag}, the no-triangle condition holds 
for any flag complex and all its links.

Now assume a complex $\spc{S}$ and all its links satisfy 
the no-triangle condition.
It follows that $\spc{S}$ includes a 2-simplex for each triangle.
Applying the same observation for each edge we get that $\spc{S}$ 
includes a 3-simplex for any complete graph with 4 vertices.
Repeating this observation 
for triangles, 
4-simplexes,
5-simplices
and so on we get that $\spc{S}$ is flag.
\qeds


\parbf{All-right triangulation.} %???right-angled triangulation???
A triangulation of a spherical polyhedral space 
is called an  \emph{all-right triangulation} 
if each simplex of the triangulation is isometric 
to a spherical simplex all of whose angles are right.
Similarly, we say that a simplicial complex 
is equipped with an  \emph{all-right spherical metric}
if it is a length metric and each simplex is isometric 
to a spherical simplex all of whose angles are right.

Spherical polyhedral $\CAT1$ spaces glued from of right-angled simplices
admit the following characterization 
discovered by Gromov \cite[p. 122]{gromov:hyp-groups}.

\begin{thm}{Flag condition}\label{thm:flag}
Assume that a spherical polyhedral space $\spc{P}$
admits an all-right triangulation $\tau$.
Then $\spc{P}$ is $\CAT1$
if and only if $\tau$ is flag.
\end{thm}

\parit{Proof; ``only-if'' part.} 
Assume there are three vertices $v_1,v_2$ and $v_3$ of $\tau$
that are pairwise joined by edges 
but do not span a simplex.
Note that in this case 
$$\mangle\hinge{v_1}{v_2}{v_3}=\mangle\hinge{v_2}{v_3}{v_1}=\mangle\hinge{v_3}{v_1}{v_1}=\pi.$$
Equivalently,
\begin{clm}{}\label{clm:3pi/2}
The join of the geodesics $[v_1v_2]$, $[v_2v_3]$ and $[v_3v_1]$
forms a locally geodesic loop in $\spc{P}$. 
\end{clm}

Now assume that $\spc{P}$ is $\CAT1$.
Then by \ref{thm:warp-curv-bound:cbb:a},
$\Link_\sigma\spc{P}$ is a compact length $\CAT1$ space for every simplex $\sigma$ 
in $\tau$. 

Each of these links is an all-right spherical complex
and
by Theorem \ref{thm:PL-CAT}, 
none
of these links can contain a geodesic circle of length less than $2\cdot\pi$. 

Therefore Proposition~\ref{prop:no-trig} and \ref{clm:3pi/2} 
imply the ``only-if'' part.

\parit{``If'' part.} 
By Lemma~\ref{lem:link-of-flag} and Theorem~\ref{thm:PL-CAT},
it is sufficient to show that any closed local geodesic $\gamma$ 
in a flag complex $\spc{S}$ with all-right metric has length at least $2\cdot\pi$.

Fix a flag complex $\spc{S}$.
Recall that the  \index{star of vertex}\emph{star} of a vertex $v$ (briefly $\overline \Star_v$)
is formed by all the simplices  containing $v$. Similarly, $\Star_v$,   the open star of $v$, is the union of all simplices containing $v$ with faces opposite $v$ removed.

Choose a simplex $\sigma$ that contains a point of $\gamma$.
Let $v$ be a vertex of $\sigma$.
Set $f(t)=\cos\dist{v}{\gamma(t)}{}$.
Note that 
\[f''(t)+f(t)=0\] if $f(t)>0$.  
Since the zeroes of $f$ are  $\pi$ apart,
$\gamma$ 
spends time $\pi$ on every visit to $\Star_v$.

After leaving $\Star_v$,
the local geodesic $\gamma$ has to enter another simplex, 
say $\sigma'$, 
which has a vertex $v'$ not joined to $v$ by an edge.

Since $\tau$ is flag, we have that the stars $\Star_v$ and $\Star_{v'}$
do not overlap.
The same argument as above shows that $\gamma$ spends time $\pi$ on every visit to $\Star_{v'}$.
Therefore the total length of $\gamma$ is at least $2\cdot\pi$.
\qeds

\begin{thm}{Exercise}\label{ex:obtuce-flag}
Assume that a spherical polyhedral space $\spc{P}$
admits a triangulation $\tau$ such that all dihedral angles of all simplexes are at least $\tfrac\pi2$.
Show that $\spc{P}$ is $\CAT{1}$
if $\tau$ is flag.
\end{thm}

\begin{thm}{Exercise}\label{ex:short+commuting}
Let $\spc{U}$ be a complete length $\CAT0$ space
and $\phi_1,\phi_2,\dots,\phi_k\:\spc{U}\to \spc{U}$ be commuting short retractions; 
that is 
\begin{itemize}
\item $\phi_i\circ\phi_i=\phi_i$ for each $i$;
\item $\phi_i\circ\phi_j=\phi_j\circ\phi_i$ for any $i$ and $j$;
\item $\dist{\phi_i(x)}{\phi_i(y)}{\spc{U}}\le \dist{x}{y}{\spc{U}}$ for each $i$ and any $x,y\in\spc{U}$.
\end{itemize}
Set $A_i=\Im \phi_i$ for all $i$;
note that each $A_i$ is a weakly convex set.

Assume $\Gamma$ is a finite graph 
(without loops and multiple edges) 
with edges labeled by $1,2,\dots, n$.
Denote by $\spc{U}^\Gamma$ the space obtained by taking 
a copy of $\spc{U}$ for each vertex of $\Gamma$ and 
gluing two such copies along $A_i$ if the corresponding vertices are joint by an edge labeled by $i$.

Show that $\spc{U}^\Gamma$ is $\CAT0$
\end{thm}

\parbf{The space of trees.}
The following construction is given by 
Louis Billera,
Susan Holmes,
and  Karen Vogtmann \cite{billera-holmes-vogtmann}.

Let $\spc{T}_n$ be the set of all metric trees with $n$ end-vertices
labeled by $a_1,\dots,a_n$.
To describe one tree in $\spc{T}_n$ we may fix a topological tree $\tau$ with end vertices $a_1,\dots,a_n$ and all the other verices of degree 3 
and prescribe the lengths of $2\cdot n-3$ edges.
If the lengh of an edge is $0$, we assume that edge degenerates;
such a tree can be also described using a different topological tree $\tau'$.
The subset of $\spc{T}_n$ corresponding to the given topological tree $\tau$ can be identified with a convex closed cone in  $\mathbb{R}^{2\cdot n-3}$.
Equip each such subset with the metric induced from $\mathbb{R}^{2\cdot n-3}$ and consider the legth metric on $\spc{T}_n$ induced by these metrics.

\begin{thm}{Exercise}\label{ex:space-of-trees}
Show that $\spc{T}_n$ with the described metric is a $\CAT0$.
\end{thm}



\parbf{Cubical complexes.}
The definition of a cubical complex
mostly repeats the definition of a simplicial complex, 
with simplices replaced by cubes.

Formally, a \index{cubical complex}\emph{cubical complex} is defined as a subcomplex 
of the unit cube in the Euclidean space of large dimension;
that is, a collection of faces of cube
such that together with each face it contains all its sub-faces.
Each cube face in this collection 
will be called a \emph{cube} of the cubical complex.

Note that according to this definition, 
any cubical complex is finite,
that is, contains a finite number of cubes.

The union of all the cubes in a cubical complex $\spc{Q}$ will be called its \emph{underlying space};
it will be denoted by $\spc{Q}$ or by $\ushort{\spc{Q}}$ 
if we need to emphasize that we are talking about a set, 
not a complex.
A homeomorphism from $\ushort{\spc{Q}}$ to a topological space $\spc{X}$ is called a \index{cubulation}\emph{cubulation of}~$\spc{X}$.

The underlying space of a cubical complex $\spc{Q}$ will be always considered with the length metric
induced from $\RR^N$.
In particular, with this metric, 
each cube of $\spc{Q}$ is isometric to the unit cube of the same dimension.

It is straightforward to construct a triangulation 
of $\ushort{\spc{Q}}$ 
such that each simplex is isometric to a Euclidean simplex.
In particular $\ushort{\spc{Q}}$ is a Euclidean polyhedral space.

The link of each cube in a cubical complex admits a natural 
all-right triangulation; 
each simplex corresponds to an adjusted cube.

\begin{thm}{Exercise}\label{ex:cubical-complex}
Show that a cubical complex $\spc{Q}$ is locally $\CAT0$ if and only if link of each vertex in $\spc{Q}$ is flag.
\end{thm}

\section{Remarks}

The condition on polyhedral $\CAT\kappa$ spaces given in Theorem~\ref{thm:PL-CAT} might look easy to use, 
but in fact, it is hard to check even in very simple cases.
For example the description of those coverings of $\mathbb{S}^3$ branching at three 
great circles which are $\CAT1$ requires quite a bit of work;
an answer is given by Ruth Charney and Michael Davis \cite{charney-davis-1993}.

Analogs of the flag condition for spherical Coxeter simplexes
could resolve the following problem. 

\begin{thm}{Braid space problem}
Consider $\CC^n$ with coordinates $z_1,\dots,z_n$.
Let us remove from $\CC^n$ the complex hyperplanes $z_i=z_j$, for all $i\ne j$,
pass to the universal cover and consider the completion $\spc{B}_n$ 
of the obtained space.

Is it true that $\spc{B}_n$ is $\CAT0$ for any $n$.
\end{thm}

The above question has an affirmative answer for $n\le 3$\cite{charney-davis-1993} and open for all $n\ge 4$.
This and number of related questions are discussed by Dmitri Panov and the third author \cite{panov-petrunin}.

Recall that by Hadamard--Cartan theorem (\ref{thm:hadamard-cartan})
any complete length $\CAT{0}$ space is contractible.
Therefore any complete length locally $\CAT{0}$ space 
is \emph{aspherical};
that is, they have contractible universal covers.

This observation can be used together with Exercise \ref{ex:cubical-complex} to construct examples of exotic aspherical spaces;
for example compact topological manifolds which universal cover is not homeomorphic to a Euclidean space.
A survey on the subject it given by Michael Davis \cite{davis-2001}; a more elementary introduction to the subject is given by the authors \cite[Chapter 3]{alexander-kapovitch-petrunin-CAT}.

The flag condition also leads to the so-called {}\emph{hyperbolization} procedure, a flexible tool for constructing  aspherical spaces;
a good survey on the subject is given by Ruth Charney and Michael Davis in \cite{charney-davis-1995}.

The $\CAT0$ property of a cube complex admits interesting (and useful) geometric descriptions if one exchanged the $\ell^2$-metric to a natural $\ell^1$ or $\ell^\infty$ on each cube.
The following statement is proved by Brian Bowditch \cite{bowditch-2020}.

\begin{thm}{Theorem}
The following three conditions are equivalent.

\begin{subthm}{cube-2} A cube complex $Q$ equipped with $\ell^2$-metric is $\CAT0$.
\end{subthm}

\begin{subthm}{cube-infty} A cube complex $Q$ equiped with $\ell^\infty$-metric is \index{injective space}\emph{injective}.
The later means that for any metric space $\spc{X}$ with a subset $A$, any short map $A\to (Q,\ell^\infty)$ can be extended to a short map $\spc{X}\to (Q,\ell^\infty)$.
\end{subthm}

\begin{subthm}{cube-1} A cube complex $Q$ equiped with $\ell^1$-metric is \index{median space}\emph{median}.
 The later means that for any three points $x,y,z$ there is a {}\emph{unique} point   $m$ (it is called \index{median}\emph{median} of $x$, $y$, and $z$) that lies on {}\emph{some} geodesics $[xy]$, $[xz]$ and $[yz]$.
\end{subthm}
\end{thm}
