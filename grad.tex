%%!TEX root = all.tex
%arrays^
\chapter{Gradient flow}%ready

The technique of gradient flow takes it roots in Sharafutdinov's retraction, 
which was introduced in \cite{sharafutdinov} and used  widely in comparison geometry since then.
In $\CBB{}{}$-spaces, it was first used by in  \cite{perelman-petrunin:qg}.
Bit later, independently Jost and Mayer in \cite{jost} and \cite{mayer} 
used the gradient flow in $\cCat{}{}$-spaces; 
this approach has been refined in \cite{grad-flow-book}.
Later, Lytchak in \cite{lytchak:open-map}, 
unified and generalized these two approaches
to a wide class of metric spaces and then it was
yet developed further by Ohta in \cite{ohta} and by Sevar\'e in \cite{sevar'e}.

Gradient flow provides a useful tool in Alexandrov's geometry, 
which we will use everywhere in the book.

This chapter can be divided in few parts. 
\begin{itemize}
\item Sections \ref{sec:grad-def}--\ref{sec:grad-semicont} 
describes ``gradient vector field'' and its properties.
\item Sections \ref{sec:gradient-like}--\ref{sec:Gradient flow} describe gradient curves and gradient flow;
gradient-like curves are needed to introduce gradient curves.
\item Sections \ref{sec:Radial curves: definition}--\ref{sec:gexp} describe radial curves and gradient exponent. 
It is analog of exponential map which is defined for $\CBB{}{}$-spaces; it has many important properties of the ordinary exponential map
and in certain respects it is ``better'',
even in Riemannian case.
\end{itemize}


In sections \ref{sec:non-lip}-- we describe how to 
modify the proofs so it will work for general semiconcave functions, 
not necessary locally Lipschitz.

One of the technical difficulties in Alexandrov's geometry comes from
nonextendability of geodesics. 
In particular, for $\spc{L}\in\CBB{}{}$ and a point $p\in \spc{L}$, 
the exponential map, $\exp_p\:\T_p\to \spc{L}$, if defined the usual way, can
be undefined in an arbitrary small neighborhood of the origin in $\T_p$. 
Here we construct its analog --- the \emph{gradient exponential map},
$\gexp_p\:\T_p\to\spc{L}$, 
which practically solves this problem. 
It has many important properties of the ordinary exponential map
and in certain respects it is ``better'',
even in Riemannian case.






























%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Gradient}\label{sec:grad-def}

\begin{thm}{Definition of gradient}\label{def:grad} 
Let $\spc{L}\in\CBB{}{}$, 
$f\:\spc{L}\subto\RR$ be a subfunction
and for a point
$p\in\Dom f$ the differential $\d_p f\:\T_p\to\RR$ is defined.

A tangent vector $g\in \T_p$ is called a 
\emph{gradient of $f$ at $p$}\index{gradient} 
(briefly,  $g=\nabla_p f$\index{$\nabla$}) if
\begin{subthm}{}
$(\d_p f)(w)\le \<g,w\>$ for any $w\in \T_p$, and
\end{subthm}

\begin{subthm}{}
$(\d_p f)(g) = \<g,g\> .$
\end{subthm}
\end{thm}

\begin{thm}{Existence and uniqueness of the gradient}\label{thm:ex-grad} 
Assume $\spc{L}\in\CBB{}{\kappa}$
and $f\:\spc{L}\subto\RR$ be 
locally Lipschitz 
and 
semiconcave subfunction.
Then for any point $p\in \Dom f$, there is unique gradient $\nabla_p f\in \T_p$.
\end{thm}

\parit{Proof; (uniqueness).} 
If $g,g'\in \T_p$ are two gradients of $f$
then 
\begin{align*}
\<g,g\>
&=(\d_p f)(g)\le \<g,g'\>,
&
\<g',g'\>
&=(\d_p f)(g')\le \<g,g'\>.
\end{align*}
Therefore,
\[\dist[2]{g}{g'}{}=\<g,g\>-2\cdot\<g,g'\>+\<g',g'\>=0;\] 
i.e., $g=g'$.

\parit{(Existence).} 
Note first that if $\d_p f\le 0$ then one can take $\nabla_p f=\0$.

Otherwise, if $s=\sup\set{(\d_p f)(\xi)}{\xi\in\Sigma_p}>0$, 
it is sufficient to show that there is  $\overline{\xi}\in \Sigma_p$ such that 
\[
(\d_p f)\l(\overline{\xi}\r)=s.
\eqlbl{overlinexi}
\]
Indeed, if $\overline{\xi}$ exists, then applying Lemma~\ref{lem:ohta} for $u=\overline{\xi}$, $v=\eps\cdot w$ with $\eps\to0+$, 
we get
\[(\d_p f)(w)\le \<w,s\cdot\overline{\xi}\>\] 
for any $w\in\T_p$;
i.e., $s\cdot\overline{\xi}$ is the gradient at $p$.

Take a sequence of directions $\xi_n\in \Sigma_p$, such that $(\d_p f)(\xi_n)\to s$.
Yet once applying Lemma~\ref{lem:ohta} for $u=\xi_n$, $v=\xi_m$, we get
\[s
\ge
\frac{(\d_p f)(\xi_n)+(\d_p f)(\xi_m)}{\sqrt{2+2\cdot\cos\mangle(\xi_n,\xi_m)}}.\]
Therefore $\mangle(\xi_n,\xi_m)\to0$ as $n,m\to\infty$;
i.e., $(\xi_n)$ is a Cauchy sequence.
Clearly $\overline{\xi}=\lim_n\xi_n$ is satisfies \ref{overlinexi}.
\qeds














\section{Calculus of gradient}\label{sec:grad-calculus}



The next lemma roughly states that the gradient points 
in the direction of maximal slope; 
moreover if the slope in the given direction is almost maximal then it is almost direction of the gradient.

\begin{thm}{Lemma}\label{lem:alm-grad}
Let $\spc{L}\in\CBB{}{\kappa}$,
$f\:\spc{L}\subto\RR$ be locally Lipschitz and semiconcave 
and $p\in \Dom f$.

Assume $|\nabla_p f|>0$, 
set $\overline{\xi}=\tfrac{1}{|\nabla_p f|}\cdot\nabla_p f$ then
\begin{subthm}{near-grad} If for $v\in\T_p$, we have $|v|\le 1+\eps$ 
and $(\d_p f)(v) > |\nabla_p f|\cdot(1-\eps)$, then
\[\dist{\overline{\xi}}{v}{}<100\cdot\sqrt{\eps}.\]
\end{subthm}

\begin{subthm}{conv-to-grad} 
If $v_n\in \T_p$ be a sequence of vectors such that 
\[\limsup_{n\to\infty} |v_n|\le 1\ \  
\t{and}\ \  \liminf_{n\to\infty}(\d_p f)(v_n)\ge |\nabla_p f|\] 
then 
\[\lim_{n\to\infty} v_n=\overline{\xi}.\]
\end{subthm}

\begin{subthm}{alm-max} $\overline{\xi}$ is the unique maximum direction for the restriction $\d_p f|_{\Sigma_p}$. 
In particular, 
\[|\nabla_p f|=\sup\set{\d_p f}{\xi\in\Sigma_p f}.\]
\end{subthm}
\end{thm}

\parit{Proof.} According to definition of gradient,
\begin{align*}
 |\nabla_p f|\cdot(1-\eps)
&<
(\d_p f)(v)
\le
\\
&\le\<v,\nabla_p f\>
=
\\
&=
|v|\cdot|\nabla_p f|\cdot\cos\mangle(\nabla_p f,v).
\end{align*}
Thus 
$
|v|>1-\eps$
and
$
\cos\mangle(\nabla_p f,v)>\tfrac{1-\eps}{1+\eps}.
$
Hence  (\ref{SHORT.near-grad}).

Statements (\ref{SHORT.conv-to-grad}) and (\ref{SHORT.alm-max}) follow directly from (\ref{SHORT.near-grad}).
\qeds

As a corollary of the above lemma and Proposition~\ref{prop:conv-comp} we get the following: 

\begin{thm}{Chain rule} %???DO WE NEED IT???
Let $\spc{L}\in\CBB{}{}$, 
$f\:\spc{L}\subto \RR$ be a semiconcave function
and $\phi\:\RR\to\RR$ be a non-decreasing semiconcave function.
Then $\phi\circ f$ is semiconcave and  $\nabla_x(\phi\circ f)=\phi^+(f(x))\cdot\nabla_x f$ for any $x\in\Dom f$.
\end{thm}


The following inequalities describe an important property of the ``gradient
vector field'' which will be used throughout this paper.

\begin{thm}{Lemma} 
\label{lem:grad-lip}
Let $\spc{L}\in\CBB{}{}$, 
$f\:\spc{L}\subto\RR$ satisfies $f''+\kappa\cdot f\le \lambda$ for some $\kappa,\lambda\in\RR$, 
$[p q]\subset \Dom f$ 
and $\ell=\dist{p}{q}{}$.
Then

\begin{wrapfigure}{r}{18mm}
\begin{lpic}[t(0mm),b(0mm),r(0mm),l(5mm)]{pics/grad-lip(0.3)}
\lbl[br]{4,65;$p$}
\lbl[tr]{3,-1;$q$}
\lbl[r]{3,50;$\dir pq$}
%\lbl[tr]{37,9;$\dir qp$}
\lbl[l]{5,30;$\ell$}
\lbl[b]{25,62;$\nabla_p f$}
%\lbl[tl]{55,2;$\nabla_q f$}
\end{lpic}
\end{wrapfigure}

\[\<\dir pq,\nabla_p f\>\ge
\frac
{{f(q)}-{f(p)\cdot\cs\kappa\ell}-\lambda\cdot\md\kappa\ell}
{\sn\kappa\ell}.\]


In particular, 
\begin{subthm}{lem:grad-lip:lam=0}
if $\kappa=0$, 
\[\<\dir pq,\nabla_p f\>\ge
{\l({f(q)}-{f(p)}-\tfrac\lambda2\cdot\ell^2\r)}/{\ell};\]
\end{subthm}

\begin{subthm}{} if $\kappa=1$, $\lambda=0$ we have
\[\<\dir pq,\nabla_p f\>\ge
\l(f(q)-f(p)\cdot\cos\ell\r)/\sin\ell;\]
\end{subthm}

\begin{subthm}{} if $\kappa=-1$, $\lambda=0$ we have
\[\<\dir pq,\nabla_p f\>\ge
\l(f(q)-f(p)\cdot\cosh\ell\r)/\sinh\ell;\]
\end{subthm}
\end{thm}

\parit{Proof of \ref{lem:grad-lip}.} 
Note that 
$\geod_{[p q]}(0)=p$, 
$\geod_{[p q]}(\ell)=q$, 
$(\geod_{[p q]})^+(0)=\dir pq$.
Thus,
\begin{align*}
\<\dir pq,\nabla_p f\>
&\ge 
d_p f(\dir pq)=
\\
&=
(f\circ\geod_{[p q]})^+(0)
\ge
\\
&\ge
\frac
{{f(q)}-{f(p)\cdot\cs\kappa\ell}-\lambda\cdot\md\kappa\ell}
{\sn\kappa\ell}.
\end{align*}
\qedsf

The following corollary states that gradient vector field is monotonic in the sense similar to definition of \emph{monotone operators}; see for example \cite{phelps}.

%???Maybe it is more natural to call this property ``semi-monotonicity or ``$\lambda$-monotonicity'' ???

\begin{thm}{Monotonicity of gradient} 
\label{cor:grad-lip}
Let $\spc{L}\in\CBB{}{\kappa}$, 
$f\:\spc{L}\subto\RR$ be locally Lipschitz and $\lambda$-concave 
and $[p q]\subset \Dom f$.
Then
\[
\<\dir p q,\nabla_p f\>
+
\<\dir q p,\nabla_q f\>
\ge 
-\lambda\cdot\dist[{{}}]{p}{q}{}.
\]

\end{thm}

\parit{Proof.} Add two inequalities from \ref{lem:grad-lip:lam=0}.
\qeds

\begin{thm}{Lemma}\label{lem:close-grad}
Let $\spc{L}\in\CBB{}{\kappa}$, 
$f,g\:\spc{L}\subto\RR$ 
and $p\in\Dom f\cap\Dom g$.

Then 
\[\dist[2]{\nabla_p f}{\nabla_p g}{\T_p}
\le 
(|\nabla_p f|+|\nabla_p g|)
\cdot
\sup\set{|(\d_p f)(\xi)-(\d_p f)(\xi)|}{\xi\in\Sigma_p}.\]

In particular, if $f_n\:\spc{L}\subto\RR$ is a sequence of locally Lipschitz and semiconcave subfunctions,
$p\in \Dom f_n$ for each $n$ 
and $\d_p f_n$ converges uniformly on ${\Sigma_p}$ 
then sequence $\nabla_p f_n\in \T_p$ converges.
\end{thm}

\parit{Proof.}
Set 
\[s
=
\sup
\set{\,|(\d_p f)(\xi)-(\d_p g)(\xi)|}{\xi\in\Sigma_p}.\]
Clearly for any $v\in \T_p$, we have 
\[|(\d_p f)(v)-(\d_p g)(v)|\le s\cdot|v|.\]
From the definition of gradient (\ref{def:grad}) we have:
\begin{align*}
&(\d_p f)(\nabla_p g)\le\<\nabla_p f,\nabla_p g\>,
&&(\d_p g)(\nabla_p f)\le\<\nabla_p f,\nabla_p g\>,
\\
&(\d_p f)(\nabla_p f)=\<\nabla_p f,\nabla_p f\>,
&&(\d_p g)(\nabla_p g)=\<\nabla_p g,\nabla_p g\>.
\end{align*}
Therefore,
\begin{align*}
\dist[{{}}]{\nabla_pf}{\nabla_pg}{}
&=\<\nabla_p f,\nabla_p f\>+\<\nabla_p g,\nabla_p g\>-2\cdot\<\nabla_p f,\nabla_p g\>
\le
\\
&\le (\d_p f)(\nabla_p f)+(\d_p g)(\nabla_p g)-(\d_p f)(\nabla_p g)-(\d_p g)(\nabla_p f)
\le
\\
&\le s\cdot(|\nabla_p f|+|\nabla_p g|).
\end{align*}
\qedsf

The next is a corollary of the above lemma.
It will be used to prove basic properties of tangent space.
Note that the notion of gradient does not appear 
in the formulation.


\begin{thm}{Anti-sum lemma}\label{lem:minus-sum} 
Let $\spc{L}\in\CBB{}{}$ and $p\in \spc{L}$.

Given two vectors $u,v\in \T_p$ there is unique vector $w\in \T_p$ such that
\[\<u,x\>+\<v,x\>+\<w,x\>\ge 0\]
for any $x\in \T_p$ and
\[\<u,w\>+\<v,w\>+\<w,w\>=0.\]

\end{thm}

To obtain the following corollary, applying the above lemma for $u=v$.
In finite-dimensional case, a stronger statement holds, see Milka's lemma (\ref{lem:milka}).

\begin{thm}{Existence of polar vector}\label{cor:polar}
Let $\spc{L}\in\CBB{}{}$ 
and $p\in \spc{L}$. 
Given a vector $u\in \T_p$ there is unique vector $u^*\in\T_p$ such that $\<u^*,u^*\>+\<u,u^*\>= 0$ and
$u^*$ is \emph{polar}\index{polar vector} to $u$;
i.e.,
 $\<u^*,x\>+\<u,x\>\ge 0$ for any $x\in \T_p$.

In particular, for any vector $u\in \T_p$ there is a polar vector $u^*\in\T_p$ such that
$|u^*|\le |u|$.
\end{thm}

\parit{Proof of \ref{lem:minus-sum}.}
Choose two sequences of points $a_n,b_n\in \Str(p)$ such that $\dir{p}{a_n}\to u/|u|$ and $\dir{p}{b_n}\to v/|v|$.
Consider sequence of functions 
\[f_n=|u|\cdot\dist[{{}}]{a_n}{}{}+|v|\cdot\dist[{{}}]{b_n}{}{}.\]
According to Theorem~\ref{thm:d_q dist_p(v)=-<dri p q, v>}, 
\[(\d_pf_n)(x)=-|u|\cdot\<\dir{p}{a_n},x\>-|v|\cdot\<\dir{p}{b_n},x\>.\]
Thus, we have the following uniform convergence for all $x\in\Sigma_p$
\[(\d_pf_n)(x)\xto[n\to\infty]{}-\<u,x\>-\<v,x\>.\] 
According to Lemma~\ref{lem:close-grad}, 
sequence $\nabla_pf_n$ converges.
Set $w=\lim_n\nabla_pf_n$.

From definition of gradient
\[\begin{aligned}
\<w,w\>&=\lim_{n\to\infty}\<\nabla_pf_n,\nabla_pf_n\>=
&&&&&&&&&%right side
\<w,x\>&=\lim_{n\to\infty}\<\nabla_pf_n,x\>\ge
\\%second line
&=\lim_{n\to\infty}(\d_p f_n)(\nabla_p f_n)
=
&&&&&&&&&%second line right side
&\ge
\lim_{n\to\infty}(\d_pf_n)(x)
=
\\%line 3
&=-\<u,w\>-\<v,w\>,
&&&&&&&&&%line 3 right side
&=-\<u,x\>-\<v,x\>.
\end{aligned}\]
\qedsf














\section{Semicontinuity of \textbar gradient\textbar}\label{sec:grad-semicont}

In this section we collect number of corollaries of the following lemma.

\begin{thm}{Ultra limit of \textbar gradient\textbar} \label{lem:gradcon}
Assume
\begin{itemize}
\item $\spc{L}_n\in\CBB{}{\kappa}$ and $(\spc{L}_n,p_n) \to (\spc{L}_\o,p_\o)$ as $n\to\o$;
\item $f_n\:\spc{L}_n\subto \RR$ and $f_\o\:\spc{L}_\o\subto \RR$ are locally Lipschitz and $\lambda$-concave and $f_n\to f_\o$ as $n\to\o$;
\item $x_n\in\Dom f_n$ and $x_n\to x_\o\in \Dom f_\o$ as $n\to\o$.
\end{itemize}
Then 
\[|\nabla_{x_\o} f_\o|
\le 
\lim_{n\to \o} |\nabla_{x_n} f_n|.\]

\end{thm}


\parbf{Remarks.}
To construct an example such that 
$|\nabla_{x_\o} f_\o|
<
\lim_{n\to\o} |\nabla_{x_n} f_n|$;
one can take $\spc{L}_n=\spc{L}_\o=\RR$, $f_n(x)=f_\o(x)=-|x|$ and $x_n\to 0+$.

 From the convergence of gradient curves (proved later in \ref{ultr-lim-g-curve}), 
one can deduce the following slightly stronger statement.
 
\begin{thm}{Proposition}\label{prop:lim|grad|=|grad|}
Assume
\begin{itemize}
\item $\spc{L}_n\in\CBB{}{\kappa}$ and $(\spc{L}_n,p_n) \to (\spc{L}_\o,p_\o)$ as $n\to\o$;
\item $f_n\:\spc{L}_n\subto \RR$ and $f_\o\:\spc{L}_\o\subto \RR$ are locally Lipschitz and $\lambda$-concave and $f_n\to f_\o$ as $n\to\o$.
\end{itemize}
Then 
\[|\nabla_{x_\o} f_\o|
=
\inf \{\lim_{n\to \o} |\nabla_{x_n} f_n|\},\]
where infimum is taken for all sequences $x_n\in\Dom f_n$ such that $x_n\to x_\o\in \Dom f_\o$ as $n\to\o$.
\end{thm}

\parit{Proof of \ref{lem:gradcon}.} 
Fix an $\eps>0$ and choose $y_\o\in \Dom f_\o$ sufficiently close to $x_\o$ such that 
\[|\nabla_{x_\o} f_\o|-\eps<\frac{f_\o(y_\o)-f_\o(x_\o)}{\dist{x_\o}{y_\o}{}}.\]
Choose $y_n\in \spc{L}_n$ such that $y_n\to y_\o$ as $n\to\o$. 
Sinse $\dist{x_\o}{y_\o}{}$ is sufficiently small, the $\lambda$-concavity of $f_n$ implies that
\[ |\nabla_{x_\o} f_\o|-2\cdot\eps
<
(\d_{x_n}f_n)(\dir{x_n}{y_n}),\]
for $\o$-almost all $n$.
Hence,
\[
|\nabla_{x_\o} f_\o|-2\cdot\eps
\le 
\lim_{n\to \o} |\nabla_{x_n} f_n|.\]
Sinse $\eps>0$ is arbitrary, the proposition follows.
\qeds

Note that the distance preserving map $\iota\:\spc{L}\hookrightarrow \spc{L}^\o$ induces an embedding 
\[\d_p\iota\:\T_p \spc{L}\hookrightarrow \T_p \spc{L}^\o.\]
Thus, we can (and will) consider $\T_p \spc{L}$ as a subcone of $\T_p \spc{L}^\o$.

\begin{thm}{Corollary}\label{nablaf=mablaf^o}
Let $\spc{L}\in\CBB{}{}$ 
and $f\:\spc{L}\subto\RR$ be locally Lipschitz semiconcave subfunction.
Then for any point $p\in\Dom f$ we have
\[\nabla_p f=\nabla_p f^\o.\]

\end{thm}

\parit{Proof.} 
Note that $\spc{L}\supset\Dom f\subset \Dom f^\o\subset \spc{L}^\o$. 
Applying \ref{lem:gradcon} for $\spc{L}_n=\spc{L}$ and $x_n=x$, we get $|\nabla_x f|\ge|\nabla_x f^\o|$.

On the other hand, $f=f^\o|\spc{L}$, hence $\d_p f=\d_p f^\o|\T_p \spc{L}$.
Thus, from \ref{alm-max},
$|\nabla_x f|\le|\nabla_x f^\o|$. 
Therefore
\[
|\nabla_x f|=|\nabla_x f^\o|.
\eqlbl{gradfgradultraf}
\]



Further,
\begin{align*}
|\nabla_x f|^2&=(\d_p f)(\nabla_x f)\\
&=\d_pf^\o(\nabla_x f)\le\\ 
&\le\<\nabla_x f^\o,\nabla_x f\>=\\
&=|\nabla_x f^\o|\cdot|\nabla_x f|\cdot\cos\mangle(\nabla_x f^\o,\nabla_x f).
\end{align*}
Together with \ref{gradfgradultraf}, this implies $\mangle(\nabla_x f^\o,\nabla_x f)=0$ and the statement follows.
\qeds

In particular, we have lower-semicontinuity of the function $x\mapsto |\nabla_x f|$:

\begin{thm}{Semicontinuity of \textbar gradient\textbar}\label{cor:gradlim} 
Let $\spc{L}\in\CBB{}{}$ 
and $f\:\spc{L}\subto\RR$ be locally Lipschitz semiconcave subfunction. 
Then the function $x\mapsto|\nabla_x f|$  is lower-continuous;
i.e. for any sequence $x_n\to x\in \Dom f$, we have 
\[|\nabla_x f|\le \liminf_{n\to \infty} |\nabla_{x_n} f|.\]
\end{thm}

\noi\textit{Proof.} 
According to \ref{nablaf=mablaf^o}, $|\nabla_x f|=|\nabla_x f^\o|$. 
Applying \ref{lem:gradcon} for $x_n\to x$, we get that
\[\lim_{n\to\o}|\nabla_{x_n}f|
\ge
|\nabla_x f^\o|
=
|\nabla_x f|.\]
Passing to arbitrary subsequence of $(x_n)$ we obtain the result. \qeds


















\section{Gradient-like curves}\label{sec:gradient-like}


Gradient-like curves provide a technical tool which will be used later in the construction of gradient curves.
The later appear to be a special reparametrization of gradient-like curves.

\begin{thm}{Definition}\label{def:grad-like-curve}
Let $\spc{L}\in \CBB{}{}$
and $f\:\spc{L}\subto\RR$ be locally Lipschitz semiconcave subfunction.

A Lipschitz curve $\hat\alpha\:[s_{\min},s_{\max})\to\Dom f$ will be called \emph{$f$-gradient-like curve} if
\[\hat\alpha^+=\tfrac{1}{|\nabla_{\hat\alpha} f|}\cdot\nabla_{\hat\alpha} f;\]
i.e., for any $s\in[s_{\min},s_{\max})$, $\hat\alpha^+(s)$ is defined and
$\hat\alpha^+(s)=\tfrac{1}{|\nabla_{\hat\alpha(s)} f|}\cdot\nabla_{\hat\alpha(s)} f$.
\end{thm}

Note that in particular this definition implies that $|\nabla_p f|>0$ for any point $p$ on $\hat\alpha$.
The next theorem shows that a weaker condition gives an equivalent definition.

\begin{thm}{Theorem}\label{thm:grad-like-2nd-def}
Let $\spc{L}\in \CBB{}{}$, 
$f\:\spc{L}\subto\RR$ be locally Lipschitz semiconcave subfunction
and 
$|\nabla_p f|>0$ for any $p\in\Dom f$.

A curve $\hat\alpha\:[s_{\min},s_{\max})\to\Dom f$ is an $f$-gradient-like curve if and only if it is $1$-Lipschitz and
\[\liminf_{s\to s_0+}\frac{f\circ\hat\alpha(s)-f\circ\hat\alpha(s_0)}{s-s_0}
\ge 
|\nabla_{\hat\alpha(s_0)} f|
\eqlbl{eq:thm:grad-like-2nd-def-1}\]
for almost all $s_0\in [s_{\min},s_{\max})$.
\end{thm}

\parit{Proof.} The ``only if'' part follows directly from definition.
To prove the ``if'' part, note that for any $s_0\in[s_{\min},s_{\max})$ we have
\begin{align*}
\liminf_{s\to s_0+}\frac{f\circ\hat\alpha(s)-f\circ\hat\alpha(s_0)}{s-s_0}
&\ge 
\liminf_{s\to s_0+}\oint\limits_{s_0}^s|\nabla_{\hat\alpha(\under s)}f|\cdot\d\under s
\ge
\\
&\ge 
|\nabla_{\hat\alpha(s_0)}f|;
\end{align*}
the first inequality follows from \ref{eq:thm:grad-like-2nd-def-1} 
and the second from lower-semicontinuity of function $x\mapsto|\nabla_x f|$, 
see \ref{cor:gradlim}.
Form \ref{lem:alm-grad}, we have 
\[\hat\alpha^+(s_0)=\tfrac{1}{|\nabla_{\hat\alpha(s_0)} f|}\cdot\nabla_{\hat\alpha(s_0)} f;\]
hence the result.
\qeds

%\parbf{Remark of A.} It might have sense to generalize the following theorem to the solutions $f''\le \phi(f,f')$ or at least to the solutions of $f''\le \lambda-\kappa\cdot f$ ???

The following theorem is similar to \cite[2.36]{mayer} and \cite[5.7]{ohta}.

\begin{thm}{Theorem} \label{thm:concave}
Let $\spc{L}\in\CBB{}{}$ 
and
$f\:\spc{L}\subto \RR$ be
locally Lipschitz and $\lambda$-concave. 
Assume $\hat\alpha\:[0,s_{\max})\to\Dom f$ is an $f$-gradient-like curve then 
\[(f\circ\hat\alpha)''\le\lambda\] 
everywhere on $[0,s_{\max})$.
\end{thm} 




\begin{thm}{Corollary}\label{cor:right-cont}
Let $\spc{L}\in\CBB{}{}$,
$f\:\spc{L}\subto \RR$ be a locally Lipschitz and semiconcave function 
and $\hat\alpha\:[0,s_{\max})\to\Dom f$ be an $f$-gradient-like curve.
Then function $s\mapsto |\nabla_{\hat\alpha(s)}f|$
is right-continuous, i.e. for any $s_0\in [0,s_{\max})$ we have
\[|\nabla_{\hat\alpha(s_0)}f|=\lim_{s\to s_0+} |\nabla_{\hat\alpha(s)}f|.\]

\end{thm}

\parit{Proof .} Applying \ref{thm:concave} locally, we have that $f\circ\hat\alpha(s)$ is semiconcave.
The statement follows since 
\[(f\circ\hat\alpha)^+(s)
=
(\d_p f)\l(\tfrac{1}{|\nabla_{\hat\alpha(s)}f|}\cdot\nabla_{\hat\alpha(s)}f\r)
=
|\nabla_{\hat\alpha(s)}f|.\]
\qedsf




\parit{Proof of \ref{thm:concave}.} For any $s>s_0$,
\begin{align*}
(f\circ\hat\alpha)^+(s_0)&=|\nabla_{\hat\alpha(s_0)}f|
\ge
\\
&\ge
(d_{\hat\alpha(s_0)}f)(\dir{\hat\alpha(s_0)}{\hat\alpha(s)})
\ge
\\
&\ge
\frac{f\circ\hat\alpha(s)-f\circ\hat\alpha(s_0)}{\dist{\hat\alpha(s)}{\hat\alpha(s_0)}{}}
-
\tfrac\lambda2\cdot\dist[{{}}]{\hat\alpha(s)}{\hat\alpha(s_0)}{}.
\end{align*}
Set $\lambda_+=\max\{0,\lambda\}$. 
Since $s-s_0\ge\dist{\hat\alpha(s)}{\hat\alpha(s_0)}{}$, for any $s>s_0$ we have 
\[(f\circ\hat\alpha)^+(s_0)\ge
\frac{f\circ\hat\alpha(s)-f\circ\hat\alpha(s_0)}{s-s_0}-\tfrac{\lambda_+}2\cdot(s-s_0).
\eqlbl{eq:thm:concave-1}\]
Thus $f\circ\hat\alpha$ is $\lambda_+$-concave.
That finishes the proof for $\lambda\ge 0$; in case $\lambda<0$ we get only that $f\circ\hat\alpha$ is $0$-concave.

Note that $\dist{\hat\alpha(s)}{\hat\alpha(s_0)}{}=s-s_0-o(s-s_0)$, thus
\[(f\circ\hat\alpha)^+(s_0)\ge
\frac{f\circ\hat\alpha(s)-f\circ\hat\alpha(s_0)}{s-s_0} -\tfrac\lambda2\cdot(s-s_0)+o(s-s_0).
\eqlbl{eq:thm:concave-2}\]
Together, \ref{eq:thm:concave-1} and \ref{eq:thm:concave-2} imply that $f\circ\hat\alpha$ is $\lambda$-concave.
\qeds  




\begin{thm}{Proposition}
\label{prop:grad-like-unique-past}
Let $\spc{L}\in\CBB{}{\kappa}$, $p,q\in\spc{L}$.
Assume $\hat\alpha\:[s_{\min},s_{\max})\to\spc{L}$ be a $\dist{p}{}{}$-gradient-like curve such that $\hat\alpha(s)\to z\in\l]p q\r[$ as $s\to s_{\max}+$
then $\alpha$ is a unit-speed geodesic
which lies in $[p q]$.
\end{thm}

\parit{Proof.} 
Clearly,
\[ \tfrac{d^+}{dt}\dist[{{}}]{q}{\hat\alpha(t)}{}
\ge
-1
\eqlbl{eq:>=-1}
\]
On the other hand,

\[\begin{aligned}
\tfrac{d^+}{dt}\dist[{{}}]{p}{\hat\alpha(t)}{}
&\ge
(\d_{\hat\alpha(t)}\dist{p}{}{})(\dir{\hat\alpha(t)}{q})
\ge\\
&\ge
-\cos\angk\kappa{\hat\alpha(t)}p q.
\end{aligned}
\eqlbl{eq:>=-cos}\]
Inequalities \ref{eq:>=-1} and \ref{eq:>=-cos} imply that the function $t\mapsto\angk\kappa q {\hat\alpha(t)}p $ is non-decreasing.
Hence the result.
\qeds










\section[Definition]{Gradient curves: Definition}\label{sec:grad-curves:def}

In this section we define gradient curves 
and tie %??? 
them tightly to gradient-like curves 
which were introduced in Section~\ref{sec:gradient-like}.


\begin{thm}{Definition}\label{def:grad-curve}
Let $\spc{L}\in \CBB{}{}$
and $f\:\spc{L}\subto\RR$ be a locally Lipschitz and semiconcave function.

A locally Lipschitz curve $\alpha\:[t_{\min},t_{\max})\to\Dom f$ will be called \emph{$f$-gradient curve} if
\[\alpha^+=\nabla_{\alpha} f;\]
i.e. for any $t\in[t_{\min},t_{\max})$, $\alpha^+(t)$ is defined and 
$\alpha^+(t)=\nabla_{\alpha(t)} f$.
\end{thm}

The next lemma states that gradient and gradient-like curves are special reparametrizations of each-other.

\begin{thm}{Lemma}\label{lem:grad--grad-like}
Let $\spc{L}\in\CBB{}{\kappa}$
and
$f\:\spc{L}\subto\RR$ be a locally Lipschitz semiconcave subfunction 
such that $|\nabla_p f|>0$ for any $p\in\Dom f$.

Assume  $\alpha\:[0,t_{\max})\to \Dom f$ be a locally Lipschitz curve 
and $\hat\alpha\:[0,s_{\max})\to \Dom f$ be its reparametrization by arc-length, 
so $\alpha=\hat\alpha\circ\varsigma$ for some homeomorphism $\varsigma\:[0,t_{\max})\to [0,s_{\max})$,
then 
\[\alpha^+=\nabla_\alpha f
\ \ \ \ \Leftrightarrow\ \ \ \  
\hat\alpha^+=\frac{1}{|\nabla_{\hat\alpha} f|}\cdot\nabla_{\hat\alpha} f\ \ 
\t{and}\ \ 
\varsigma^{-1}(s)
=
\int\limits_0^{s}\frac{\d\under s}{(f\circ\hat\alpha)'(\under s)
 }.\]
\end{thm}

\parit{Proof; $(\Rightarrow)$.} 
According to \ref{thm:speed},
\[\varsigma'(t)\ae|\alpha^+(t)|=|\nabla_{\alpha(t)}f|.
\eqlbl{eq:lem:grad--grad-like-1}\]
Note that 
\[(f\circ\alpha)'(t)\ae (f\circ\alpha)^+(t)=|\nabla_{\alpha(t)} f|^2.\]
Setting $s=\varsigma(t)$, we have
\[(f\circ\hat\alpha)'(s)\ae\frac{(f\circ\alpha)'(t)}{\varsigma'(t)} \ae|\nabla_{\alpha(t)}f|=|\nabla_{\hat\alpha(s)}f|.\]
From \ref{thm:grad-like-2nd-def}, it follows that $\hat\alpha(t)$ is an $f$-gradient-like curve, i.e.
\[\hat\alpha^+=\frac{1}{|\nabla_{\hat\alpha} f|}\cdot\nabla_{\hat\alpha} f.\]
In particular, $(f\circ\hat\alpha)^+(s)=|\nabla_{\hat\alpha^+(s)} f|$ and from \ref{eq:lem:grad--grad-like-1},
\[\varsigma^{-1}(s)=\int\limits_0^{s}\frac{1}{|\nabla_{\hat\alpha(\under s)} f|}\cdot\d\under s
=
\int\limits_0^{s}\frac{1}{(f\circ\hat\alpha)'(\under s)}\cdot\d\under s.\]
\medskip

\noi{$(\Leftarrow)$.}
Clearly,
\[\varsigma(t)
=
\int\limits_0^{t}(f\circ\hat\alpha)^+(\varsigma(\under t))\cdot\d \under t
=
\int\limits_0^{t}|\nabla_{\alpha(\under t)}f|\cdot\d \under t.\]
According to \ref{cor:right-cont}, the function $s\mapsto|\nabla_{\hat\alpha(s)}f|$ is right-continuous.
Therefore the same is true for function $t\mapsto|\nabla_{\hat\alpha\circ\varsigma(t)}f|=|\nabla_{\alpha(t)}f|$.
Hence, for any $t_0\in[0,t_{\max})$ we have
\[\varsigma^+(t_0)
=
\lim_{t\to t_0+}\oint\limits_{t_0}^t|\nabla_{\alpha(\under t)}f|\cdot\d\under t
=
|\nabla_{\alpha(t_0)}f|.\]
Thus, we have 
\[\alpha^+(t_0)
=
\varsigma^+(t_0)\cdot\hat\alpha^+(\varsigma(t_0))
=
\nabla_{\alpha(t_0)} f.\]
\qedsf





















\section[Distance estimates]{Gradient curves:
distance estimates}\label{sec:grad-curv:dist-est}

%??? ADD ONE MORE ESTIMATE

\begin{thm}{First distance estimate}\label{thm:dist-est}
Let $\spc{L}\in\CBB{}{\kappa}$, 
$f\:\spc{L}\to \RR$ be a locally Lipschitz 
and $\lambda$-concave function.
Assume $\alpha,\beta\:[0,t_{\max})\to \spc{L}$ be two $f$-gradient then for any $t\in[0,t_{\max})$
\[\dist{\alpha(t)}{\beta(t)}{}
\le 
e^{\lambda\cdot t}\cdot\dist[{{}}]{\alpha(0)}{\beta(0)}{}.\]

Moreover, the same conclusion holds for a for locally Lipschitz and $\lambda$-concave subfunction $f\:\spc{L}\subto \RR$ if for any $t\in[0,t_{\max})$ there is a geodesic $[\alpha(t)\,\beta(t)]$ in $\Dom f$.
\end{thm}

\parit{Proof.} 
If $\spc{L}$ is not geodesic space, let us pass to its ultrapower $\spc{L}^\o$.

Fix a choice of geodesic $[\alpha(t)\,\beta(t)]$ for each $t$.

Set $\ell(t)=\dist{\alpha(t)}{\beta(t)}{}$, from the first variation inequality (\ref{lem:first-var}) and the estimate in \ref{cor:grad-lip} we get
\[\ell^+(t)\le-\<\dir{\alpha(t)}{\beta(t)},\nabla_{\alpha(t)}f\>-\<\dir{\beta(t)}{\alpha(t)},\nabla_{\beta(t)}f\>\le \lambda\cdot\ell(t).\]
Hence the result.
\qeds

The following result will not be needed in this chapter, 
it just goes naturally with the previous one.

\begin{thm}{Second distance estimate}\label{lem:fg-dist-est}
Let $\spc{L}\in\CBB{}{\kappa}$, 
$\eps>0$ 
and $f,g\:\spc{L}\to \RR$ be two $\lambda$-concave locally Lipschitz function such that $|f-g|<\eps$.
Assume
$\alpha,\beta\:[0,t_{\max})\to \spc{L}$ are correspondingly $f$- and $g$-gradient curves such that $\alpha(0)=\beta(0)$.
Then 
\[\dist{\alpha(t)}{\beta(t)}{}
\le
\sqrt{\tfrac{1}{2\cdot\eps\cdot\lambda}
\cdot
\l(e^{\frac{t\cdot\lambda}\eps}-1\r)}\]
for any $t\in[0,t_{\max})$.
In particular, if $t_{\max}<\infty$, then
\[\dist{\alpha(t)}{\beta(t)}{}
\le
\Const\cdot\sqrt{\eps\cdot t}\]
for some constant $\Const=\Const(t_{\max},\lambda)$.


Moreover, the same conclusion holds for locally Lipschitz and $\lambda$-concave subfunctions $f,g\:\spc{L}\subto \RR$ if for any $t\in[0,t_{\max})$ there is a geodesic $[\alpha(t)\,\beta(t)]$ in $\Dom f\cap\Dom g$.
\end{thm}

\parit{Proof.} Set $\ell=\ell(t)=\dist{\alpha(t)}{\beta(t)}{}$.
Fix arbitrary fixed $t$, set $p=\alpha(t)$ and $q=\beta(t)$.
From the first variation formula and \ref{lem:grad-lip},
\begin{align*}
 \ell^+
&\le -\<\dir{p}{q},\nabla_{p}f\>
-\<\dir{q}{p},\nabla_{q}g\>
\le
\\
&\le -{\l({f(q)}-{f(p)}-\lambda\cdot\tfrac{\ell^2}2\r)}/{\ell}
-{\l({g(p)}-{g(q)}-\lambda\cdot\tfrac{\ell^2}2\r)}/{\ell}\le
\\
&\le \lambda\cdot\ell+\tfrac{2\cdot\eps}{\ell}
.
\end{align*}
Integrating the above estimate, we get
\[\ell(t)
\le
\sqrt{\tfrac{1}{2\cdot\eps\cdot\lambda}
\cdot\l(e^{\frac{t\cdot\lambda}\eps}-1\r)}.\]
\qedsf




\section[Existence, uniqueness, convergence]{Gradient curves: existence, uniqueness and convergence}
\label{sec:grad-curv:exist}

In general, ``past'' of gradient curves can not be determined by present.
For example, consider concave function $f\:\RR\to\RR$, $f(x)=-|x|$;
two curves $\alpha(t)=\min\{0,t\}$ and $\beta(t)=0$
are $f$-gradient and $\alpha(t)=\beta(t)=0$ for all $t\ge0$, 
however $\alpha(t)\not=\beta(t)$ for all $t<0$.

The next theorem shows that ``future'' gradient curve is unique.

\begin{thm}{Picard's theorem}\label{thm:picard}
Let $\spc{L}\in\CBB{}{}$
and
$f\:\spc{L}\subto \RR$ be semiconcave subfunction.
Assume $\alpha,\beta\:[0,t_{\max})\to\Dom f$ be two $f$-gradient curves 
such that $\alpha(0)=\beta(0)$ then $\alpha(t)=\beta(t)$ for any $t\in[0,t_{\max})$.
\end{thm}

\parit{Proof.} Follows directly from the first distance estimate (\ref{thm:dist-est}).\qeds

\begin{thm}{Local existence}\label{thm:exist-grad-curv}
Let $\spc{L}\in\CBB{}{\kappa}$ 
and $f\:\spc{L}\subto \RR$ be locally Lipschitz $\lambda$-concave subfunction.
Then for any $p\in \Dom f$
\begin{subthm}{}
if $|\nabla_pf|>0$ then for some $\eps>0$, 
there is an $f$-gradient-like curve $\hat\alpha\:[0,\eps)\to\spc{L}$ which starts at $p$ (i.e. $\hat\alpha(0)=p$);
\end{subthm}

\begin{subthm}{}for some $\delta>0$, there is an $f$-gradient curve $\alpha\:[0,\delta)\to \spc{L}$ which starts at $p$ (i.e. $\alpha(0)=p$).
\end{subthm}
\end{thm}

This theorem was proved in \cite{perelman-petrunin:qg};
here we present a simplified proof from \cite{lytchak:open-map}.

\parit{Proof.} 
Note that if $|\nabla_p f|=0$ then one can take constant curve $\alpha(t)=p$.
Otherwise, take $\eps>0$, 
such that $\oBall(p,\eps)\subset\Dom f$,
the restriction $f|_{\oBall(p,\eps)}$ is Lipschitz
and $|\nabla_x f|>\eps$ for all $x\in \oBall(p,\eps)$;
that is possible due to semicontinuity of \textbar gradient\textbar\ (\ref{cor:gradlim}).

The curves $\hat\alpha$ and $\alpha$ will be constructed in the following three steps.
First we construct an $f^\o$-gradient-like curve $\hat\alpha_\o\:[0,\eps)\to\spc{L}^\o$ as an $\o$-limit of certain sequence of broken geodesics in $\spc{L}$.
Second, we parametrize $\hat\alpha_\o$ as in \ref{lem:grad--grad-like}, to obtain an $f^\o$-gradient curve $\alpha_\o$ in $\spc{L}^\o$.
Third, applying Picard's theorem (\ref{thm:picard}) together with Lemma~\ref{lem:X-X^w}, we obtain that $\alpha_\o$ lies in $\spc{L}\subset \spc{L}^\o$ and therefore one can take $\alpha=\alpha_\o$ and $\hat\alpha=\hat\alpha_\o$.

Note that if $\spc{L}$ is proper then $\spc{L}=\spc{L}^\o$ and $f^\o=f$.
Thus, in this case, the third step is not necessary.

\parit{Step 1.}
Given $n\in \NN$, 
by open-close argument,
we can construct a unit-speed curve $\hat\alpha_n\:[0,\eps] \to \spc{L}$ starting at $p$, with a partition of $[0,\eps)$ into countable number of half-open intervals $[\varsigma_i,\bar\varsigma_i)$ 
so that for each $i$ we have 
\begin{enumerate}[(i)]
\item $\hat\alpha_n([\varsigma_i,\bar\varsigma_i])$ is a geodesic and $\bar\varsigma_i-\varsigma_i<\tfrac{1}{n}$.
\item\label{alm-grad} 
$f\circ\hat\alpha_n(\bar\varsigma_i)-f\circ\hat\alpha_n(\varsigma_i)
>
(\bar\varsigma_i-\varsigma_i)
\cdot
(|\nabla_{\hat\alpha_n(\varsigma_i)}f|-\tfrac{1}{n}).$
\end{enumerate}

Pass to a subsequence of $(\hat\alpha_n)$ such that $f\circ\hat\alpha_n$ uniformly converges; set 
\[h(s)=\lim_{n\to\infty}f\circ\hat\alpha_n(s).\]

Set $\hat\alpha_\o=\lim_{n\to\o}\hat\alpha_{n}$, 
it is a curve in $\spc{L}^\o$ 
which starts at $p\in \spc{L}\subset \spc{L}^\o$.

Clearly $\hat\alpha_\o$ is $1$-Lipschitz.
From (\ref{alm-grad}) and \ref{lem:gradcon}, we get \[(f^\o\circ\hat\alpha_\o)^+(\varsigma)\ge|\nabla_{\hat\alpha_\o(\varsigma)}f^\o|.\]
According to \ref{thm:grad-like-2nd-def}, $\hat\alpha_\o\:[0,\eps)\to \spc{L}^\o$  is an $f^\o$-gradient-like curve.

\parit{Step 2.}
Clearly $h(s)=f^\o\circ\alpha_\o$. 
Therefore, according to \ref{thm:concave}, $h$ is $\lambda$-concave.
Thus, we can define a homeomorphism $\varsigma\:[0,\delta]\to[0,\eps]$ by 
\[{\varsigma^{-1}(s)}
=
\int\limits_0^{s}\frac{1}{h'(\under s)}\cdot\d\under s,
\eqlbl{eq:thm:exist-grad-curv-1}\]

According to \ref{lem:grad--grad-like}, $\alpha(t)=\hat\alpha\circ\varsigma(t)$ is an $f^\o$-gradient curve in $\spc{L}^\o$. 

\parit{Step 3.}
Clearly, $\nabla_p f=\nabla_p f^\o$ for any $p\in \spc{L}\subset \spc{L}^\o$;
more formally if $\iota\:\spc{L}\hookrightarrow\spc{L}^\o$ is the natural embedding then
$(\d_p\iota)(\nabla_p f)=\nabla_p f^\o$.
Thus, it is sufficient to show that $\alpha_\o\subset \spc{L}$.
Assume the contrary, then according to \ref{lem:X-X^w} there is a subsequence $\hat\alpha_{n_\kay}$ such that
\[\hat\alpha_\o\not
=
\hat\alpha'_\o
\df
\lim_{\kay\to\o}\hat\alpha_{n_\kay}.\]
Clearly $h(s)=f^\o\circ\hat\alpha_\o=f^\o\circ\hat\alpha'_\o$.
Thus, for $\varsigma\:[0,\delta]\to[0,\eps]$ defined by \ref{eq:thm:exist-grad-curv-1}, 
we have that both curves
$\hat\alpha_\o\circ\varsigma$ and $\hat\alpha'_\o\circ\varsigma$ are $f^\o$-gradient.
Thus, from Picard's theorem (\ref{thm:picard}), we get $\hat\alpha_\o\circ\varsigma=\hat\alpha'_\o\circ\varsigma$ and therefore $\hat\alpha_\o=\hat\alpha'_\o$, a contradiction
\qeds

\begin{thm}{Ultra limit of gradient curves}\label{ultr-lim-g-curve}
Assume
\begin{itemize}
\item $\spc{L}_n\in\CBB{}{\kappa}$ and $(\spc{L}_n,p_n) \to (\spc{L}_\o,p_\o)$ as $n\to\o$;
\item $f_n\:\spc{L}_n\subto \RR$ are $\Lip$-Lipschitz and $\lambda$-concave
$f_n\to f_\o$ as $n\to\o$ and $p_\o\in\Dom f_\o$.
\end{itemize}

Then 

\begin{subthm}{lim-grad-like}
If $|\nabla_{p_\o}f_\o|>0$ then there is $\eps>0$ such that, the $f_n$-gradient-like curves $\hat\alpha_n\:[0,\eps)\to\spc{L}_n$ are defined for $\o$-almost all $n$.
And moreover, a curve $\hat\alpha_\o\:[0,\eps)\to\spc{L}_\o$ is a gradient-like curve which starts at $p_\o$ if and only if
$\hat\alpha_n(s)\to\hat\alpha_\o(s)$ as $n\to\o$ for all $s\in[0,\eps)$.
\end{subthm}

\begin{subthm}{lim-grad}
For some $\delta>0$, the $f_n$-gradient curves $\alpha_n\:[0,\delta)\to\spc{L}_n$ are defined for $\o$-almost all $n$.
And moreover, a curve $\alpha_\o\:[0,\delta)\to\spc{L}_\o$ is a gradient curve which starts at $p_\o$ if and only if
$\alpha_n(t)\to\alpha_\o(t)$  as $n\to\o$ for all $t\in[0,\delta)$.
\end{subthm}
\end{thm}

%??? We need a convergence theorem, which would work for radial curves as well???

The idea in the proof is the same as in the proof of local existence (\ref{thm:exist-grad-curv}).

\parit{Proof.}
According to \ref{thm:convex-limit-cbb}, $f_\o$ is $\lambda$-concave.

\parit{``if''-part of (\ref{SHORT.lim-grad-like}).}
Take $\eps>0$ so small that $\oBall(p_\o,\eps)\subset\Dom f_\o$ and $|\nabla_{x_\o}f_\o|>0$ for any $x_\o\in\oBall(p_\o,\eps)$ (that is possible due to \ref{cor:gradlim}).

Clearly $\hat\alpha_\o$ is $1$-Lipschitz.
From \ref{lem:gradcon}, we get 
$(f_\o\circ\hat\alpha_\o)^+(s)
\ge
|\nabla_{\hat\alpha_\o(s)}f^\o|$.
According to \ref{thm:grad-like-2nd-def}, $\hat\alpha_\o\:[0,\eps)\to \spc{L}^\o$  is an $f_\o$-gradient-like curve.

\parit{``if''-part of (\ref{SHORT.lim-grad}).} Assume first $|\nabla_{p_\o}f_\o|>0$ ---
so we can apply ``if''-part of (\ref{SHORT.lim-grad-like}).
Let $h_n=f_n\circ\hat\alpha_n\:[0,\eps)\to \RR$ 
and $h_\o=f_\o\circ\hat\alpha_\o$.
From \ref{thm:concave}, $h_n$ are $\lambda$-concave and clearly $h_n\to h_\o$ as $n\to\o$.
Let us define reparametrizations
\begin{align*}
{\varsigma_n^{-1}(s)}
&=
\int\limits_0^{s}\frac{1}{h_n'(\under s)}\cdot\d\under s,
&
{\varsigma_\o^{-1}(s)}
&=
\int\limits_0^{s}\frac{1}{h_\o'(\under s)}\cdot\d\under s.
\end{align*}
The $\lambda$-convexity of $h_n$ implies that $\sigma_n\to\sigma_\o$ as $n\to\o$.
By Lemma~\ref{lem:grad--grad-like}, 
$\alpha_n=\hat\alpha_n\circ\varsigma_n$.
Applying ``if''-part of (\ref{SHORT.lim-grad-like}) together with Lemma~\ref{lem:grad--grad-like},
we get that $\alpha_\o=\hat\alpha_\o\circ\varsigma_\o$ is gradient curve.

The remaining case $|\nabla_{p_\o}f_\o|=0$, can be reduced to the one above using the following trick.
Consider sequence of spaces $\spc{L}_n^{\times}=\spc{L}_n\times\RR$,
with the sequence of subfunction $f^{\times}_n\:\spc{L}_n^{\times}\to\RR$, defined by
$f^{\times}_n(p,t)=f_n(p)+t$.
According to Theorem~\ref{thm:cbb-product}, 
$\spc{L}_n^{\times}\in\CBB{}{\kappa_-}$ for $\kappa_-=\min\{\kappa,0\}$
and clearly,
and $f_n^{\times}$ are $\lambda_+$-concave,
for $\lambda_+=\max\{\lambda,0\}$.
Analogously define  $\spc{L}_\o^{\times}=\spc{L}_\o\times\RR$,
and $f^{\times}_\o(p,t)=f_\o(p)+t$.

Clearly 
$\spc{L}_n^{\times}\to\spc{L}_\o^{\times}$,
$f_n^{\times}\to f_\o^{\times}$ as $n\to\o$
and $|\nabla_xf^{\times}_\o|>0$ for any $x\in\Dom f_\o^{\times}$.
Thus, for the sequence $f_n^{\times}\:\spc{L}_n^{\times}\subto\RR$, 
we can apply ``if''-part of (\ref{SHORT.lim-grad-like}).
It is easy to see that $\alpha^{\times}_\o(t)=(\alpha_\o(t),t)$ is a $f^{\times}_\o$-gradient curve in $\spc{L}^{\times}_\o$ 
if and only if $\alpha_\o(t)$ is a $f_\o$-gradient curve.

\parit{``only if''-part of (\ref{SHORT.lim-grad}) and (\ref{SHORT.lim-grad-like}).}
The ``only if''-part of (\ref{SHORT.lim-grad}) follows from
the ``if''-part of (\ref{SHORT.lim-grad}) and Picard's theorem (\ref{thm:picard}).
Applying Lemma~\ref{lem:grad--grad-like}, we get ``only if''-part of (\ref{SHORT.lim-grad-like}).
\qeds

Directly form local existence (\ref{thm:exist-grad-curv}) and distance estimates (\ref{thm:dist-est}), we get the following:

\begin{thm}{Global existence}\label{thm:glob-exist-grad-curv}
Let $\spc{L}\in\CBB{}{\kappa}$ 
and $f\:\spc{L}\subto \RR$ be locally Lipschitz and $\lambda$-concave subfunction.
Then for any $p\in \Dom f$, there is $t_{\max}\in(0,\infty]$ such that
there is an $f$-gradient curve $\alpha\:[0,t_{\max})\to \spc{L}$ with $\alpha(0)=p$.
Moreover, for any sequence $t_n\to t_{\max}-$, the sequence $\alpha(t_n)$ does not have a limit point in $\Dom f$.
\end{thm}


The following theorem gurantees the existance of gradient curves for all times for the special type of semiconcave functions which play important role in the theory.
It follows from \ref{thm:glob-exist-grad-curv},
\ref{thm:concave} and \ref{lem:grad--grad-like}.

\begin{thm}{Theorem}\label{thm:comp-grad-test}
Let $\spc{L}\in\CBB{}{}$ 
and $f\:\spc{L}\to\RR$ satisfies 
\[f''+\kappa\cdot f\le \lambda\] 
for some real values $\kappa$ and $\lambda$.
Then $f$ has \index{complete gradient}\emph{complete gradient};
that is for any $x\in\spc{L}$ there is a $f$-gradient curve $\alpha\:[0,\infty)\to\spc{L}$ which starts at $x$.
\end{thm}

\section[Family of functions]{Gradient curves of a family of functions}

Here we extend notion of gradient curves to a family of functions.

Let $\spc{L}\in\CBB{}{}$.
A subfunction $f\:\RR\times\spc{L}\subto\RR$, will be called \emph{family of subfunctions}\index{family of subfunctions};
in this case we prefer the notation $f\:(t,p)\mapsto f_t(p)$.
A family of subfuncrions $f_t$ is called 
\emph{locally Lipschitz}%
\index{locally Lipschitz family of subfunction} 
if the corresponding subfunction $(t,p)\mapsto f_t(p)$ is locally Lipschitz.

Let $\lambda\:\RR\subto\RR\:t\mapsto \lambda_t$ be a continuous subfunction.
A family of subfunctions $f_t\:\spc{L}\to \RR$, will be called \emph{$\lambda_t$-concave}\index{$\lambda_t$-concave} 
and for each fixed $t$, the subfunction $f_t\:\spc{L}\subto\RR$ is $\lambda_t$-concave. 

Let $\II$ be a real inetrval, and $\alpha\:\II\to\spc{L}$ be locally Lipschitz??? curve.
We will write 
$\alpha^+(t)=\nabla f_t$
if for any $t\in \II$, the right tangent vector $\alpha^-(t)$
is defined and $\alpha^+(t)=\nabla_{\alpha(t)}f_t$.
The same way we can consider equation $\alpha^-(t)=\nabla_{\alpha(t)}f_t$
for the left tangent vector.
The solutions of $\alpha^+(t)=\nabla f_t$ will be also called $f_t$-gradient curves.

The following proposition extends
the existence \ref{thm:glob-exist-grad-curv},
the distance estimates \ref{thm:dist-est}, \ref{lem:fg-dist-est}
and passage to the limit \ref{ultr-lim-g-curve} to the gradient curves for a family of semiconcave functions.
The proofs are straightforward, and left to the reader.

\begin{thm}{Proposition-definition}\label{prop-def}
Let $\spc{L}\in\CBB m\kappa$,
$\II$ be an open real interval, 
$\lambda\:t\mapsto\lambda_t\:\II\to\RR$ be a continuous function and 
$f_t\:\spc{L}\to \RR$, $t\in \II$ be locally Lipschitz $\lambda_t$-concave family of subfunctions.

Then for any $t^0\in\II$ and any $x^0\in \Dom f_t$ there is an $f_t$-gradient curve $\alpha$ which is defined in a neighborhood of $t^0$ and such that $\alpha(t^0)\z=x^0$.
Moreover
\begin{subthm}{}
If $\alpha,\beta\:\II\to \spc{L}$ are $f_t$-gradient then for any $t^0,t^1\in\II$, $t^0\le t^1$,
\[\dist{\alpha(t^1)}{\beta(t^1)}{}\le \Lip\cdot\dist[{{}}]{\alpha(t^0)}{\beta(t^0)}{},\]
where 
\[\Lip=\exp\l(\int\limits_{t^0}^{t^1}\lambda(t)\cdot\d t\r).\]
\end{subthm}

\begin{subthm}{}
Let $\eps>0$ 
and $f_t,g_t\:\spc{L}\to \RR$ be two $\lambda_t$-concave locally Lipschitz family of function such that $|f-g|<\eps$.
Assume
$\alpha,\beta\:[0,t_{\max})\to \spc{L}$ are correspondingly $f_t$- and $g_t$-gradient curves such that $\alpha(0)=\beta(0)$.
Then 
\[\dist{\alpha(t)}{\beta(t)}{}
\le ???
\sqrt{\tfrac{1}{2\cdot\eps\cdot\lambda}
\cdot
\l(e^{\frac{t\cdot\lambda}\eps}-1\r)}\]
for any $t\in[0,t_{\max})$.
In particular, if $t_{\max}<\infty$, then
\[\dist{\alpha(t)}{\beta(t)}{}
\le
???\Const\cdot\sqrt{\eps\cdot t}\]
for some constant $\Const=\Const(t_{\max},\lambda)$.

Moreover, the same conclusion holds for locally Lipschitz and $\lambda_t$-concave subfunctions $f_t,g_t\:\spc{L}\subto \RR$ if for any $t\in[0,t_{\max})$ there is a geodesic $[\alpha(t)\,\beta(t)]$ in $\Dom f\cap\Dom g$.
\end{subthm}

\begin{subthm}{}
???convergence
\end{subthm}



\end{thm}

\section{Gradient curves for non-Lipschitz functions}\label{sec:non-lip}

\def\LSCSC{\mathrm{LCC}}%???
\def\Wasserstein{\mathrm{P}_2}

In this book, we only consider gradient curves for locally Lipschitz semiconcave subfunctions;
it turns out to be sufficient for all our needs.
However, 
instead of Lipschitz semi-concave subfunctions,
it is more natural to consider upper semi-continuous semi-concave functions
with target in $[-\infty,\infty)$
and to assume in addition that 
the function take finite values at a dense set in the domain of definition.
The set of such subfunctions on a $\CBB{}{}$ space $\spc{L}$ will be denoted as 
$\LSCSC(\spc{L})$ for \textbf{l}ower semi-\textbf{c}ontinous and semi-\textbf{c}oncave.

In this section we describe the adjustments needed
to construct gradient curves in for the subfunctions in $\LSCSC(\spc{L})$.

There is one place where this type of functions appears;
it is the entropy and some other closely related functionals on the Wasserstein space over a $\CBB{}{0}$ space.
The gradient flow for these function play an important role in the theory of optimal transport, see \cite{villani} and references there in. 


\parbf{Differential.} 
First we need to extend the definition of differential (\ref{def:differential}) to $\LSCSC$ subfunctions.

Let $\spc{L}\in\CBB{}{}$ and $f\in\LSCSC(\spc{L})$.
Given a point $p\in \Dom f$, and a geodesic direction $\xi=\dir pq$, 
set 
$\hat \d_pf(\xi)=(f\circ\geod_{[pq]})^+(0)$.
Since $f$ is semiconcave the value $\hat \d_pf(\xi)$ is defined if $f\circ\geod_{[pq]}(t)$ is finite at all sufficiently small values $t>0$,
but $\hat \d_pf(\xi)$ may take value $\infty$. 
Note that $\hat \d_pf$ is defined on a dense subset of $\Sigma_p$.

Set 
\[\d_pf(\zeta)=\limsup_{\xi\to\zeta}\hat\d_pf(\xi)\]
and then set $\d_pf(v)=|v|\cdot \d_pf(\xi)$ if $v=|v|\cdot\xi$ for some $\xi\in\Sigma_p$.

In other words, we define differential as the smallest 
upper semi-continuous  positive-homogeneous function $\d_pf\:\T_p\to\RR$
such that $\d_pf(\xi)\ge \hat \d_pf(\xi)$ if $\hat\d_pf(\xi)$ is defined.



\parbf{Existence and uniqueness of the gradient.}
Note that in the proof of \ref{thm:ex-grad}, 
we used Lipschitz condition just once,
to show that 
\begin{align*}
s&=\sup\set{(\d_p f)(\xi)}{\xi\in\Sigma_p}=
\\
&=\limsup_{x\to p}\frac{f(x)-f(p)}{\dist{x}{p}{}}<
\\
&<\infty.
\end{align*}


The value $s$ above will be denoted as $|\nabla|_pf$.
Note that 
if the gradient $\nabla_pf$ is defined then $|\nabla|_pf=|\nabla_pf|$
and otherwise $|\nabla|_pf=\infty$.

Summarizing the discussion above, 
we get the following.

\parbf{\ref{thm:ex-grad}$'$ Existence and uniqueness of the gradient.}
\textit{Assume $\spc{L}\in\CBB{}{\kappa}$
and $f\in \LSCSC(\spc{L})$. Then for any point $p\in \Dom f$ either 
there is unique gradient $\nabla_p f\in \T_p$ 
or $|\nabla|_pf=\infty$}

\medskip

Further, in all the results of Section~\ref{sec:grad-calculus}, 
we can only assume that $f\in \LSCSC(\spc{L})$ and its gradient is defined at the points in the consideration; 
the proofs are the same.

In sections \ref{sec:grad-semicont}--\ref{sec:grad-curv:exist}
require almost no changes;
mainly, where it is appropriate,
one needs to exchange $|\nabla_p f|$ 
to $|\nabla|_pf$ 
and/or assume that the gradient is defined at the points of interest.
Also one has to take \ref{eq:thm:grad-like-2nd-def-1} in Theorem \ref{thm:grad-like-2nd-def}
as the definition of gradient-like curve.
Then the theorem states that any  gradient-like curve $\alpha\:\II\to\spc{L}$ satisfies the definition \ref{def:grad-like-curve} at $t\in \II$ if $\nabla_{\hat\alpha(s)} f$ is defined.
Further in the Definition \ref{def:grad-curve}, should be changed to the following

\medskip

\parbf{\ref{def:grad-curve}$'$. Definition.}
{\it Let $\spc{L}\in \CBB{}{}$
and $f\in\LSCSC(\spc{L})$.

A curve 
$\alpha\:[t_{\min},t_{\max})\to\Dom f$ will be called \emph{$f$-gradient curve} if
\[\alpha^+(t)=\nabla_{\alpha(t)} f\]
if $\nabla_{\alpha(t)} f$ is defined and 
\[(f\circ\alpha)^+(t)=\infty\]
otherwise.}

\medskip

In the proof of Local existence (\ref{thm:exist-grad-curv}), the condition (\ref{alm-grad})
has to be exchanged to the following condition
\begin{itemize}

\item[{(\ref{alm-grad})}$'$]
$f\circ\hat\alpha_n(\bar\varsigma_i)-f\circ\hat\alpha_n(\varsigma_i)
>
(\bar\varsigma_i-\varsigma_i)
\cdot
\max\{n,|\nabla|_{\hat\alpha_n(\varsigma_i)}f-\tfrac{1}{n})\}.$
\end{itemize}

Any gradient curve $\alpha[0,\ell)\to\spc{L}$
for a subfunction
$f\in \LSCSC(\spc{L})$
satisfy the equation
\[\alpha^+(t)=\nabla_{\alpha(t)} f\]
at all values $t$ with possible exception $t=0$.
In particular, the gradient of $f$ is defined at all points of any 
$f$-gradient curve with the exception for the initial point.

\section{Gradient flow}\label{sec:Gradient flow}

In this section 
we define gradient flow for semiconcave subfunctions 
and reformulate theorems obtained earlier in this chapter using this new terminology.

Let $\spc{L}\in \CBB{}{}$ 
and $f\:\spc{L}\subto \RR$ be a locally Lipschitz semiconcave subfunctions.
For any $t\ge 0$ write $\GF^t_f(x)=y$ if there is a $f$-gradient curve $\alpha$ such that $\alpha(0)=x$ and $\alpha(t)=y$.
The defined map $\GF^t_f\:\spc{L}\to\spc{L}$
is called \index{gradient flow}\emph{$f$-gradient flow} for time $t$.
 
From \ref{lem:fg-dist-est}, 
it follows that for any $t\ge 0$, the domain of definition of $\GF^t_f$ is open subset of $\spc{L}$; 
that is, $\GF^t_f$ is a submap.
Moreover, if $f$ is defined on whole $\spc{L}$ and $f''+\Kappa\cdot f\le \lambda$ for some $\Kappa,\lambda\in\RR$, 
then according to \ref{thm:comp-grad-test}, $\GF^t_f(x)$ is defined for all pairs $(x,t)\in\spc{L}\times\RR_{\ge0}$.

Clearly $\GF^{t_1+t_2}_f=\GF_f^{t_1}\circ\GF_f^{t_2}$;
in other words gradient flow is given by an action of semigroup $(\RR_{\ge0},+)$.

From the first distance estimate~\ref{thm:dist-est},
we get the following.

\begin{thm}{Proposition}\label{prop:GF-is-lip}
Let $\spc{L}\in\CBB{}{}$ 
and $f\:\spc{L}\to \RR$ be a semiconcave functions.
Then the map $x\mapsto\GF^t_f(x)$ is locally Lipschitz.

Moreover, if $f$ is $\lambda$-concave then $\GF^t_f$ is $e^{\lambda\cdot t}$-Lipschitz.
\end{thm}

Next proposition states that gradient flow is stable under Gromov--Hausdorff convergence.
It follows directly from the proposition on ultra limit of gradient curves~\ref{ultr-lim-g-curve}.

\begin{thm}{Proposition}\label{grad-curve-conv}
If $\spc{L}_n\in \CBB m\kappa$, $\spc{L}_n\xto{\GH} \spc{L}$, $f_n\:\spc{L}_n\to\RR$ is a sequence of
$\lambda$-concave functions which converges to $f\:\spc{L}\to \RR$ then
$\GF_{f_n}^t\:\spc{L}_n\to \spc{L}_n$ converges to $\GF_f^t\:\spc{L}\to \spc{L}$.
\end{thm}

\parbf{On gradient flow for semiconcave functions 
on Riemannian manifolds.}
The gradient flow for general semiconcave functions 
on smooth Riemannian manifold  can be introduced much cheaper.
To do this note that the distance estimates proved in the Section~\ref{sec:grad-curv:dist-est}
can be proved the same way for gradient curves of smooth semiconcave subfunctions.
By Greene--Wu Lemma (see ???), 
given 
a $\lambda$-concave function $f$, 
a compact set $K\subset \Dom f$
and $\eps>0$
there is a smooth $(\lambda-\eps)$-concave function which is 
$\eps$-close to $f$ in the $C^0$-topology on $K$.
Hence one can apply the smoothing and pass to the limit as $\eps\to0$.
Note that by the second distance estimate the obtained limit curve does not depend on the smoothing.

\chapter{Gradient exponent}

\section{Radial curves: definition}\label{sec:Radial curves: definition}

The radial curves are specially reparametrized gradient curves for distance functions.
This parametrization makes them to behave as unit-speed geodesics in a natural comparison sense.

\begin{thm}{Definition}\label{def:rad-curv}
Assume $\spc{L}\in\CBB{}{}$, 
$\kappa\in\RR$, 
and $p\in \spc{L}$.
A curve 
$$\sigma\:[s_{\min},s_{\max})\to \spc{L}$$  
is called 
\emph{$(p,\kappa)$-radial curve} 
if
$$s_{\min}
\z=
\dist{p}{\sigma(s_{\min})}{}\in(0,\tfrac{\varpi\kappa}2),$$ 
and it satisfies the following differential equation
\[\sigma^+(s)
\z=
\frac{\tg\kappa\dist[{{}}]{p}{\sigma(s)}{}}{\tg\kappa s}
\cdot
\nabla_{\sigma(s)}\dist{p}{}{}.
\eqlbl{eq:rad}\]
for any $s\in[s_{\min},s_{\max})$, here $\tg\kappa x=\frac{\sn\kappa x}{\cs\kappa x}$.

If $x=\sigma(s_{\min})$, we say that $\sigma$ \emph{starts in}  $x$.
\end{thm}

Note that according to the definition $s_{\max}\le\tfrac{\varpi\kappa}2$.

Further you will see that the $(p,\kappa)$-radial curves 
work best for $\CBB{}{\kappa}$-spaces.



\begin{thm}{Definition}\label{def:rad-geod}
Let $\spc{L}\in\CBB{}{}$
and $p\in\spc{L}$.
A unit-speed geodesic  $\gamma\:\II\to \spc{L}$  is called 
\emph{$p$-radial geodesic}\index{radial geodesic} if 
$\dist{p}{\gamma(s)}{}\equiv s$.
\end{thm}

The proof of the following two propositions follows directly from the definitions: 

\begin{thm}{Proposition}\label{prop:rad-geod}
Let $\spc{L}\in\CBB{}{}$
and $p\in\spc{L}$.
Assume $\tfrac{\varpi\kappa}{2}
\ge 
s_{\max}$.
Then any $p$-radial geodesic 
$\gamma\:[s_{\min},s_{\max})
\to 
\spc{L}$ 
is a $(p,\kappa)$-radial curve.
\end{thm}

\begin{thm}{Proposition}\label{prop:dist<s}
Let $\spc{L}\in\CBB{}{}$, 
$p\in\spc{L}$ 
and $\sigma\:[s_{\min},s_{\max})\to \spc{L}$ be a $(p,\kappa)$-radial curve.
Then for any $s\in [s_{\min},s_{\max})$, 
we have $\dist{p}{\sigma(s)}{}\le s$.

Moreover, 
if for some $s_0$ we have $\dist{p}{\sigma(s_0)}{}= s_0$ 
then the restriction $\sigma|[s_{\min},s_0]$ is a $p$-radial geodesic.
\end{thm}

\begin{thm}{Existence and uniqueness}\label{rad-curv-exist}
Let $\spc{L}\in\CBB{}{}$, 
$\kappa\in\RR$, 
$p\in\spc{L}$, 
and $x\in \spc{L}$.
Assume
$0
<
\dist{p}{x}{}
<
\tfrac{\varpi\kappa}2$.
Then there is unique $(p,\kappa)$-radial curve $\sigma\:[\dist{p}{x}{},\tfrac{\varpi\kappa}2)\to \spc{L}$ 
which starts in $x$.
\end{thm}


\parit{Proof; existence.}
Set\index{$\itg\kappa$} 
\[\itg\kappa\:[0,\tfrac{\varpi\kappa}2)\to\RR,
\ \ 
\itg\kappa (t)=\int\limits_0^t\tg\kappa\under t\cdot\d\under t.\]
Clearly $\itg\kappa$ is smooth and increasing.
From \ref{prop:conv-comp} it follows that the composition 
\[f=\itg\kappa\circ\dist{p}{}{}\] 
is semiconcave in $\oBall(p,\tfrac{\varpi\kappa}2)$.

According to \ref{thm:exist-grad-curv}, there is an $f$-gradient curve $\alpha\:[0,t_{\max})\to \spc{L}$ defined on the maximal interval such that $\alpha(0)=x$.

Now consider solution of differential equation $\tau(t)$, $\tau'=(\tg\kappa\tau)^2$ and $\tau(0)=r$. 
Note that $\tau(t)$ is also a gradient curve  for function $\itg\kappa$ defined on $[0,\tfrac{\varpi\kappa}2)$.
Direct calculations show that composition $\alpha\circ\tau^{-1}$ 
forms an $(p,\kappa)$-radial curve.

\parit{Uniqueness.} Assume $\sigma^1,\sigma^2$ be two $(p,\kappa)$-radial curves which starts in $x$.
Then compositions $\sigma^i\circ\tau$ both give $f$-gradient curves.
By Picard's theorem (\ref{thm:picard}), we have
$\sigma^1\circ\tau 
\equiv 
\sigma^2\circ\tau$.
Therefore $\sigma^1(s)=\sigma^2(s)$ 
for any $s\ge r$ such that both sides are defined.
\qeds

\section{Radial comparisons}

In this section we show that radial curves in some comparison sense behave as unit-speed geodesics.

\begin{thm}{Radial monotonicity}\label{rad-mon}
Let $\spc{L}\in\CBB{}{\kappa}$ and
$p, q$ be distinct points in $\spc{L}$.
Assume $\sigma\:  [s_{\min},\tfrac{\varpi\kappa}2)\to \spc{L}$
is a $(p,\kappa)$-radial curve.
Then the function 
\[s\mapsto 
\tangle\mc\kappa\{
\dist{q}{\sigma(s)}{};
\dist{p}{q}{},
s
\}\]
is nonincreasing in all the domain of definition.
\end{thm}

From Radial monotonicity,
by straightforward calculations one gets the following.

\begin{thm}{Corollary}\label{cor:rad-comp}
Let $\kappa\le0$,
$\spc{L}\in\CBB{}{\kappa}$ 
and $p, q\in \spc{L}$.
Assume $\sigma\:[s_{\min},\tfrac{\varpi\kappa}2)\to \spc{L}$ is a $(p,\kappa)$-radial curves.
Then for any $w\ge 1$, 
the function
\[
s\mapsto \tangle\mc\kappa\{\dist{q}{\sigma(s)}{};\dist{p}{q}{},w\cdot s\}
\]
is non-increasing in whole domain of definition.
\end{thm}


\begin{thm}{Radial comparison}\label{rad-comp}
Let $\spc{L}\in\CBB{}{\kappa}$ 
and $p\in \spc{L}$.
Assume $\rho\:  [r_{\min},\tfrac{\varpi\kappa}2)\to \spc{L}$
and    $\sigma\:[s_{\min},\tfrac{\varpi\kappa}2)\to \spc{L}$
are two $(p,\kappa)$-radial curves.
Set
\[\phi_{\min}=\angkk\kappa p{\rho(r_{\min})}{\sigma(s_{\min})}.
\]
Then for any $r\in[r_{\min},\tfrac{\varpi\kappa}2)$ and  $s\in[s_{\min},\tfrac{\varpi\kappa}2)$,
we have
\[
\tangle\mc\kappa\{\dist{\rho(r)}{\sigma(s)}{};r,s\}
\le \phi_{\min},
\]
or equivalently,
\[
\dist{\rho(r)}{\sigma(s)}{}
\le \side\kappa\{\phi_{\min};r,s\}.
\]

\end{thm}


We prove both of the theorems simultaneously.
The proof is an application of \ref{lem:grad-lip} plus trigonometric manipulations.
We give a prove first in the simplest case $\kappa=0$
and then the harder case $\kappa\ne 0$.

We proof case $\kappa=0$ separately since it is easier to follow.
The arguments for both cases are nearly the same, 
but the case $\kappa\not=0$ require an extra idea.
In fact once the case $\kappa\not=0$ is proved, 
the case $\kappa=0$ can be obtained by a limit procedure.

\parit{Proof of \ref{rad-mon} and \ref{rad-comp} in case $\kappa=0$.}
Set

\begin{wrapfigure}[5]{r}{60mm}
\begin{lpic}[t(0mm),b(0mm),r(0mm),l(0mm)]{pics/rad-notation(0.16)}
\lbl[tr]{54,5;$p$}
\lbl[rb]{57,159;$\rho(r)$}
\lbl[r]{25,85;$\rho$}
\lbl[bl]{151,140;$\sigma(s)$}
\lbl[rt]{147,65;$\sigma$}
\lbl[br]{110,80;$S$}
\lbl[bl]{56,80;$R$}
\lbl[bl]{120,10;$\spc{L}$}
\lbl[b]{105,155;$\ell$}
\lbl[b]{305,150;$\ell$}
\lbl[rb]{252,80;$r$}
\lbl[br]{308,80;$s$}
\lbl[bl]{258,38;$\phi$}
\lbl[bl]{310,10;$\Lob2\kappa$}
\end{lpic}
\end{wrapfigure}


\begin{align*}
R=R(r)&=\dist{p}{\rho(r)}{},
\\
S=S(s)&=\dist{p}{\sigma(s)}{},
\\
\ell=\ell(r,s)&=\dist{\rho(r)}{\sigma(s)}{},
\\
\phi=\phi(r,s)&=\tangle\mc0\{\ell(r,s);r,s\}.
\end{align*}
It will be sufficient to prove the following two inequalities:
\[\frac{\partial^+\phi}{\partial r}(s_{\min},r)\le 0,\ \ \ \ \ \ \ \ \frac{\partial^+\phi}{\partial s}(s,r_{\min})\le 0\leqno(*)\mc0_\phi\]
\[
s\cdot\frac{\partial^+\phi}{\partial s}
+
r\cdot\frac{\partial^+\phi}{\partial r}\le 0.
\leqno(**)\mc0_\phi
\]

\begin{wrapfigure}{r}{45mm}
\begin{lpic}[t(-5mm),b(0mm),r(0mm),l(0mm)]{pics/r-s(0.18)}
\lbl[lb]{114,16;$r_{\min}$}
\lbl[lb]{14,66; $s_{\min}$}
\lbl[b]{177,179; {\small $(r_0,s_0)$}}
%\lbl[lb]{125,128,45; {\tiny $(r(t),s(t))$}}
\end{lpic}
\end{wrapfigure}
Once they are proved,
the radial monotonicity follows from $(*)\mc0_\phi$.
The radial comparison follows from both $(*)\mc0_\phi$ and $(**)\mc0_\phi$.
Indeed, one can connect $(s_{\min},r_{\min})$ and $(s_0,r_0)$ in $[s_{\min},\infty)\times[r_{\min},\infty)$ 
by a join of coordinate line and a segment defined by $r/s=r_0/s_0$.
According to $(*)\mc0_\phi$ and $(**)\mc0_\phi$, the value of $\phi$ does not increase while pair $(r,s)$ moving along this join.
Thus $\phi(r_0,s_0)\le\phi(r_{\min},s_{\min})=\phi_{\min}$.

It remains to show $(*)\mc0_\phi$ and $(**)\mc0_\phi$. 
First let us rewrite the inequalities $(*)\mc0_\phi$ and $(**)\mc0_\phi$ in an equivalent form:
\[
\frac{\partial^+\ell}{\partial s}(s,r_{\min})
\le 
\cos\tangle\mc0\{r_{\min};s,\ell\},
\ \ 
\frac{\partial^+\ell}{\partial r}(s_{\min},r)
\le 
\cos\tangle\mc0\{s_{\min};r,\ell\},\leqno(*)\mc0_\ell\]

\[
s\cdot\frac{\partial^+\ell}{\partial s}
+
r\cdot\frac{\partial^+\ell}{\partial r}\le 
 s\cdot\cos\tangle\mc0\{r;s,\ell\}
+
r\cdot\cos\tangle\mc0\{s;r,\ell\}=\ell.
\leqno(**)\mc0_\ell
\]

Set 
\[f=\tfrac{1}{2}\cdot\dist[2]{p}{}{}.\leqno(A)\mc0\] 
Clearly $f$ is $1$-concave and
\[\rho^+(r)=\tfrac{1}{r}\cdot\nabla_{\rho(r)} f\ \ \t{and}\ \ \sigma^+(s)=\tfrac{1}{s}\cdot\nabla_{\sigma(s)} f.\leqno(B)\mc0\]
Thus from \ref{lem:grad-lip}, we have
\[\frac{\partial^+\ell}{\partial r}
=
-\tfrac{1}{r}\cdot\<\nabla_{\rho(r)} f,\dir{\rho(r)}{\sigma(s)}\>
\le\frac{{\ell^2}+{R^2}-{S^2}}{2\cdot\ell\cdot r}.\leqno(C)\mc0\]
Since $R(r)\le r$ and $S(s_{\min})=s_{\min}$, we get 
\[
\begin{aligned}
\frac{\partial^+\ell}{\partial r}(r,s_{\min})
&\le
\frac{{\ell^2}+r^2-s_{\min}^2}{2\cdot\ell\cdot r}
=\\
&=
\cos\tangle\mc0\{s_{\min};r,\ell\},
\end{aligned}
\leqno(D)\mc0
\]
which is the first inequality in $(*)\mc0_\ell$.
By switching places of $\rho$ and $\sigma$ we obtain the second inequality in $(*)\mc0_\ell$.
Further, summing together $(C)\mc0$ with its mirror-inequality for $\frac{\partial^+\ell}{\partial s}$, we get
\[r\cdot\frac{\partial^+\ell}{\partial r}
+
s\cdot\frac{\partial^+\ell}{\partial s}\le \frac{{\ell^2}+{R^2}-{S^2}}{2\cdot\ell }+\frac{{\ell^2}+{S^2}-{R^2}}{2\cdot\ell }= \ell\leqno(E)\mc0\]
which is $(**)\mc0_\ell$.
\qeds

\parit{Proof of \ref{rad-mon} and \ref{rad-comp} in case $\kappa\not=0$.} Set as before
\begin{align*}
R=R(r)&=\dist{p}{\rho(r)}{},&\ell&=\ell(r,s)=\dist{\rho(r)}{\sigma(s)}{}
\\
S=S(s)&=\dist{p}{\sigma(s)}{},&\phi&=\phi(r,s)=\tangle\mc\kappa\{\ell(r,s);r,s\}.
\end{align*}
The statement follows from the following three inequalities:
\[
\begin{aligned}
&\frac{\partial^+\phi}{\partial r}(s_{\min},r)\le 0 
&
&\frac{\partial^+\phi}{\partial s}(s,r_{\min})\le 0
\end{aligned}
\leqno(*)\mc\pm_\phi
\]
\[
\sn\kappa s\cdot\cs\kappa S\cdot\frac{\partial^+\phi}{\partial s}
+
\sn\kappa r\cdot\cs\kappa R\cdot\frac{\partial^+\phi}{\partial r}\le 0
\leqno(**)\mc\pm_\phi
\]

Once they are proved,
the radial monotonicity follows from $(*)\mc\pm_\phi$.
The radial comparison follows from both $(*)\mc0_\phi$ and $(**)\mc\pm_\phi$.
Indeed, functions $s\mapsto \sn\kappa s\cdot\cs\kappa S$ and $r\mapsto \sn\kappa r\cdot\cs\kappa R$ are Lipschitz.
Thus there is a solution for differential equation
\[(r',s')=(\sn\kappa s\cdot\cs\kappa S,\sn\kappa r\cdot\cs\kappa R)\] 
with any initial data. $(r_0,s_0)\in[r_{\min},\tfrac{\varpi\kappa}2)\times[s_{\min},\tfrac{\varpi\kappa}2)$.
(Unlike case $\kappa=0$ the solution can not be written explicitly.)
Since $\sn\kappa s\cdot\cs\kappa S$, $\sn\kappa r\cdot\cs\kappa R>0$, this solution $(r(t),s(t))$ must meet one of coordinate rays
$\{r_{\min}\}\times[s_{\min},\tfrac{\varpi\kappa}2)$ or $[r_{\min},\tfrac{\varpi\kappa}2)\times\{s_{\min}\}$.
I.e., one can connect pair $(s_{\min},r_{\min})$ to $(s_0,r_0)$ by a join of coordinate line and the solution $(r(t),s(t))$.
According to $(*)\mc\pm_\phi$ and $(**)\mc\pm_\phi$, the value of $\phi$ does not increase while pair $(r,s)$ moving along this join.
Thus $\phi(r_0,s_0)\le\phi(r_{\min},s_{\min})$.

As before we rewrite the inequalities $(*)\mc\pm_\phi$ and $(**)\mc\pm_\phi$ in terms of $\ell$:
\[
\begin{aligned}
\frac{\partial^+\ell}{\partial s}(s,r_{\min})
&\le 
\cos\tangle\mc\kappa\{r_{\min};s,\ell\},
\\
\frac{\partial^+\ell}{\partial r}(s_{\min},r)
&\le 
\cos\tangle\mc\kappa\{s_{\min};r,\ell\},
\end{aligned}
\leqno(*)\mc\pm_\ell
\]

\[
\begin{aligned}
\sn\kappa s&\cdot\cs\kappa S\cdot\frac{\partial^+\ell}{\partial s}
+
\sn\kappa r\cdot\cs\kappa R\cdot\frac{\partial^+\ell}{\partial r}\le 
\\
&\le\sn\kappa s\cdot\cs\kappa S\cdot\cos\tangle\mc\kappa\{r;s,\ell\}
+
\sn\kappa r\cdot\cs\kappa R\cdot\cos\tangle\mc\kappa\{s;r,\ell\}
\end{aligned}
\leqno(**)\mc\pm_\ell
\]
Further, set
\[f=-\tfrac{1}{\kappa}\cdot\cs\kappa\circ\dist{p}{}{}
=
\md\kappa\circ\dist{p}{}{}-\tfrac{1}{\kappa}.\leqno(A)\mc\pm\]
Clearly $f''+\kappa\cdot  f\le 0$ and
\[
\begin{aligned}
\rho^+(r)&=\frac{1}{\tg\kappa r\cdot\cs\kappa R}\cdot\nabla_{\rho(r)} f
\\
\sigma^+(s)&=\frac{1}{\tg\kappa s\cdot\cs\kappa S}\cdot\nabla_{\sigma(s)} f.
\end{aligned}
\leqno(B)\mc\pm\]
Thus from \ref{lem:grad-lip}, we have
\[\begin{aligned}
\frac{\partial^+\ell}{\partial r}
&=
-\frac{1}{\tg\kappa r\cdot\cs\kappa R}
\cdot
\<\nabla_{\rho(r)} f,\dir{\rho(r)}{\sigma(s)}\>
\le
\\
&\le
\frac
{1}
{\tg\kappa r\cdot\cs\kappa R}
\cdot
\frac
{\cs\kappa S-\cs\kappa R\cdot\cs\kappa\ell}
{\kappa\cdot\sn\kappa\ell}
=
\\
&=
\frac
{\frac{\cs\kappa S}{\cs\kappa R}-\cs\kappa\ell}
{\kappa\cdot\tg\kappa r\cdot\sn\kappa\ell}.
\end{aligned}
\leqno(C)\mc\pm\]
Note that for all $\kappa\not=0$,
the function $x\mapsto\frac{1}{\kappa\cdot\cs\kappa x}$ is increasing.
Thus, since $R(r)\le r$ and $S(s_{\min})=s_{\min}$, we get 
\[\begin{aligned}
\frac{\partial^+\ell}{\partial r}(r,s_{\min})
&\le 
\frac
{\frac{\cs\kappa s_{\min}}{\cs\kappa r}-\cs\kappa\ell}
{\kappa\cdot\tg\kappa r\cdot\sn\kappa\ell}
=
\\
&=
\frac
{{\cs\kappa s_{\min}}-\cs\kappa\ell\cdot\cs\kappa r}
{\kappa\cdot\sn\kappa r\cdot\sn\kappa\ell}=
\\
&=\cos\tangle\mc\kappa\{s_{\min};r,\ell\},
  \end{aligned}\leqno(D)\mc\pm\]
which is the first inequality in $(*)\mc\pm_\ell$ for $\kappa\not=0$.
By switching places of $\rho$ and $\sigma$ we obtain the second inequality in $(*)\mc\pm_\ell$.
Further, summing together $(C)\mc\pm$ with its mirror-inequality for $\frac{\partial^+\ell}{\partial s}$, we get
\[\begin{aligned}
\sn\kappa r\cdot\cs\kappa R\cdot\frac{\partial^+\ell}{\partial r}
&+
\sn\kappa s\cdot\cs\kappa S\cdot\frac{\partial^+\ell}{\partial s}\le
\\
&\le
\frac
{{\cs\kappa S}\cdot\cs\kappa r-\cs\kappa\ell\cdot\cs\kappa R\cdot\cs\kappa r}
{\kappa\cdot\sn\kappa\ell}
+\\
&\ \ \ \ +
\frac
{{\cs\kappa R}\cdot\cs\kappa s-\cs\kappa\ell\cdot\cs\kappa S\cdot\cs\kappa s}
{\kappa\cdot\sn\kappa\ell}=
\\
&=
\sn\kappa r\cdot\cs\kappa R\cdot
\frac
{\cs\kappa s-\cs\kappa\ell\cdot\cs\kappa r}
{\kappa\cdot\sn\kappa r\cdot\sn\kappa\ell}
+\\
&\ \ \ \ +
\sn\kappa s\cdot\cs\kappa S\cdot
\frac
{\cs\kappa r-\cs\kappa\ell\cdot\cs\kappa s}
{\kappa\cdot\sn\kappa s\cdot\sn\kappa\ell}
=
\\
&=\sn\kappa r\cdot\cs\kappa R\cdot\cos\tangle\mc\kappa\{r;s,\ell\}
+\\
&\ \ \ \ +\sn\kappa s\cdot\cs\kappa S\cdot\cos\tangle\mc\kappa\{s;r,\ell\}
\end{aligned}
\leqno(E)\mc\pm\]
which is $(**)\mc\pm_\ell$.\qeds


\parbf{Analogs or radial curves for negative curvature bound.}
Let $\kappa\ge 0$. 
Assume that for some function $\psi$, the curves defined by equation 
\[\sigma^+(s)=\psi(s,\dist{p}{\sigma(s)}{})\cdot\nabla_{\sigma(s)}\dist{p}{}{}\]
satisfy radial comparison \ref{rad-comp}.
Then in fact $\sigma(s)$ are radial curves; 
i.e. 
\[\psi(s,\dist{p}{\sigma(s)}{})= \frac{\tg\Kappa\dist[{{}}]{p}{\sigma(s)}{})}{\tg\Kappa s},\]
see exercise \ref{ex:gexp}.

In case $\kappa<0$, such $\psi$ is not unique.
In particular one can take curves defined by simpler equation
\[\sigma^+(s)
=
\frac{\sn\kappa \dist[{{}}]{p}{\sigma(s)}{}}{\sn\kappa s}\cdot\nabla_{\sigma(s)}\dist{p}{}{}
=
\frac{1}{\sn\kappa s}\cdot\nabla_{\sigma(s)}(\md\kappa\circ\dist{p}{}{}).\]
Among all curves of that type, the radial curves for curvature $\kappa$ 
as defined in \ref{def:rad-curv} maximize the growth of $\dist{p}{\sigma(s)}{}$.

























\section{Gradient exponent}\label{sec:gexp}

Let $\spc{L}\in\CBB{}{\kappa}$, 
$p\in \spc{L}$ 
and $\xi\in \Sigma_p$.
Consider a sequence of points $x_n\in \spc{L}$ so that $\dir p{x_n}\to \xi$.
Set $r_n=\dist{p}{x_n}{}$;
denote by $\sigma_n\:[r_n,\tfrac{\varpi\kappa}2)\to \spc{L}$ be the $(p,\kappa)$-radial curve which starts in $x_n$.

Directly from radial comparison (\ref{rad-comp}), 
we have that $\sigma_n\:[r_n,\tfrac{\varpi\kappa}2)\to \spc{L}$ 
converge to a curve $\sigma_\xi\:(0,\tfrac{\varpi\kappa}2)\to \spc{L}$ 
and this limit is independent from the choice of the sequence $x_n$.
Set $\sigma_\xi(0)=p$ and if $\kappa>0$ define \[\sigma_\xi(\tfrac{\varpi\kappa}2)
=
\lim_{t\to\frac{\varpi\kappa}2}\sigma_\xi(t).\]
The obtained curve $\sigma_\xi$ will be called \emph{$(p,\kappa)$-radial curve in direction $\xi$}.

Let us define \emph{gradient exponent} as  
\[
\gexp\mc\kappa_p\:r\cdot\xi\mapsto\sigma_\xi(r)\:\cBall[\0,\tfrac{\varpi\kappa}2]\subset \T_p\to \spc{L}.
\]

Here are properties of radial curves reformulated in terms of gradient exponent:

\begin{thm}{Theorem}\label{thm:prop-gexp}
Let $\spc{L}\in\CBB{}{\kappa}$. 
Then
\begin{subthm}{}
 If $p,q\in \spc{L}$ be points such that $\dist{p}{q}{}\le\tfrac{\varpi\kappa}2$ then for any geodesic $[pq]$ in $\spc{L}$, we have
\[\gexp\mc\kappa_p(\ddir p q)=q\] 
\end{subthm}

\begin{subthm}{thm:prop-gexp:short} 
For any $v,w\in \cBall[\0,\tfrac{\varpi\kappa}2]\subset \T_p$,
\[\dist{\gexp\mc\kappa_p v}{\gexp\mc\kappa_p w}{}
\le
\side\kappa\hinge{\0}v w.\]
In other words, if we denote by $\mathcal{T}_{p}\mc\kappa$ the set $\cBall[\0,\tfrac{\varpi\kappa}2]\subset \T_p$ 
equipped with metric $\dist{v}{w}{\mathcal{T}\mc\kappa_{p}}=\side\kappa\hinge{\0}v w$, 
then 
\[\gexp\mc\kappa_p:\mathcal{T}\mc\kappa_{p}\to \spc{L}\] 
is a short map.
\end{subthm}

\begin{subthm}{gexp-mono} 
Let $\spc{L}\in\CBB{}{\kappa}$,
$p, q\in \spc{L}$ 
and $\dist{p}{q}{}\le \tfrac{\varpi\kappa}2$.
If $v\in\T_p$, $|v|\le 1$ and 
\[\sigma(t)=\gexp\mc\kappa_p(t\cdot v)\] then
the function
\[
s
\mapsto 
\tangle\mc\kappa(\sigma|_0^s,q)
\df
\tangle\mc\kappa\{\dist{q}{\sigma(s)}{};\dist{q}{\sigma(0)},s\}
\]
is non-increasing in whole domain of definition.
\end{subthm}
\end{thm}

\parit{Proof.}
Follows directly from construction of $\gexp\mc\kappa_p$ and the radial comparison (\ref{rad-comp}).
\qeds

Applying the theorem above together with \ref{LinDim+-f},
we obtain the following.

\begin{thm}{Corollary}\label{cor:short-map-to-ball}
Let $\spc{L}\in\CBB{m}{\kappa}$, $p\in\spc{L}$ and $0<R\le\tfrac{\varpi\kappa}2$.
Then there is a short map 
$f\:\cBall[R]_{\Lob{m}{\kappa}}\to \spc{L}$
such that $\Im f= \cBall[p,R]\subset \spc{L}$.
\end{thm}









\section{Radial curves for sets}

Here we generalize the constructions of radial curves and gradient exponent.
Roughly, we show that one can use a distance function 
$\dist{A}{}{}$ to any closed set $A$ instead of the distant function to one point.
We only give the corresponding definitions and state the results,
the proofs are straightforward generalization of corresponding one-point-set version. 

First we give a more general form of the definition of radial curves (\ref{def:rad-curv}) and the definition of radial geodesic (\ref{def:rad-geod}):

\begin{thm}{Definition}
Assume $\spc{L}\in\CBB{}{}$, 
$\kappa\in\RR$, 
and $A\subset \spc{L}$ be a closed subset.
A curve $\sigma\:[s_{\min},s_{\max})\to \spc{L}$  is called 
\emph{$(A,\kappa)$-radial curve} 
if
$s_{\min}
\z=
\dist{A}{\sigma(s_{\min})}{}\in(0,\tfrac{\varpi\kappa}2)$, 
and it satisfies the following differential equation
\[\sigma^+(s)
\z=
\frac{\tg\kappa\dist[{{}}]{p}{\sigma(s)}{}}{\tg\kappa s}
\cdot
\nabla_{\sigma(s)}\dist{A}{}{}.\]
for any $s\in[s_{\min},s_{\max})$, here $\tg\kappa x=\frac{\sn\kappa x}{\cs\kappa x}$.

If $x=\sigma(s_{\min})$, we say that $\sigma$ \emph{starts in}  $x$.
\end{thm}

\begin{thm}{Definition}
Let $\spc{L}\in\CBB{}{}$
and $A\subset \spc{L}$ be a closed subset.
A unit-speed geodesic  $\gamma\:\II\to \spc{L}$  is called 
\emph{$A$-radial geodesic}\index{radial geodesic} if 
$\dist{A}{\gamma(s)}{}\equiv s$.
\end{thm}

The following propositions are analogous to the propositions \ref{prop:rad-geod} and \ref{prop:dist<s}.
Their proofs follow directly from the definitions: 

\begin{thm}{Proposition}
Let $\spc{L}\in\CBB{}{}$,
$A\subset\spc{L}$ be a closed subset.
Assume that 
$\tfrac{\varpi\kappa}{2}
\ge 
s_{\max}$.
Then any $\dist{A}{}{}$-radial geodesic 
$\gamma\:[s_{\min},s_{\max})
\to 
\spc{L}$ 
is an $(A,\kappa)$-radial curve.
\end{thm}

\begin{thm}{Proposition}
Let $\spc{L}\in\CBB{}{}$,
$A\subset\spc{L}$ be a closed subset 
and $\sigma\:[s_{\min},s_{\max})\to \spc{L}$ be a $(A,\kappa)$-radial curve.
Then for any $s\in [s_{\min},s_{\max})$, 
we have $\dist{A}{\sigma(s)}{}\le s$.

Moreover, if for some $s_0$ we have $\dist{A}{\sigma(s_0)}{}= s_0$ 
then the restriction $\sigma|_{[s_{\min},s_0]}$ is a $A$-radial geodesic.
\end{thm}

Here is the corresponding generalization of existence and uniqueness 
for $(A,\kappa)$-radial curves;
it can be proved the same way as \ref{rad-curv-exist}

\begin{thm}{Existence and uniqueness}
Let $\spc{L}\in\CBB{}{}$, 
$\kappa\in\RR$, 
$A\subset\spc{L}$ be a closed subset, 
and $x\in \spc{L}$.
Assume
$0
<
\dist{A}{x}{}
<
\tfrac{\varpi\kappa}2$.
Then there is unique $(A,\kappa)$-radial curve $\sigma\:[\dist{A}{x}{},\tfrac{\varpi\kappa}2)\to \spc{L}$ 
which starts in $x$.
\end{thm}

Next we formulate radial monotonicity and radial comparison for $(A,\kappa)$-radial curves.
The proof of these two statements are almost exactly the same as the proof of \ref{rad-mon} and \ref{rad-comp}.

\begin{thm}{Radial monotonicity}\label{gen-rad-mon}
Let $\spc{L}\in\CBB{}{\kappa}$,
$A\subset \spc{L}$ be a closed subset
and $q\in\spc{L}\backslash A$.
Assume $\sigma\:  [s_{\min},\tfrac{\varpi\kappa}2)\to \spc{L}$
is an $(A,\kappa)$-radial curve.
Then the function 
\[s\mapsto 
\tangle\mc\kappa\{
\dist{q}{\sigma(s)}{};
\dist{A}{q}{},
s
\}\]
is nonincreasing in all the domain of definition.
\end{thm}

To formulate generalized radial comparison,
we need to introduce a short cut notation.
Given a set $A$ and two points $x$ and $y$ in a metric space define
\[
\angkk\kappa A{x}{y}
\df
\tangle\mc\kappa\{
\dist{x}{y}{};
\dist{A}{x}{},
\dist{A}{y}{}
\}
\]
Note that distances $\dist{x}{y}{}$, 
$\dist{A}{x}{}$ and 
$\dist{A}{y}{}$ might not satisfy the triangle inequality.
Therefore the model angle 
$\angkk\kappa A{x}{y}$ might be undefined even for $\kappa\le0$.

\begin{thm}{Radial comparison}\label{gen-rad-comp}
Let $\spc{L}\in\CBB{}{\kappa}$ 
and $A\subset \spc{L}$ be a closed set.
Assume $\rho\:  [r_{\min},\tfrac{\varpi\kappa}2)\to \spc{L}$
and    $\sigma\:[s_{\min},\tfrac{\varpi\kappa}2)\to \spc{L}$
are two $\dist{A}{}{}$-radial curves for curvature $\kappa$.
Assume further that 
\[\phi_{\min}
=
\angkk\kappa A{\rho(r_{\min})}{\sigma(s_{\min})}
\]
is defined.
Then for any $r\in[r_{\min},\tfrac{\varpi\kappa}2)$ and  $s\in[s_{\min},\tfrac{\varpi\kappa}2)$,
we have
\[
\dist{\rho(r)}{\sigma(s)}{}
\le \side\kappa\{\phi_{\min};r,s\}.
\]

\end{thm}

Finally, 
assume $p$ be an isolated point of a closed set $A$ in $\spc{L}\in\CBB{}{}{}$.
Applying the same limiting procedure as in Section \ref{sec:gexp},
for any $\xi\in\Sigma_p$
one can construct an $(A,\kappa)$-radial curve $\sigma_\xi$
such that $\sigma_\xi(0)=p$ and $\sigma^+(0)=\xi$.
This way we obtain a map $\gexp\mc\kappa_A\:\T_p\subto\spc{L}$,
$r\cdot\xi\mapsto\sigma_\xi(r)$.
For the constructed map, the following analog of \ref{thm:prop-gexp} holds;
the proof is straightforward.

\begin{thm}{Theorem}
Let $\spc{L}\in\CBB{}{\kappa}$ and $A\subset\spc{L}$ is a closed subset with an isolated point $p\in A$.
Then
\begin{subthm}{}
Assume $\dist{A}{q}{}=\dist{p}{q}{}\le\tfrac{\varpi\kappa}2$ be 
an $A$-radial geodesic then
\[\gexp\mc\kappa_A(\ddir p q)=q\] 
\end{subthm}

\begin{subthm}{} 
For any $v,w\in \cBall[\0,\tfrac{\varpi\kappa}2]\subset \T_p$,
\[\dist{\gexp\mc\kappa_p v}{\gexp\mc\kappa_p w}{}
\le
\side\kappa\hinge{\0}v w.\]
In other words, if we denote by $\mathcal{T}_{p}\mc\kappa$ the set $\cBall[\0,\tfrac{\varpi\kappa}2]\subset \T_p$ 
equipped with metric $\dist{v}{w}{\mathcal{T}\mc\kappa_{p}}=\side\kappa\hinge{\0}v w$, 
then 
\[\gexp\mc\kappa_p:\mathcal{T}\mc\kappa_{p}\to \spc{L}\] 
is a short map.
\end{subthm}

\begin{subthm}{gexp-mono-1} 
Let $\spc{L}\in\CBB{}{\kappa}$,
$p, q\in \spc{L}$ 
and $\dist{p}{q}{}\le \tfrac{\varpi\kappa}2$.
If $v\in\T_p$, $|v|\le 1$ and 
\[\sigma(t)=\gexp\mc\kappa_p(t\cdot v)\] then
the function
$
s\mapsto \tangle\mc\kappa(\sigma|_0^s,q)
$
is non-increasing in whole domain of definition.
\end{subthm}
\end{thm}










\section{Exercises}

\begin{thm}{Exercise}\label{ex:d dist(grad)<0}
Let $\spc{L}\in\CBB{m}{\kappa}$ and $a,b,p$
are mutually distinct points in $\spc{L}$.
Prove that 
\[(d_p\dist{a}{}{})(\nabla_p\dist{b}{}{})
+\cos\angk\kappa pab\le 0.\]
\end{thm}

\begin{thm}{Exercise}\label{ex:df(v)=<grad f,v>}
Let $\spc{L}\in\CBB{m}{\kappa}$,
the function
$f\:\spc{L}\to\RR$ be semiconcave and locally Lipschitz
and
$\alpha\:\II\to\spc{L}$ be a Lipschitz curve.
Show that 
\[\<\nabla_{\alpha(t)}f,\alpha^+(t)\>
=
(\d_{\alpha(t)}f)(\alpha^+(t))\]
for almost all $t\in\II$.

\end{thm}

\begin{thm}{Exercise}
Let 
$\spc{L}\in\CBB{}{}$ and $f\:\spc{L}\to\RR$ be a concave locally Lipschitz function.
Show that $\alpha\:\RR\to\spc{L}$ is an $f$-gradient curve if and only if
\[\dist[2]{x}{\alpha(t_1)}{\spc{L}}-\dist[2]{x}{\alpha(t_0)}{\spc{L}}
\le 
2\cdot(t_1-t_0)\cdot  (f\circ\alpha(t_1)-f(x))\]
for any $t_1>t_0$ and $x\in\spc{L}$. %???CHECK???
\end{thm}

\begin{thm}{Sharfutdinov's retruction}
Let $K_t$ be a one parameter famity of convex sets in $\EE^m$
which is nested; i.e. $K_{t_1}\supset K_{t_2}$ if $t_1\le t_2$.
Show that there is a family of short maps $\phi_t\:\EE^m\to K_t$ 
such that $\phi_t|{K_t}=\id$ and $\phi_{t_2}\circ\phi_{t_1}=\phi_{t_2}$ for all $t_1\le t_2$.
\end{thm}

\begin{thm}{Exercise}
Let $\spc{L}\in\CBB{m}{}$, $\partial\spc{L}=\emptyset$ , $K\subset \spc{L}$ be a compact subset and $f\:\spc{L}\to\RR$ be semiconcave function.
Assume that for some $t>0$ the gradient flow $\GF^t_f$ is defined everywhere in $K$,
prove that 
$$\Fr\GF^t_fK\subset\GF^t_f\Fr K.$$
\end{thm}

\begin{thm}{Exercise}
\label{ex:gexp} 
Let $\spc{L}\subset\EE^2$ be Euclidean halfplane. 
Clearly $\spc{L}\in\CBB20$.
Given a point $x\in \EE^2$ let us denote by $\proj(x)$ the closest point on $\spc{L}$. 

Apply the Radial comparison (\ref{rad-comp}) to show that for any interior point $p\in \spc{L}$ we have 
\[\gexp_p v=\proj(p+v).\]
\end{thm}

\begin{thm}{Exercise}
Let $\spc{L}\in \CBB{m}{\kappa}$ and $\rad\spc{L}=R$.
Prove that there is a $(\sn\kappa R)$-Lipschitz map $\map\:\SS^{m-1}\to\spc{L}$ such that $\Im\map\supset\partial\spc{L}$.
\end{thm}

\begin{thm}{Exercise}\label{ex:geodesic}
Let $\spc{L}\in \CBB{}{\kappa}$ 
and $x,y,z\in \spc{L}$.
Assume \[\angk\kappa zxy=\pi.\]
Show that there is a geodesic $[xy]$
which pass through $z$.

Compare to Exercise~\ref{ex:flat-in-CBB}
\end{thm}



