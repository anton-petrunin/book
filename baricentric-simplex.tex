%arXiv
\chapter{Dimension of CAT spaces}\label{chap:web+bary}

In this chapter we discuss the constructions introduced by Bruce Kleiner \cite{kleiner}.

The material of this chapter is used mostly for $\CAT{}$ spaces, 
but the results in section~\ref{sec:web-general} find some applications for finite dimensional $\Alex{}$ spaces as well.
%??? The analogous material for $\Alex{}$ spaces is described in Chapter~\ref{chap:dist-maps}.

\section{The case of complete geodesic spaces}\label{sec:web-general}

The following construction gives a $\kay$-dimensional submanifold 
for a given ``nondegenerate'' array of $\kay+1$ strongly convex functions.

\begin{thm}{Definition}\label{def:ordung}
For two real arrays $\bm{v}$, $\bm{w}\in \RR^{\kay+1}$,
$\bm{v}=(v^0,v^1,\dots,v^\kay)$ 
and 
$\bm{w}=(w^0,w^1,\dots,w^\kay)$, 
we will write
$\bm{v}\succcurlyeq\bm{w}$ if $v^i\ge w^i$ for each $i$.
\end{thm}

Given a subset $Q\subset \RR^{\kay+1}$, 
denote by $\Up Q$,\label{PAGE.def:Up}
the smallest upper set containing $Q$ 
and 
$\Min Q$, the set of minimal elements of $Q$ with respect to $\succcurlyeq$;
that is,
\begin{align*}
\Up Q 
&=
\set{\bm{v}\in\RR^{\kay+1}}{\exists\, \bm{w}\in Q\ \t{such that}\ \bm{v}\succcurlyeq\bm{w}},
\\
\Min Q 
&=
\set{\bm{v}\in Q}{\t{if}\ \bm{v}\succcurlyeq\bm{w}\in Q\ \t{then}\ \bm{w}=\bm{v}}.
\end{align*}


\begin{thm}{Definition}\label{def:web}
Let $\spc{X}$ be a metric space 
and $\bm{f}=(f^0,f^1,\dots,f^\kay)\:\spc{X}\to \RR^{\kay+1}$ be a function array.
The set 
\[\Web\bm{f}
\df
\bm{f}^{-1}\left[\Min\bm{f}(\spc{X})\right]
\subset 
\spc{X}\] 
will be called the \emph{web}\index{web} on $\bm{f}$.
\end{thm}

Given an array $\bm{f}=(f^0,f^1,\dots,f^\kay)$,
we denote by $\bm{f}^{\without i}$ the subarray of $\bm{f}$ with $f^i$ removed;
that is, 
\[\bm{f}^{\without i\,}\df(f^0,\dots,f^{i-1},f^{i+1},\dots,f^\kay).\]
Clearly 
$\Web\bm{f}^{\without i}\subset \Web\bm{f}$.
Define the \emph{inner web}\index{inner web} of $\bm{f}$ 
as 
\[\InWeb\bm{f}
=
\Web\bm{f}\backslash\left(\bigcup_{i}\Web\bm{f}^{\without i}\right).\]


We say that a function array is \emph{nondegenerate}\index{nondegenerate function array} 
if $\InWeb\bm{f}\not=\emptyset$.

\parbf{Example.} 
If $\spc{X}$ is a geodesic space, 
then $\Web(\distfun{x}{}{},\distfun{y}{}{})$ is the union of all geodesics from $x$ to $y$ and 
\[\InWeb(\distfun{x}{}{},\distfun{y}{}{})=\Web(\distfun{x}{}{},\distfun{y}{}{})\backslash\{x,y\}.\]

\parbf{Barycenters.}
Let us denote by $\Delta^\kay\subset \RR^{\kay+1}$\index{$\Delta^m$} 
the \emph{standard $\kay$-simplex}\index{standard simplex}; 
that is, $\bm{x}=(x^0,x^1,\dots,x^\kay)\in\Delta^\kay$ if $\sum_{i=0}^\kay x^i=1$ and $x^i\ge0$ for all $i$.

Let $\spc{X}$ be a metric space 
and $\bm{f}=(f^0,f^1,\dots,f^\kay)\:\spc{X}\to \RR^{\kay+1}$ be a function array.
Consider the map $\spx{\bm{f}}\:\Delta^\kay\to \spc{X}$,\index{$\spx{\bm{f}}$} defined by 
\[\spx{\bm{f}}(\bm{x})=\argmin\sum_{i=0}^\kay x^i\cdot f^i,\]
where $\argmin f$\index{$\argmin$} denotes a point of minimum of $f$.
The map $\spx{\bm{f}}$ will be called a \emph{barycentric simplex}\index{barycentric simplex of function array} of $\bm{f}$.
Note that for general function array $\bm{f}$, 
the value $\spx{\bm{f}}(\bm{x})$ might be undefined or nonuniquely defined.

It is clear from the definition, that $\spx{\bm{f}^{\without i}}$ 
coincides with the restriction of $\spx{\bm{f}}$ to the corresponding face of $\Delta^\kay$.


\begin{thm}{Theorem}\label{thm:web}
Let $\spc{X}$ be a complete geodesic space 
and $\bm{f}\z=(f^0,f^1,\dots,f^\kay)\:\spc{X}\to\RR^{\kay+1}$ 
be an array of strongly convex and locally Lipschitz functions.
Then $\bm{f}$ defines a $C^{\frac12}$-embedding 
$\Web\bm{f}\hookrightarrow\RR^{\kay+1}$.

Moreover,
\begin{subthm}{thm:web:Up-convex}
$W=\Up[\bm{f}(\spc{X})]$ is a convex closed subset of $\RR^{\kay+1}$
and

$S=\Fr_{\RR^{\kay+1}} W$ is a convex hypersurface in $\RR^{\kay+1}$.
\end{subthm}

\begin{subthm}{thm:web:f(web)=min}
\[\bm{f}(\Web\bm{f})=\Min W \subset S\]
and
\[\bm{f}(\InWeb\bm{f})= \Int_{S}(\Min W).\]
\end{subthm}

\begin{subthm}{thm:web:bary}
The barycentric simplex 
$\spx{\bm{f}}\:\Delta^\kay\to \spc{X}$ is a uniquely defined Lipshitz map and $\Im\spx{\bm{f}}=\Web\bm{f}$.
In particular $\Web\bm{f}$ is compact.
\end{subthm}

\begin{subthm}{thm:web:lip-const}
Let us equip $\Delta^\kay$ with metric induced by $\ell^1$-norm on $\RR^{\kay+1}$.
Then the Lipschitz constant of $\spx{\bm{f}}\:\Delta^\kay\to\spc{U}$ can be estimated in terms of 
positive lower bounds on $(f^i)''$ 
and Lipshitz constants of $f^i$
in a neigborhood of $\Web\bm{f}$ for all $i$.
\end{subthm}


In particular, from (\ref{SHORT.thm:web:Up-convex}) and (\ref{SHORT.thm:web:f(web)=min}), it follows that $\InWeb\bm{f}$ is $C^{\frac12}$-homeomorphic to an open set of $\RR^\kay$.
\end{thm}

The proof is preceded by few preliminary statements.

\begin{thm}{Lemma}\label{lem:argmin(convex)}
Suppose $\spc{X}$ is a complete geodesic space and let $f\:\spc{X}\to\RR$ be a locally Lipschitz, strongly convex function. Then the minimum point 
of $f$
is uniquely defined.
\end{thm}

\parit{Proof.}
Without loss of generality, we can assume that $f$ is $1$-convex;
in particular the following claim holds.
\begin{clm}{}\label{midpoint}
 if $z$ is a midpoint of the geodesic $[x y]$, then 
\[s\le f(z)
\le
\tfrac{1}{2}\cdot f(x)+\tfrac{1}{2}\cdot f(y)-\tfrac{1}{8}\cdot\dist[2]{x}{y}{}.
\]
\end{clm}

\parit{Uniqueness.}
Assume that $x$ and $y$ are distinct minimum points of $f$. 
From \ref{midpoint}, we get
\[f(z)<f(x)=f(y),\] 
a contradiction. 

\parit{Existence.}
Fix a point $p\in \spc{X}$; 
let $\Lip\in\RR$ be a Lipschitz constant of $f$ in a neighborhood of $p$.

Consider function $\phi(t)=f\circ\geod_{[px]}(t)$.
Clearly $\phi$ is $1$-convex and $\phi^+(0)\ge -\Lip$.
Setting $\ell=\dist{p}{x}{}$, we get 
\begin{align*}
f(x)
&=
\phi(\ell)
\ge
\\
&\ge
f(p)-\Lip\cdot\ell+\tfrac{1}{2}\cdot\ell^2
\ge
\\
&\ge f(p)-\tfrac{1}{2}\cdot{\Lip^2}.
\end{align*}

In particular,
\begin{align*}
s
&\df
\inf\set{f(x)}{x\in \spc{X}}
\ge
\\
&\ge
f(p)-\tfrac{1}{2}\cdot{\Lip^2}.
\end{align*}

Choose a sequence of points $p_n\in \spc{X}$ such that $f(p_n)\to s$.
Applying \ref{midpoint}, for $x\z=p_n$, $y\z=p_m$, we get that $(p_n)$ is converging in itself. 
Hence, $p_n$ converges to a minimum point of $f$.
\qeds

\begin{thm}{Definition}
Let $Q$ be a closed subset of $\RR^{\kay+1}$.
A vector $\bm{x}\z=(x^0,x^1,\dots,x^\kay)\in\RR^{\kay+1}$
is \emph{subnormal}\index{subnormal vector} to $Q$ at point $\bm{v}\in Q$ 
if
\[\<\bm{x},\bm{w}-\bm{v}\>
\df
\sum_ix^i\cdot(w^i-v^i)
\ge 0\]
for any $\bm{w}\in Q$.
\end{thm}


\begin{thm}{Lemma}\label{lem:Up-convex}{\sloppy 
Let $\spc{X}$ be a complete geodesic space 
and $\bm{f}\z=(f^0,f^1,\dots,f^\kay)\:\spc{X}\to\RR^{\kay+1}$ 
be an array of strongly convex and locally Lipschitz functions.
Set $W=\Up\bm{f}(\spc{X})$.
Then: 

}
\begin{subthm}{lem:Up-convex:Up-convex}
$W$ is a closed convex set bounded below with respect to $\succcurlyeq$.
\end{subthm}

\begin{subthm}{lem:Up-convex:subnormal}
If $\bm{x}$ is a subnormal vector to $W$, then $\bm{x}\succcurlyeq\bm{0}$.
\end{subthm}

\begin{subthm}{lem:Up-convex:surface}
 $S=\Fr_{\RR^{\kay+1}}W$ is a complete convex hypersurface in $\RR^{\kay+1}$.
\end{subthm}

\end{thm}

\parit{Proof.}
Denote by $\bar W$ the closure of $W$.

Convexity of $f^i$ implies that
for any two points $p,q\in \spc{X}$ and $t\in[0,1]$ we have
\[(1-t)\cdot\bm{f}(p)+t\cdot \bm{f}(q)
\succcurlyeq
\bm{f}\circ\geodpath_{[p q]}(t).
\eqlbl{n-convex}\]
where $\geodpath_{[p q]}$ denotes a geodesic path from $p$ to $q$. 
Therefore $W$ as well as $\bar W$ are convex sets in $\RR^{\kay+1}$.

Set
\[w^i=\min\set{f^i(x)}{x\in\spc{X}}.\]
By Lemma~\ref{lem:argmin(convex)}, $w^i$ is finite for each $i$.
Clearly $\bm{w}=(w^0,w^1,\dots,w^\kay)$ is a lower bound of $\bar W$ with respect to $\succcurlyeq$.

It is clear that $W$ has nonempty interior
and $W\not=\RR^{\kay+1}$ since it is bounded below.
Therefore $S=\Fr_{\RR^{\kay+1}}W=\Fr_{\RR^{\kay+1}}\bar W$
is a complete convex hypersurface in $\RR^{\kay+1}$.

Since $\bar W$ is closed and bounded below, we also have
\[\bar W=\Up[\Min\bar W].
\eqlbl{eq:W=Up Min W}\]

Choose arbitrary $\bm{v}\in S$.
Let $\bm{x}\in\RR^{\kay+1}$ be a subnormal vector to $\bar W$ at $\bm{v}$. 
In particular, 
$\<\bm{x},\bm{y}\>
\ge
0$ 
for any $\bm{y}\succcurlyeq\bm{0}$;
that is, $\bm{x}\succcurlyeq\bm{0}$.

Further, according to Lemma~\ref{lem:argmin(convex)}, 
the function 
$\sum_i x^i\cdot f^i$ has uniquely defined minimum point, say $p$.
Clearly 
\[\bm{v}\succcurlyeq\bm{f}(p)\quad\t{and}\quad \bm{f}(p)\in \Min W.\eqlbl{eq:v>f(p)}\]

Note that for any $\bm{u}\in \bar W$ there is $\bm{v}\in S$ such that $\bm{u}\succcurlyeq\bm{v}$. 
Therefore \ref{eq:v>f(p)} implies that
\[\bar W\subset\Up[\Min W]\subset W.\]
Hence
$\bar W=W$; that is, $W$ is closed.
\qeds









\parit{Proof of \ref{thm:web}.}
Without loss of generality we may assume that all $f^i$ are $1$-convex.

Given $\bm{v}=(v^0,v^1,\dots,v^\kay)\in\RR^{\kay+1}$, consider the function 
$h_{\bm{v}}\: \spc{X}\to \RR$ defined as
\[h_{\bm{v}}(p)=\max_i\{f^i(p)-v^i\}.\]
Note that $h_{\bm{v}}$ is $1$-convex.
Set 
$$\map(\bm{v})\df\argmin h_{\bm{v}}.$$
According to Lemma~\ref{lem:argmin(convex)}, $\map(\bm{v})$ is uniquely defined.

From the definition of web (\ref{def:web}) 
we have
$\map\circ\bm{f}(p)=p$ for any $p\in \Web\bm{f}$;
that is, $\map$ is a left inverse to the restriction $\bm{f}|_{\Web\bm{f}}$.
In particular, 
\[\Web\bm{f}=\Im\map.
\eqlbl{eq:Web=Im}\]

Given $\bm{v},\bm{w}\in\RR^{\kay+1}$,
set $p=\map (\bm{v})$ and $q=\map (\bm{w})$.
Since $h_{\bm{v}}$ and $h_{\bm{w}}$ are 1-convex, we have
\begin{align*}
h_{\bm{v}}(q)
&\ge 
h_{\bm{v}}(p)+\tfrac{1}{2}\cdot\dist[2]{p}{q}{},
&
h_{\bm{w}}(p)
&\ge 
h_{\bm{w}}(q)+\tfrac{1}{2}\cdot\dist[2]{p}{q}{}.
\end{align*}
Therefore,
\begin{align*}
\dist[2]{p}{q}{}
&\le 
2\cdot\sup_{x\in\spc{X}}\{ |h_{\bm{v}}(x)-h_{\bm{w}}(x)| \}
\le
\\
&\le 
2\cdot\max_{i}\{|v^i-w^i|\}.
\end{align*}
In particular,
$\map$ is $C^{\frac{1}{2}}$-continuous,
or $\bm{f}|_{\Web\bm{f}}$ is a $C^{\frac{1}{2}}$-embedding.

As in Lemma~\ref{lem:Up-convex},
set $W=\Up\bm{f}(\spc{X})$ and $S=\Fr_{\RR^{\kay+1}}W$.
Recall that
$S$ is a convex hypersurface in $\RR^{\kay+1}$.
Clearly $\bm{f}(\Web\bm{f})=\Min W\subset S$.
From the definition of inner web we have
$\bm{v}\in \bm{f}(\InWeb\bm{f})$ 
if and only if 
$\bm{v}\in S$ and
for any $i$ there is $\bm{w}=(w^0,w^1,\dots,w^\kay)\in W$ such that $w^j<v^j$ for all $j\not=i$.
Thus, $\bm{f}(\InWeb\bm{f})$ is open in $S$.
That is, $\InWeb\bm{f}$ is $C^{\frac{1}{2}}$-homeomorphic to an open set in a convex hypersurface $S\subset\RR^{\kay+1}$.










\parit{(\ref{SHORT.thm:web:bary})+(\ref{SHORT.thm:web:lip-const}).}
Since $f^i$ is $1$-convex, for any $\bm{x}=(x^0,x^1,\dots,x^\kay)\in\Delta^\kay$, 
the convex combination 
\[\left(\sum_i x^i\cdot f^i\right)\:\spc{X}\to\RR\] 
is also $1$-convex.
Therefore, according to Lemma~\ref{lem:argmin(convex)}, $\spx{\bm{f}}(\bm{x})$ is defined for any $\bm{x}\in\Delta^\kay$.
 
For $\bm{x},\bm{y}\in\Delta^\kay$,
set 
\begin{align*}
f_{\bm{x}}
&=\sum_i x^i\cdot f^i,
&
f_{\bm{y}}
&=\sum_i y^i\cdot f^i,
\\
p
&=\spx{\bm{f}}(\bm{x}),
&
q
&=\spx{\bm{f}}(\bm{y}),
\\
\ell&=\dist{p}{q}{}.
\end{align*}
Note the following:
\begin{itemize}
\item The function $\phi(t)=f_{\bm{x}}\circ\geod_{[p q]}(t)$ has minimum at $0$. 

Therefore $\phi^+(0)\ge 0$
\item The function $\psi(t)=f_{\bm{y}}\circ\geod_{[p q]}(t)$ has minimum at $\ell$. 

Therefore $\psi^-(\ell)\ge 0$.
\end{itemize}
From $1$-convexity of $f_{\bm{y}}$, we have
$\psi^+(0)+\psi^-(\ell)+\ell\le0$.

Let $\Lip$ be a Lipschitz constant for all $f^i$ in a neighborhood $\Omega\ni p$.
Then 
\[\psi^+(0)
\le 
\phi^+(0)+\Lip\cdot\|\bm{x}-\bm{y}\|_1,\] 
where $\|\bm{x}-\bm{y}\|_1=\sum_{i=0}^\kay|x^i-y^i|$.
That is, given $\bm{x}\in\Delta^\kay$, there is a constant $\Lip$ such that
\begin{align*}
\dist{\spx{\bm{f}}(\bm{x})}{\spx{\bm{f}}(\bm{y})}{}
&=
\ell
\le
\\
&\le 
\Lip\cdot\|\bm{x}-\bm{y}\|_1
\end{align*}
for any $\bm{y}\in\Delta^\kay$.
In particular, there is $\eps>0$ such that if $\|\bm{x}-\bm{y}\|_1,$ $\|\bm{x}-\bm{z}\|_1 <\eps$, then $\spx{\bm{f}}(\bm{y})$, $\spx{\bm{f}}(\bm{z})\in\Omega$. 
Thus, the same argument as above implies 
\[\dist{\spx{\bm{f}}(\bm{y})}{\spx{\bm{f}}(\bm{z})}{}
=
\ell\le \Lip\cdot\|\bm{y}-\bm{z}\|_1\]
for any $\bm{y}$ and $\bm{z}$ sufficiently close to $\bm{x}$; that is, $\spx{\bm{f}}$ is locally Lipschitz.
Since $\Delta^\kay$ is compact, $\spx{\bm{f}}$ is Lipschitz.

Clearly $\spx{\bm{f}}(\Delta^\kay)\subset \Web \bm{f}$;
it remains to show that $\spx{\bm{f}}(\Delta^\kay)\supset \Web \bm{f}$.
According to Lemma~\ref{lem:Up-convex},
$W=\Up\bm{f}(\spc{X})$ is a closed convex set in $\RR^{\kay+1}$.
Let $p\in \Web \bm{f}$; 
clearly $\bm{f}(p)\in \Min W\subset S=\Fr_{\RR^{\kay+1}}W$.
Let $\bm{x}$ be a subnormal vector to $W$ at $\bm{f}(p)$.
According to Lemma~\ref{lem:Up-convex}, 
$\bm{x} \succcurlyeq\bm{0}$.
Without loss of generality we may assume that $\sum_i x^i=1$;
that is, $\bm{x}\in \Delta^\kay$.
By Lemma~\ref{lem:argmin(convex)},
$p$ is the unique minimum point of $\sum_i x^i\cdot f^i$;
that is, $p=\spx{\bm{f}}(\bm{x})$.
\qeds








\section{The case of CAT spaces}

Let $\bm{a}=(a^0,a^1,\dots,a^\kay)$ be a point array in a metric space $\spc{U}$.
Recall that 
$\distfun{\bm{a}}{}{}$
denotes the distance map
\[(\distfun{a^0}{}{},\distfun{a^1}{}{},\dots,\distfun{a^\kay}{}{})\:\spc{U}\to\RR^{\kay+1}\]
which can be also regarded as a function array.
The \emph{radius of the point array}\index{radius of the point array} $\bm{a}$ is defined to be the radius of the set $\{a^0,a^1,\dots,a^\kay\}$;
that is,
\[\rad\bm{a}=\inf\set{r>0}{a^i\in \oBall(z,r)\ \t{for all}\ i \ \t{and some}\ z\in\spc{U}}.\]%???

Fix $\kappa\in\RR$.
Let $\bm{a}=(a^0,a^1,\dots,a^\kay)$ be a point array of radius $<\tfrac{\varpi\kappa}2$
in a metric space $\spc{U}$.
Consider function array $\bm{f}=(f^0,f^1,\dots,f^\kay)$ 
where 
\[f^i(x)\z=\md\kappa\dist[{{}}]{a^i}{x}{}.\]
Assuming the barycentric simplex $\spx{\bm{f}}$ is defined,
then $\spx{\bm{f}}$ is called the \emph{$\kappa$-barycentric simplex}\index{$\kappa$-barycentric simplex} for the point array $\bm{a}$;
it will be denoted by $\spx{\bm{a}}\mc\kappa$.
The points $a^0,a^1,\dots,a^\kay$ are called 
\emph{vertexes of $\kappa$-barycentric simplex}%
\index{vertexes of barycentric simplex}.
Note that once we say the $\kappa$-barycentric simplex is defined, 
we automatically assume that $\rad\bm{a}<\tfrac{\varpi\kappa}2$.


\begin{thm}{Theorem}\label{thm:cat-bary-web}
Let $\spc{U}$ be a complete length $\CAT\kappa$ space
and $\bm{a}=(a^0,a^1,\dots a^\kay)$ be a point array with radius $<\tfrac{\varpi\kappa}{2}$.
Then: 

\begin{subthm}{thm:cat-bary-web:Lip}
The $\kappa$-barycentric simplex $\spx{\bm{a}}\mc\kappa\:\Delta^\kay\to \spc{U}$ 
is defined. 
Moreover, $\spx{\bm{a}}\mc\kappa$ is a Lipschitz map,
and if $\Delta^\kay$ is equipped with the $\ell^1$-metric, then its Lipschitz contant can be estimated in terms of $\kappa$ and the radius of $\bm{a}$ (in particular it does not depend on $\kay$).
\end{subthm}

\begin{subthm}{thm:cat-bary-web:web=Im(bary)}
$\Web(\distfun{\bm{a}}{}{})=\Im \spx{\bm{a}}\mc\kappa$.
Moreover, if a closed convex set $K$ contains all $a^i$, then $\Web(\distfun{\bm{a}}{}{})\subset K$.
\end{subthm}


\begin{subthm}{thm:cat-bary-web:mnfld}
The restriction%
\footnote{Recall that $\distfun{\bm{a}^{\without 0}}{}{}$ denotes array $(\distfun{a^1}{}{},\dots,\distfun{a^\kay}{}{})$.}
$\distfun{\bm{a}^{\without 0}}{}{}|_{\InWeb(\distfun{\bm{a}}{}{})}$ is an open $C^{\frac12}$-embedding in $\RR^\kay$.
Thus there is an inverse of 
$\distfun{\bm{a}^{\without 0}}{}{}|_{\InWeb(\distfun{\bm{a}}{}{})}$, say $\map\:\RR^\kay\subto\spc{U}$.

The subfunction $f=\distfun{a^0}{}{}\circ\map$ is semiconvex and locally Lipschitz.
Moreover, if $\kappa\le 0$, then $f$ is convex.
\end{subthm}

In particular, $\Web(\distfun{\bm{a}}{}{})$ is compact and
$\InWeb(\distfun{\bm{a}}{}{})$ is $C^{\frac12}$-homeomorphic to an open subset of $\RR^\kay$.
\end{thm}

\begin{thm}{Definition}\label{prop-def:web-embedding}
The submap $\map\:\RR^{\kay}\subto \spc{X}$ as in Theorem~\ref{thm:cat-bary-web:mnfld}
will be called the \emph{$\distfun{\bm{a}}{}{}$-web embedding}\index{web embedding} 
with \emph{brace} $\distfun{a^0}{}{}$.
\end{thm}

\begin{thm}{Definition}
Let $\spc{U}$ be a complete length $\CAT\kappa$ space
and $\bm{a}=(a^0,a^1,\dots a^\kay)$ be a point array with radius $<\tfrac{\varpi\kappa}{2}$.
If $\InWeb(\distfun{\bm{a}}{}{})$ is nonempty, then the point array $\bm{a}$ is called \emph{nondegenerate}\index{nondegenerate point array}.
\end{thm}

Lemma~\ref{lem:nondeg-test-with-balls} will provide examples of nondegenerate point arrays,
which can be used in Theorem~\ref{thm:cat-bary-web:mnfld}.

\begin{thm}{Corollary}\label{cor:LinDim>bary}
Let $\spc{U}$ be a complete length $\CAT\kappa$ space,
$\bm{a}\z=(a^0,a^1,\dots a^m)$ be a nondegenerate point array 
of radius $<\tfrac{\varpi\kappa}{2}$ in $\spc{U}$
and $\sigma=\spx{\bm{a}}\mc\kappa$ be corresponding $\kappa$-baricentric simplex.
Then for some $\bm{x}\in \Delta^m$
the differential $\dd_{\bm{x}}\sigma$ is linear 
and the image $\Im\dd_{\bm{x}}\sigma$
forms a subcone isometric to an $m$-dimensional Euclidean space in the tangent cone $\T_{\sigma(\bm{x})}$.
\end{thm}


\parit{Proof.}
Denote by $\tau\:\spc{U}\to\RR^m$
 the distance map $\distfun{\bm{a}^{\without 0}}{}{}$.

According to Theorem~\ref{thm:cat-bary-web},
$\sigma$ is Lipschitz
and 
the distance map 
$\tau$,
gives an open embedding of 
$\InWeb(\distfun{\bm{a}}{}{})=\sigma(\Delta^m)\backslash\sigma(\partial\Delta^m)$.
Note that $\tau$ is Lipschitz.
According to Rademacher's theorem %??? (\ref{thm:rademacher})
the differential 
$\dd_{\bm{x}}(\tau\circ\sigma)$
is linear for almost all $\bm{x}\in\Delta^m$.
Further since $\InWeb(\distfun{\bm{a}}{}{})\z\ne\emptyset$,
the area formula %??? ref
implies that $\dd_{\bm{x}}(\tau\circ\sigma)$ is surjective on a set of positive masure of points $\bm{x}\in\Delta^m$.

Note that $\dd_{\bm{x}}(\tau\circ\sigma)=(\dd_{\sigma(\bm{x})}\tau)\circ(\dd_{\bm{x}}\sigma)$.
Applying Rademacher's theorem again, we get that
$\dd_{\bm{x}}\sigma$ is linear for almost all $\bm{x}\in\Delta^m$,
at these points $\Im\dd_{\bm{x}}\sigma$ forms a subcone isometric to a Euclidean space in $\T_{\sigma(\bm{x})}$.
Clearly the dimension of $\Im\dd_{\bm{x}}(\tau\circ\sigma)$ is at least as big as dimension of $\Im\dd_{\bm{x}}\sigma$.
Hence the result.
\qeds


\parit{Proof of \ref{thm:cat-bary-web}.}
Fix $z\in\spc{U}$ and $r<\tfrac{\varpi\kappa}2$
such that $\dist{z}{a^i}{}<r$ for all $i$.
Note that the set $K\cap \cBall[z,r]$ is convex, closed, and contains all $a^i$.
Applying the theorem on short retract (Exercise~\ref{ex:short-retraction-CBA(1)}),
we get the second part of (\ref{SHORT.thm:cat-bary-web:web=Im(bary)}).

\medskip

The rest of the statements are proved first in case $\kappa\le 0$ 
and then the remaining case $\kappa>0$ is reduced to the case $\kappa=0$.

\parit{Case $\kappa\le 0$.}
Consider function array $f^i=\md\kappa\circ \distfun{a^i}{}{}$.
From the definition of web (\ref{def:web}),
it is clear that $\Web(\distfun{\bm{a}}{}{})=\Web\bm{f}$.
Further, from the definition of $\kappa$-barycentric simplex,
$\spx{\bm{a}}\mc\kappa=\spx{\bm{f}}$.

All the functions $f^i$ are strongly convex (see \ref{function-comp}).
Therefore (\ref{thm:cat-bary-web:Lip}), (\ref{thm:cat-bary-web:web=Im(bary)}) and the first statements in (\ref{thm:cat-bary-web:web=Im(bary)}) 
 follow from Theorem \ref{thm:web}.
%???CHECK convexity ???

\parit{Case $\kappa>0$.}
Applying rescaling, we can assume $\kappa=1$;
so $\varpi\kappa=\varpi1=\pi$.

Set $\mathring{\spc{U}}=\Cone\spc{U}$;
by \ref{thm:warp-curv-bound:cbb:S}, $\mathring{\spc{U}}$ is $\CAT0$.
Let us denote by $\iota$ the natural embedding of $\spc{U}$ as the unit sphere in $\mathring{\spc{U}}$ and 
$\proj\:\mathring{\spc{U}}\subto\spc{U}$ the submap,
defined as $\proj(v)=\iota^{-1}(v/|v|)$ for all 
$v\not=\0$.
Note that there is $z\in\spc{U}$ and $\eps>0$ such that
the set 
\[K_\eps
=
\set{v\in\mathring{\spc{U}}}%
{\<\iota(z),v\>\ge\eps}\] 
contains all $\iota(a^i)$.
Note that 
$\0\notin K_\eps$
and
the set $K_\eps$ is closed and convex.
The later follows from Exercise~\ref{ex:busemann-CBA},
since $v\mapsto -\<\iota(z),v\>$ is a Busemann function.

Denote by $\iota(\bm{a})$ the point array $(\iota(a^0), \iota(a^1),\dots,\iota(a^\kay))$ in $\mathring{\spc{U}}$. 
From the case $\kappa=0$,
we get that $\Im \spx{\iota(\bm{a})}\mc0\subset K_\eps$.
In particular $\Im \spx{\iota(\bm{a})}\mc0\not\ni \0$ and thus $\proj\circ\spx{\iota(\bm{a})}\mc0$ is defined.
Direct calculations show 
\[\spx{\bm{a}}\mc1
=
\proj\circ\spx{\iota(\bm{a})}\mc0
\quad\t{and}\quad
\Web(\distfun{\bm{a}}{}{})=\proj[\Web(\distfun{\iota(\bm{a})}{}{})].\]
It reduces the case $\kappa=1$ of the theorem to the case $\kappa=0$,
which is proved already.
\qeds



\begin{thm}{Lemma}\label{lem:nondeg-test-with-balls}
Let $\spc{U}$ be a complete length $\CAT\kappa$ space,
$\bm{a}\z=(a^0,a^1,\dots a^\kay)$ be an array of radius $<\tfrac{\varpi\kappa}2$
and $B^i=\cBall[a^i,r^i]$ for some array of positive reals $(r^0,r^1,\dots,r^\kay)$.
Assume that
$\bigcap_i B^i=\emptyset$,
but
$\bigcap_{i\not=j} B^i\not=\emptyset$
for any $j$.
Then $\bm{a}$ is nondegenerate. 
\end{thm}

\parit{Proof.} 
Without loss of generality we can assume that $\spc{U}$ is geodesic and $\diam\spc{U}\z<\varpi\kappa$.
If not, choose a point $z\in\spc{U}$ and $r<\tfrac{\varpi\kappa}{2}$ such that
$\dist{z}{a^i}{}\le r$
for each $i$
and consider $\cBall[z,r]$ instead of $\spc{U}$.
The later can be done since $\cBall[z,r]$ is convex and closed, 
thus $\cBall[z,r]$ is a complete length $\CAT\kappa$ space 
and $\Web(\distfun{\bm{a}}{}{})\subset\cBall[z,r]$;
see \ref{cor:convex-balls} and \ref{thm:cat-bary-web:web=Im(bary)}.

By Theorem~\ref{thm:cat-bary-web}, $\Web(\distfun{\bm{a}}{}{})$ is a compact set,
therefore there is a point $p\in\Web(\distfun{\bm{a}}{}{})$
minimizing the function 
\[f(x)=\max_i\{\distfun{B^i}{x}{}\}=\max\{0,\dist{a^0}{x}{}-r^0,\dots,\dist{a^\kay}{x}{}-r^\kay\}.\]

By the definition of web (\ref{def:web}), 
$p$ is also the minimum point of $f$ on $\spc{U}$.
Let us show that

\begin{clm}{}
 $p\notin B^j$ for any $j$.
\end{clm}

Indeed, 
assume the contrary; that is, 
\[
p\in B^j
\eqlbl{eq:p-in-Bj}
\] 
for some $j$.
Then $p$ is a point of local minimum for the function 
\[h^j(x)=\max_{i\not=j}\{\distfun{B^i}{x}{}\}.\]
Hence 
\[\max_{i\not=j}\{\mangle\hinge p x {a^i}\}\ge \tfrac\pi2
\]
for any $x\in\spc{U}$.
From angle comparison (\ref{cat-hinge}), it follows that 
$p$ is a global minimum of $h^j$ and hence
\[
p\in \bigcap_{i\not=j} B^i.
\]
The latter and \ref{eq:p-in-Bj} contradict $\bigcap_i B^i=\emptyset$. \claimqeds

From the definition of web, it also follows that 
\[\Web(\distfun{\bm{a}^{\without j}}{}{})\subset \bigcup_{i\not=j}B^i.\]
Indeed, if $q\in \bigcap_{i\not=j}B^i$ and $q'\notin \bigcup_{i\not=j}B^i$,
then $\dist{a_i}{q}{}\z<\dist{a_i}{q'}{}$ for any $i\ne j$ therefore $q'\notin \Web(\distfun{\bm{a}^{\without j}}{}{})$.
Therefore, the claim implies that
$p\notin\Web(\distfun{\bm{a}^{\without j}}{}{})$ for each $j$;
that is, $p\in\InWeb(\distfun{\bm{a}}{}{})$.
\qeds



\section{Dimension}\label{sec:dim-cba}

We start with two examples.

The first example shows that the dimension of a complete length $\CAT{}$ spaces is not local;
that is, such spaces might have open sets with different linear dimension.

Such an example can be constructed by gluing at one point two Euclidean spaces of different dimensions.
According to Reshetnyak's gluing theorem (\ref{thm:gluing}), this construction gives a $\CAT{0}$ spaces.

The second example provides a complete length $\CAT{}$ space 
with topological dimension one and arbitrary large Hausdorff dimension.
Thus, for complete length $\CAT{}$ spaces, one should not expect any relations between topological and Hausdorff dimensions except for the one provided by Szpilrajn's theorem (\ref{thm:szpilrajn}).

To construct the second type of examples,
note that the completion of any metric tree has topological dimension one and is $\CAT\kappa$ for any $\kappa$.
Start with a binary tree $\Gamma$, and a sequence $\eps_n>0$ such that $\sum_n\eps_n<\infty$.
Define the metric on $\Gamma$
by prescribing length of edge from level $n$ to the level $n+1$ to be $\eps_n$.
For an appropriately chosen sequence $\eps_n$, the completion of $\Gamma$ will contain a Cantor set of arbitrary large dimension.

\medskip

The following is a version of the theorem proved by Bruce Kleiner \cite{kleiner} with an improvement made by Alexander Lytchak \cite{lytchak:diff}.

\begin{thm}{Theorem}\label{thm:dim-infty-CBA}
For any complete length $\CAT\kappa$ space $\spc{U}$, the following statements are equivalent:

\begin{subthm}{LinDim-CBA} $\LinDim\spc{U}\ge m$;
\end{subthm}

\begin{subthm}{thm:dim-infty-CBA:bary} 
For some $z\in \spc{U}$ there is an array of $m+1$ balls $B^i\z=\oBall(a^i,r^i)$ with $a^0,a^1,\dots,a^m\in \oBall(z,\frac{\varpi\kappa}2)$ 
such that 
\[\bigcap_i B^i=\emptyset
\quad\text{and}\quad
\bigcap_{i\not=j} B^i\not=\emptyset
\quad \text{for each $j$}.\]

\end{subthm}


\begin{subthm}{thm:dim-infty-CBA:mnfld} 
There is a $C^{\frac{1}{2}}$-embedding $\map\:\cBall[1]_{\EE^m}\hookrightarrow \spc{U}$;
that is, $\map$ is bi-H\"older with exponent $\tfrac{1}{2}$.
\end{subthm}

\begin{subthm}{thm:dim-infty-CBA:TopDim}
There is a closed separable set $K\subset\spc{U}$ such that 
\[\TopDim K\ge m.\]
\end{subthm}

\end{thm}

\parbf{Remarks.}
Theorem \ref{thm:loc-lip-inverse} gives a stronger version of part (\ref{SHORT.thm:dim-infty-CBA:mnfld}) in finite dimensional case.
Namely, a complete length $\CAT{}$ space with linear dimension $m$ 
admits a bi-Lipschitz embedding $\map$ of an open set of $\RR^m$.
Moreover, the Lipschitz constants of $\map$ can be made arbitrary close to~$1$.

\begin{thm}{Corollary}\label{cor:dim-CBA}
For any separable complete length $\CAT{}$ space $\spc{U}$, we have
\[\TopDim\spc{U}=\LinDim\spc{U}.\]

\end{thm}


Any simplicial complex can be equipped with a length-metric
such that each $\kay$-simplex 
is isometric to the standard simplex
\[\Delta^\kay
=
\set{(x_0,\dots,x_\kay)\in \RR^{\kay+1}}
{x_i\ge 0,\quad x_0+\dots+x_\kay=1}\]
with the metric induced by the $\ell^1$-norm on $\RR^{\kay+1}$.
This metric will be called the \emph{$\ell^1$-metric}\index{$\ell^1$-metric} on the simplicial complex.

\begin{thm}{Lemma}\label{lem:approximation-cba}
Let $\spc{U}$ be a complete length $\CAT\kappa$ space
and $\rho\:\spc{U}\to\RR$ be a continuous positive function.
Then there is a simplicial complex $\spc{N}$ equiped with $\ell^1$-metric,
a locally Lipschitz map $\map\:\spc{U}\to \spc{N}$ 
and a Lipschitz map $\map[2]\:\spc{N}\to\spc{U}$ such that

\begin{subthm}{lem:approximation-cba:displacement}
The \emph{displacement} of composition $\map[2]\circ\map\:\spc{U}\to\spc{U}$ is bounded by $\rho$;
that is,
\[\dist{x}{\map[2]\circ\map(x)}{}<\rho(x)\] 
for any $x\in\spc{U}$
\end{subthm}

\begin{subthm}{lem:approximation-cba:im}
If $\LinDim\spc{U}\le m$ 
then the $\map[2]$-image of any closed simplex in $\spc{N}$ 
coincides with the image of its $m$-skeleton.
\end{subthm}

\end{thm}

\parit{Proof.}
Without loss of generality, we can assume that for any $x$ we have $\rho(x)\z<\rho_0$
for some fixed $\rho_0<\tfrac{\varpi\kappa}{2}$.

By Stone's theorem%ref???
, any metric space is paracompact.
Thus, we can choose a locally finite covering $\set{\Omega_\alpha}{\alpha\in\IndexSet}$ of $\spc{U}$ such that $\Omega_\alpha\subset \oBall(x,\tfrac{1}{3}\cdot\rho(x))$ for any $x\in \Omega_\alpha$. 

Denote by $\spc{N}$ the nerve of the covering $\{\Omega_\alpha\}$;
that is, $\spc{N}$ is an abstract simplicial complex with set of vertexes formed by $\IndexSet$ such that
$\{\alpha^0,\alpha^1,\dots,\alpha^n\}\subset\IndexSet$ 
are vertexes of a simplex if and only if
$\Omega_{\alpha^0}
\cap
\Omega_{\alpha^1}
\cap\dots\cap
\Omega_{\alpha^n}
\not=
\emptyset$.

Fix a Lipschitz partition of unity 
$\phi_\alpha\:\spc{U}\to [0,1]$, subordinate to $\{\Omega_\alpha\}$.
Consider the map $\map\:\spc{U}\to \spc{N}$ such that the barycentric coordinate of $\map(p)$ is $\phi_\alpha(p)$.
Note that $\map$ is locally Lipschitz. 
Clearly $\map$-preimage of any open simplex in $\spc{N}$ lies in $\Omega_\alpha$ for some $\alpha\in\IndexSet$.

For each $\alpha\in\IndexSet$, 
choose $x_\alpha\in\Omega_\alpha$.
Let us extend the map $\alpha\mapsto x_\alpha$
to a map $\map[2]\:\spc{N}\to\spc{U}$ that is $\kappa$-barycentric on each simplex;
according to Theorem~\ref{thm:cat-bary-web:Lip}, this extension exists, 
$\map[2]$ is Lipschtz
and its Lipschitz constant depends only on $\rho_0$ and $\kappa$.

\parit{(\ref{SHORT.lem:approximation-cba:displacement})}
Fix $x\in\spc{U}$.
Denote by $\Delta$ the minimal simplex that contains $\map(x)$;
and let $(\alpha^0,\alpha^1,\dots,\alpha^n)$ be the vertexes of $\Delta$.
Note that $\alpha$ is a vertex of $\Delta$ if and only if $\phi_{\alpha}(x)>0$.
Thus,
\[\dist{x}{x_{\alpha^i}}{}<\tfrac{1}{3}\cdot\rho(x)\] 
for any $i$.
Therefore 
\[\diam\map[2](\Delta)
\le
\max_{i,j}\{\dist{x_{\alpha^i}}{x_{\alpha^j}}{}\}
<
\tfrac{2}{3}\cdot\rho(x).\]
In particular 
\[\dist{x}{\map[2]\circ\map(x)}{}\le\dist{x}{x_{\alpha^0}}{}+\diam \map[2](\Delta) <\rho(x).\]

\parit{(\ref{SHORT.lem:approximation-cba:im})}
Assume the contrary;
that is, $\map[2](\spc{N})$ is not inculded in the $\map[2]$-image of $m$-skeleton of $\spc{N}$.
Then for some $\kay>m$,
there is a $\kay$-simplex $\Delta^\kay$ in $\spc{N}$,
such that the baricentric simplex $\sigma=\map[2]|_{\Delta^\kay}$ is nondegenrate; 
that is, 
$$W=\map[2](\Delta^\kay)\backslash\map[2](\partial\Delta^\kay)\not=\emptyset.
$$
Applying Corollary~\ref{cor:LinDim>bary},
we get that $\LinDim\spc{U}\ge \kay$, a contradiction.
\qeds






\parit{Proof of \ref{thm:dim-infty-CBA}.} 
Note that
\begin{itemize}
\item The implication (\ref{SHORT.thm:dim-infty-CBA:bary})$\Rightarrow$(\ref{SHORT.thm:dim-infty-CBA:mnfld})
follows directly from Lemma~\ref{lem:nondeg-test-with-balls}
and Theorem~\ref{thm:cat-bary-web:mnfld}.
\item The implication 
(\ref{SHORT.thm:dim-infty-CBA:mnfld})$\Rightarrow$(\ref{SHORT.thm:dim-infty-CBA:TopDim}) 
is trivial.
\end{itemize}
 
\parit{(\ref{SHORT.thm:dim-infty-CBA:TopDim})$\Rightarrow$(\ref{SHORT.LinDim-CBA}).}
According to Theorem~\ref{thm:stable-value}, 
there is a continuous map $f\:K\to \RR^{m}$ with a stable value.
By Tietze extension theorem%ref???
, it is possible to extend $f$ 
to a continuous map $F\:\spc{U}\to \RR^{m}$.

Fix $\eps>0$.
Since $F$ is continuous, there is a continuous positive function $\rho$ defined on $\spc{U}$ such that 
\[\dist{x}{y}{}<\rho(x)
\quad\Rightarrow\quad
|F(x)- F(y)|<\tfrac13\cdot\eps.\]
Apply Lemma~\ref{lem:approximation-cba} for the function $\rho$.
For the obtained simplicial complex $\spc{N}$, 
 and maps $\map\:\spc{U}\to \spc{N}$, $\map[2]\:\spc{N}\to \spc{U}$, we have
\[|F\circ \map[2]\circ\map(x)-F(x)|<\tfrac13\cdot\eps\] 
for any $x\in \spc{U}$.

According to Lemma~\ref{lem:lip-approx},
there is a locally Lipschitz map $F_\eps\:\spc{U}\to \RR^{m+1}$ 
such that $|F_\eps(x)-F(x)|<\tfrac13\cdot\eps$ for any $x\in \spc{U}$.

Note that
$\map(K)$ is contained in a countable subcomplex of $\spc{N}$, say $\spc{N}'$.
Indeed, since $K$ is separable, there is a countable dense collection of points $\{x_n\}$ in $K$.
Denote by $\Delta_n$ the minimal simplex of $\spc{N}$ that contains $\map(x_n)$.
Then $\map(K)\subset\bigcup_i\Delta_n$.

Arguing by contradiction,
assume $\LinDim\spc{U}<m$.
By \ref{lem:approximation-cba:im},
the image $F_\eps\circ\map[2]\circ\map(K)$ lies in the $F_\eps$-image of $(m-1)$-skeliton of $\spc{N}'$;
in particular it can be covered 
by countable collection of Lipschitz images of $(m-1)$-simplexes.
Hence
$\bm{0}\in \RR^m$ is not a stable value of the restriction $F_\eps\circ\map[2]\circ\map|_K$.
Since $\eps>0$ is arbitrary, 
we get that $\bm{0}\in \RR^m$ is not a stable value of $f=F|_K$, a contradiction.

\parit{(\ref{SHORT.LinDim-CBA})$\Rightarrow$(\ref{SHORT.thm:dim-infty-CBA:bary}).} 
The following claim follows from the definition of tangent space.

\begin{clm}{}\label{clm:finite-config-cba}
Let $q\in \spc{U}$ and $\dot x^1,\dot x^2,\dots,\dot x^n\in \T_q$.
Then given $\delta>0$,
there is a point array $x^1,x^2,\dots,x^n$ in $\spc{U}$ 
such that 
\[\mangle(\dot x^i,\ddir q{x^i})<\delta\]
and for some fixed $\lam>0$ we have
\[\tfrac1\lam\cdot\dist[{{}}]{q}{x^i}{}=|\dot x^i|\quad
\t{and}\quad |\tfrac1\lam\cdot\dist[{{}}]{x^i}{x^j}{}-\dist{\dot x^i}{\dot x^j}{}|<\delta\] 
for all $i$ and $j$.

Moreover the value $\lam$ can be taken arbitrary small.
\end{clm}

\parit{Proof of the claim.} For each $i$ choose a geodesic $\gamma^i$ 
from $q$ that goes almost in the directions of $\dot x^i$.
Then take the point $x^i$ on $\gamma^i$ on the distance $\lam\cdot|\dot x^i|$ from $q$.
\claimqeds


Choose $q\in \spc{U}$ such that $\T_q$ contains a subcone $E$ isometric to $m$-dimensional Euclidean space.
Note that one can choose $\eps>0$ 
and a point arrray $(\dot a^0,\dot a^1,\dots,\dot a^m)$ in $E\subset \T_q$ 
such that 
$\bigcap_i\cBall[\dot a^i,1+\eps]=\emptyset$
and $\bigcap_{i\not=j}\cBall[\dot a^i,1\z-\eps]\z{\not=}\emptyset$ for each $j$.

Applying Claim \ref{clm:finite-config-cba}, we get a point array 
$(a^0,a^1,\dots,a^m)$ in $\spc{U}$
such that $\bigcap_i\cBall[a^i,\lam]=\emptyset$
and $\bigcap_{i\not=j}\cBall[a^i,\lam]\not=\emptyset$ for each $j$.
Since $\lam>0$ can be chousen arbitrary small, 
it implies (\ref{SHORT.thm:dim-infty-CBA:bary}).
\qeds


\section{Finite-dimensional spaces}

Recall that web embedding and its brace is defined in \ref{prop-def:web-embedding}.

{\sloppy 

\begin{thm}{Theorem}\label{thm:loc-lip-inverse}
Let $\spc{U}$ be a complete length $\CAT\kappa$ space,
$\LinDim\spc{U}=m$,
and $\bm{a}=(a^0,a^1,\dots a^m)$ be a point array in $\spc{U}$ 
with radius $<\tfrac{\varpi\kappa}{2}$.
Then 
the $\distfun{\bm{a}}{}{}$-web embedding $\map\:\RR^m\subto\spc{U}$ with brace $\distfun{a^0}{}{}$ is locally Lipschitz.
\end{thm}

}

Note that if $\bm{a}$ is degenerate,
that is, if $\InWeb(\distfun{\bm{a}}{}{})=\emptyset$, 
then
the domain of the web embedding $\map$ above is empty and hence the conclusion of the theorem trivially holds.

\begin{thm}{Lemma}\label{lem:nondeg-bs-test}
Let $\spc{U}$ be a complete length $\CAT\kappa$ space,
and $\bm{a}\z=(a^0,a^1,\dots a^\kay)$ be a point array with radius $<\tfrac{\varpi\kappa}{2}$.
Then for any $p\in \InWeb(\distfun{\bm{a}}{}{})$,
there is $\eps>0$ such that 
if for some $q\in \Web(\distfun{\bm{a}}{}{})$ and $b\in\spc{U}$
we have 
\[\dist{p}{q}{}<\eps,
\quad 
\dist{p}{b}{}<\eps
\quad\text{and}\quad 
\mangle\hinge{q}{b}{a^i}<\tfrac\pi2+\eps\]
for each $i$,
then the array $b,a^0,a^1,\dots,a^m$ is nondegenerate.
\end{thm}


\parit{Proof.}
Without loss of generality, we may assume that $\spc{U}$ is geodesic and $\diam\spc{U}<\varpi\kappa$.
If not, consider instead of $\spc{U}$,
a ball $\cBall[z,r]\subset\spc{U}$ 
for some $z\in\spc{U}$ 
and $r<\tfrac{\varpi\kappa}{2}$
such that $\dist{z}{a^i}{}\le r$ for each $i$.

From angle comparison (\ref{cat-hinge}), it follows that 
$p\in\InWeb\bm{a}$ if and only if both of the following conditions hold:
\begin{enumerate}
\item $\max_i\{\mangle\hinge p{a^i}{u}\}\ge \tfrac\pi2$ for any $u\in\spc{U}$,
\item\label{prop:<pi/2} for each $i$ there is $u^i\in\spc{U}$ such that $\mangle\hinge p{a^j}{u^i}<\tfrac\pi2$ for all $j\not=i$.
\end{enumerate}

Due to the semicontinuity of angles (\ref{lem:ang.semicont}),
there is $\eps>0$ such that for any $x\in \oBall(p,10\cdot\eps)$ we have
\[
\mangle\hinge {x}{a^j}{u^i}
<
\tfrac\pi2-10\cdot\eps
\quad\t{for all}\quad j\not=i.
\eqlbl{eq:<pi/2-eps}\]

Now assume for sufficiently small $\eps>0$
there are points $b\in\spc{U}$ and $q\in\Web(\distfun{\bm{a}}{}{})$ such that 
\[\dist{p}{q}{}<\eps,\quad \dist{p}{b}{}<\eps,\quad \mangle\hinge{q}{b}{a^i}<\tfrac\pi2+\eps\quad\t{for all}\quad i.
\eqlbl{eq:2nd-angle}\]
Acording to Theorem~\ref{thm:cat-bary-web:web=Im(bary)},
for all small $\eps>0$, we have 
\[\rad\{b,a^0,a^1,\dots,a^\kay\}<\tfrac{\varpi\kappa}2.\]
Fix sufficiently small $\delta>0$
and set 
\[v^i=\geod_{[q u^i]}(\tfrac13\cdot\delta)\quad\t{and}\quad w^i=\geod_{[v^i b]}(\tfrac23\cdot\delta).\]
Clearly,
\begin{align*}
\dist{b}{w^i}{}
&=
\dist{b}{v^i}{}-\tfrac23\cdot\delta
\le
\\
&\le
\dist{b}{q}{}-\tfrac13\cdot\delta.
\\
\intertext{Further, the inequalities \ref{eq:<pi/2-eps} and \ref{eq:2nd-angle} imply}
\dist{a^j}{w^i}{}
&<
\dist{a^j}{v^i}{}+\tfrac23\cdot\eps\cdot\delta
<
\\
&<
\dist{a^i}{q}{}-\eps\cdot\delta
<
\\
&<
\dist{a^i}{q}{}
\end{align*}
for all $i\not=j$.

Set $B^i=\cBall[a^i,\dist{a^i}{q}{}]$ and $B^{m+1}=\cBall[b,\dist{a^i}{q}{}-\tfrac13\cdot\delta]$.
Clearly 
\begin{align*}
&\!\!\!\!\bigcap_{i\not=m+1} B^i=\{q\},
\\
&\bigcap_{i\not=j}B^i\ni w^j\quad\t{for}\quad j\not=m+1.
\\
&\bigcap_{i}B^i=\{q\}\cap B^{m+1}=\emptyset.
\end{align*}
Lemma~\ref{lem:nondeg-test-with-balls} finishes the proof.
\qeds


\parit{Proof of \ref{thm:loc-lip-inverse}.}
From \ref{prop-def:web-embedding}, it is sufficient to show that 
the $\map$ is locally Lipshitz.
Assume the contrary; that is, there are sequences $\bm{y}_n, \bm{z}_n\to \bm{x}\in\Dom\map$ such that
\[\frac{\dist{\map(\bm{y}_n)}{\map(\bm{z}_n}{})}{|\bm{y}_n-\bm{z}_n|}
\to\infty
\quad
\t{as}
\quad
n\to\infty.
\eqlbl{eq:nonlip}\]
Set $p=\map(\bm{x})$,
$q_n=\map(\bm{y}_n)$, 
and $b_n=\map(\bm{z}_n)$.
From \ref{prop-def:web-embedding}, $p$, $q_n$, $b_n\in\InWeb(\distfun{\bm{a}}{}{})$
and $q_n,b_n\to p$ as $n\to\infty$.
Fix arbitrary $\eps>0$.
Note that \ref{eq:nonlip} implies
\[\mangle\hinge{q_n}{a^i}{b_n}<\tfrac\pi2+\eps
\]
for all $i>0$ and all large $n$.
Further, according to \ref{prop-def:web-embedding}, the subfunction
$(\distfun{\bm{a}^0}{}{})\circ\map$ is locally Lipschitz.
Therefore we also have 
\[\mangle\hinge{q_n}{a^0}{b_n}<\tfrac\pi2+\eps
\]
for all large $n$.
According to Lemma~\ref{lem:nondeg-bs-test}, the point array $b_n,a^0,\dots,a^\kay$ for large $n$ is nondegenerate.

Applying Corollary~\ref{cor:LinDim>bary},
we get a contradiction
\qeds



\section{Remarks and open problems}

The following conjecture (in an equivalent form)
appers in \cite{kleiner}, see also \cite[p.~133]{gromov:asymt-inv}.

\begin{thm}{Conjecture}
For any complete length $\CAT{}$ space $\spc{U}$, we have
\[\TopDim\spc{U}
=
\LinDim\spc{U}.\]

\end{thm}

By Corollary~\ref{cor:dim-CBA} it holds for separable spaces


















