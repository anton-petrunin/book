\chapter{Multidistance functions}


\section{Composite  subfunction}\label{sec:composite}

All the constructions in this section 
work in general metric spaces;
the lower curvature bound as well as dimension 
will come into the game only in the next section.

In this section
we introduce so called \emph{composite functions},
which will be used later to define \emph{multidistance functions},
a generalization of the distance functions 
which 
is sufficiently flexible for applications.

Formally composite  subfunction is a pair of 
a map $\bm{f}$ from the space to $\RR^\kay$
and a subfunction $F$ on $\RR^\kay$.
But it is better to think of it as of subfunction $F\circ \bm{f}$
with an extra structure, which we will call ``cannonical representation''.
This canonical representaion has to be remembered all the time one work with composite functions, but it used only ocasionally.

\parbf{Composite subfunctions.}
Let $\spc{X}$ be a metric space
and $\bm{f}=(f^1,f^2,\dots,f^\kay)$ be an aray of real functions on $\spc{X}$; we can also regard $\bm{f}$ as a map $\bm{f}\:\spc{X}\to\RR^\kay$.
Let $F\:\RR^\kay\subto\RR$ be a subfunction and $\phi=F\circ\bm{f}$.
The subfunction $\phi\:\spc{X}\subto\RR$ together with a choice of \emph{canonical representation}\index{canonical representation} $\phi=F\circ\bm{f}$ will be called \emph{composite subfunction}\index{composite subfunction}.
For a composite function $\phi$,
we write $\phi\can F\circ\bm{f}$ if we want to emphasise that $F\circ\bm{f}$ is its canonical representation.

Let $F\circ\bm{f}=F(f^1,f^2,\dots,f^\kay)$ be a canonical representation and $\sigma$ is a permutation of $(1,2,\dots,\kay)$.
Assume $H\circ\bm{h}=H(h^1,h^2,\dots,h^\kay)$ is an other representaion such that
\begin{clm}{}\label{clm:F=H}
$F(x^{\sigma(1)},x^{\sigma(2)},\dots,x^{\sigma(\kay)})
\equiv
H(x^1,x^2,\dots,x^\kay)$
and
$f^i\equiv h^{\sigma(i)}$
for all $i$.
\end{clm}
\noi Then the presentations $F\circ\bm{f}$ and $H\circ\bm{h}$
are regarded to be the same.

A presentation $G\circ \bm{g}=G(g^1,g^2,\dots,g^{\kay+m})$
is also considered to be the same as $F\circ\bm{f}$
if 
\begin{clm}{}\label{clm:F=G}
$F(x^1,x^2,\dots,x^\kay)
\equiv
G(x^1,x^2,\dots,x^{\kay+m})$
and
$f^i\equiv g^i$
for all $i\le \kay$.
\end{clm}
\noi In other words, if $G\circ \bm{g}$ can be obtained from $F\circ\bm{f}$ by including in the function array some extra functions on which $F$ does not depend.

Clearly the conditions \ref{clm:F=H} and \ref{clm:F=G} imply 
\[H\circ\bm{h}
\equiv 
F\circ\bm{f}\equiv G\circ \bm{g},\]
but the converse does not hold.

On the formal base, 
a composite function on $\spc{X}$
is a pair $\phi=(\bm{f}, F)$, where $\bm{f}\:\spc{X}\to\RR^\kay$ and $F\:\RR^\kay\subto\RR$ up to the minimal equivalence relation which includes \ref{clm:F=H} and \ref{clm:F=G}.

\parbf{Operations.}
The arithmetic operations can be naturally extended to the class of composite subfunctions.

For example, given $\theta\can H\circ\bm{h}$, $\phi\can F\circ\bm{f}$, we will write $\psi=\theta+\phi$ where $\psi\can G\circ\bm{g}$,
the function array
$\bm{g}$ is joint of arrays $\bm{h}=(h^1,h^2,\dots,h^n)$ and $\bm{f}=(f^1,f^2,\dots,f^\kay)$ and 
\[
G(x^1,x^2,\dots,x^n,y^1,y^2,\dots,y^\kay)
\df
H(x^1,x^2,\dots,x^n)
+
F(y^1,y^2,\dots,y^\kay).\]

Similarly, we can define multiplication,  maximum and minimum in the class of composite subfunctions.
Even more generally, 
given a subfunction $\map\:\RR^n\to\RR$ 
and an array of composite subfunctions $(\phi^1,\phi^2,\dots,\phi^n)$ on space $\spc{X}$,
the subfunction 
\[
\map(\phi^1,\phi^2,\dots,\phi^n)\:\spc{X}\subto\RR
\]
has natural canonical representation, 
and thus it can be regarded as a composite subfunction it-self.

\parbf{Second derivative of composite functions.}
Let $\phi\can F\circ\bm f$ be a composite function defined on a smooth manifold $\spc{M}$
and all the functions $F$ and $f^i$ are smooth.
Given a geodesic $\gamma\:\II\to\spc{M}$, we have
\[
(\phi\circ\gamma)''(t)
=
(\Hess_{\bm{x}} F)(\bm{x}',\bm{x}')
+
(\d_{\bm{x}}F)(\bm{x}''),
\]
where $\bm{x}=\bm{f}\circ\gamma(t)$,
$\bm{x}'=(\bm{f}\circ\gamma)'(t)$
and 
$\bm{x}''=(\bm{f}\circ\gamma)''(t)$.

The following proposition state that a corollary of the above formula still holds in general metric space. 

\begin{thm}{Proposition}\label{prop:composite+convex}
Let $\spc{X}$ is a metric space,
$\bm{f}=(f^1,f^2,\dots,f^\kay)\:\spc{X}\subto\RR^\kay$
be an array of semiconcave subfunctions.
Assume $F\:\RR^k\to\RR$ is a locally Lipschitz subfunction which is nondecreasing in each argument,
$F''(\bm{f}(p))\le \Lambda$  
and each $(f^i)''(p)\le \lambda^i$, 
then
\[
\phi''(p)
\le
\max
\{\Lambda\cdot(\lip_p\bm{f})^2,-\Lambda\cdot(\colip_p\bm{f})^2\}
+\sum_i\lambda^i\cdot\partial_iF.
\]
\end{thm}

\parit{Proof.}
Note that it is sufficient to consider the case when $\spc{X}$ is a real interval 
--- that follows form Definition~\ref{def:f''}.

If all functions $f^i$ and $F$ are smooth,
the statement follows from standard calculus.

In general case, one should present $F$ and $f^i$ as a limits of smooth semiconcave functions with the same bounds on second derivatives and then pass to the limit.
\qeds

\section{Multidistance functions.}

\begin{thm}{Definition}\label{def:MD}
Let $\spc{L}$ be a metric space.
A composite  subfunction $\phi\:\spc{L}\subto\RR$ is called \emph{multidistance subfunction}%
\index{multidistance subfunction} 
(briefly, $\phi\in \MD(\spc{L},\RR)$) 
if
$\phi\can F\circ\dist{\bm{a}}{}{}$ 
where $\dist{\bm{a}}{}{}$ is a distance map; that is,
\[
\dist{\bm{a}}{}{}
=
(\dist{a^1}{}{},\dots,\dist{a^\kay}{}{})\:\spc{L}\to\RR^\kay
\]
for some point array $\bm{a}=(a^1,\dots,a^\kay)$ and 
$F\:\RR^\kay\subto\RR$ is a smooth subfunction
which is not decreasing in each argument
and 
$\Dom F$
lies in the positve octant of $\RR^\kay$.
\end{thm}

For example, 
given a point array $\bm{a}=(a^1,a^2)$ in space $\spc{L}$,
both functions 
\begin{align*}
\phi(x)&=\dist{a^1}{x}{}+\dist{a^2}{x}{}
&
\psi&=\dist[{{}}]{a^1}{x}{}\cdot\dist[{{}}]{a^2}{x}{}
\end{align*}
 restricted to $\spc{L}\backslash \{a,b\}$ 
can be interpreted as multidistance functions;
say

\begin{align*}
&\phi\can F\circ\dist{\bm{a}}{}{}
&
&\psi\can G\circ\dist{\bm{a}}{}{}
\\
&F(x,y)=x+y, 
&
&G(x,y)=x\cdot y
\end{align*}
and $\Dom F=\Dom G=(0,\infty)\times(0,\infty)$.

\parbf{Liftings.}
Recall that for a Gromov--Hausdorff convergence of metric spaces
$\spc{L}_n\GHto\spc{L}$,
a lifting of a point $p\in \spc{L}$ is any sequece $p_n\in\spc{L}_n$ such that $p_n\GHto p$
Let us consider a mutidistnat function 
\begin{align*}
\phi&\:\spc{L}\to\RR,
&
\phi&\can F\circ\dist{\bm{a}}{}{}
\end{align*}
with the point array $\bm{a}=(a^1,a^2,\dots,a^\kay)$ and $F\:\RR^\kay\to \RR$.
A lifting of $\phi$ is any sequence of multidistant 
functions 
 \begin{align*}
\phi_n
&\:\spc{L}_n\to\RR,
&
\phi_n
&\can F\circ\dist{\bm{a}_n}{}{}
\end{align*}
such that $\bm{a}_n=(a_n^1,a_n^2,\dots,a_n^\kay)$
is a point array in $\spc{L}_n$
and for each $i$ the sequence $a_n^i$ is a lifting of $a^i$.



\section{Convexity}

The following construction produce 
a strongly concave multidistance function
defined in a neighborhood of a given point 
of a $\Alex{}$ space.
Moreover the concavity of this function survive 
after lifting, in the noncollapsing convergence 
with lower curvature bound.

\parit{Construction.}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space and $p\in\spc{L}$.
Choose an arbitrary point array 
$\bm{a}=(a^1,a^2,\dots,a^\kay)$
such that the distance map $\dist{\bm{a}}{}{}\:\spc{L}\to\RR^\kay$ is bi-Lipschitz in a neighborhood of $p$.
According to  Theorem \ref{thm:dist-emb},
such array $\bm{a}$ exists; 
moreover 
\begin{itemize}
\item All the points in the array $\bm{a}$ can be chosen arbitrary close to a given point $z\in \spc{L}$. In particular we can assume that $a^i\ne p$ for any $i$.
\item The Lipshitz and co-Lipschitz constants of the map $\dist{\bm{a}}{}{}$ near $p$ can be estimated only in terms of $m$, $\kappa$ and the distances $\dist{p}{a^i}{}$ and $\dist{a^i}{a^j}{}$. 
\end{itemize}

Set $\bm{x}=\dist{\bm{a}}{p}{}\in\RR^\kay$.
Given $\Lambda\in\RR$,
we can choose a smooth subfunction $F\:\RR^\kay\subto\RR$
which is nondecreasing in each argument
and defined in a small neighborhood of $\bm{x}$
and such that $F''(\bm{x})\le \Lambda$ and $\partial_iF\le 1$ for each $i$.
Consider multidistance function $\phi\can F\circ\dist{\bm{a}}{}{}$.
By Proposition~\ref{prop:composite+convex},
we get that $\phi''(p)\le \lambda$
for some $\lambda=\lambda(\Lambda)$ such that
$\lambda\to-\infty$ as $\Lambda\to-\infty$.
In particular, if $\Lambda$ is near $-\infty$
then $\phi$ is strongly concave 
in a neighborhood of $p$.

Assume $\spc{L}_n\to\spc{L}$ with $\spc{L}_n\in\CBB{m}{\kappa}$, so $\dim{L}_n=\dim\spc{L}$ for all $n$
and $\phi\:\spc{L}\to \RR$ 
is a multidistance function constructed above. 
Note that if $\phi_n\:{L}_n\subto\RR$ are the liftings of $\phi$ and $p_n\in{L}_n$ are the liftings of $p$
then $\phi_n''(p_n)\le\lambda$ for all large $n$.
\qeds

Here is a direct corollary from the above construction.
(It is one of the statements which is easy to prove but hard to formulate in sufficient generality.)

\begin{thm}{Corollary}%
\label{cor:strong-conc-approx}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space, 
$\lambda\in\RR$,
$\eps>0$
and $p,z\in \spc{L}$.
Then there is a multidistant function 
$\phi\can F\circ\dist{\bm{a}}{}{}$
such that $\Dom\phi\ni p$,
$\phi''(p)\le\lambda$ and
$$\d_p\phi(\xi)<\d_p\dist[{{}}]{z}{}{}+\eps$$
for any $\xi\in\Sigma_p$.

Moreover, 
\begin{itemize}
 \item The points in the array $\bm{a}$ can be chosen arbitrary close to $z$
 \item For any convergence $\spc{L}_n\GHto\spc{L}$
such that
$\spc{L}_n\in\CBB{m}{\kappa}$ for each $n$,
any liftings $\phi_n$ of $\phi$ and 
any $p_n$ of $p$ we have
$\phi_n''(p_n)\le\lambda$ for all large $n$.
\end{itemize}
\end{thm}

\parit{Proof.}
According to ???,
there is $\delta>0$ such that for any $a\in \oBall(z,\delta)$,
$\d_p\dist{a}{}{}<\d_p\dist[{{}}]{z}{}{}+\eps$.
Applying Theorem \ref{thm:dist-emb},
we get a point array $\bm{a}$ in $\oBall(z,\delta)$ such that
the distance map $\dist{\bm{a}}{}{}$ is bi-Lipschitz in a neighborhood of $p$.
It remains to apply the construction above.
\qeds


\begin{thm}{Proposition}\label{prop:convex-function}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space, 
and $p\in\spc{L}$.
Then there is a strongly concave locally Lipschitz subfunction $\phi$
defined in a neighborhood of $p$ which has a maximum at $p$.
\end{thm}

\parit{Proof.}
By Lemma~\ref{lem:comp-sigma}, $\Sigma_p$ is compact.
Therefore there is finite collection of points $z^1,z^2,\dots,z^\kay$
so that the directions $\dir{p}{z^i}$ form a $\tfrac\pi4$-net in $\Sigma_p$.
Applying $\kay$ times Corollary~\ref{cor:strong-conc-approx},
we get a collection of strongly concave functions $\phi^i$ 
defined on a neighborhood of $p$
such that the differential $\d_p\phi^i$ is arbitrary close to $\d_p\dist{z^i}{}{}$.
Then the function 
\[\phi(x)=\min_i\{\phi^i(x)-\phi^i(p)\}\]
satisfies the condition of theorem.

Indeed, by construction $\phi$ is strongly concave.
Choose $\eps>0$ so that
$\oBall(p,\eps)\subset \Dom \phi$. 
By construction $\phi$ is strongly concave,
$\phi(p)=0$ and
$\d_p\phi=\min_i\{d_p\phi^i\}\le 0$.
Therefore 
\begin{align*}
\phi(x)&
\le (\d_p\phi)(\ddir{p}{x})
\le 0
\end{align*}
for any $x\in \oBall(p,\eps)$.

Further, 
the set
$$K=\set{x\in\spc{L}}{\phi(x)>-\delta}$$
satisfies the second part of theorem for all sufficiently small $\delta>0$ .
\qeds

Although the next statement follows trivially from the corollary above,
we call it a ``theorem'' since it is conceptually important.
Essentially it says that any point of an $m$-dimensional complete length $\Alex{}$ space admits
an arbitrary small closed neighborhood 
which is forms an $m$-dimensional complete length $\Alex{}$ subspace.
For infinite dimensional $\Alex{}$ spaces, 
an analogous statement does not hold;
see Exercise~\ref{ex:no-convex-nbhd-CBB}.

\begin{thm}{Theorem on convex neighborhood}\label{thm:convex-nbhd}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space, 
$\eps>0$ 
and $p\in\spc{L}$.
Then 
there is a compact convex set $K\subset\oBall(p,\eps)$
which contains $p$ in its interior.
\end{thm}

The statement of following theorem is very similar to the Existence and uniqueness of gradient (\ref{thm:ex-grad});
it differ mainly by sign of scalar product in the formula;
see also Exericise~\ref{ex:supporting-vector}.

\begin{thm}{Existance of supporting vector}
\label{prop:support}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space.
Then for any multidistant subfunction $\phi\:\spc{L}\subto\RR$ 
and any point $p\in \Dom\phi$
there is a vector $w\in \T_p$ such that 
\[\<w,x\>+\d_p\phi(x)\le 0\] 
for any $x\in\T_p$.

\end{thm}

The proof of the proposition relies on the following Sum lemma;
this lemma should be compared with Anti-sum lemma \ref{lem:minus-sum}. 

\begin{thm}{Sum lemma}\label{lem:sum}
Let  $\spc{L}\in\CBB{m}{\kappa}$, 
$p\in  \spc{L}$ and $v^1,v^2,\dots,v^\kay\in\T_p$.
Then there is a vector $w\in \T_p$ such that for any semiconcave locally Lipschitz subfunction $f\:\spc{L}\subto\RR$ we have
\[(\d_pf)(w)\ge \sum_i(\d_pf)(v^i)\eqlbl{eq:df(w)>0}.\]

In particular, for any $x\in\T_p$ we have 
\[\<w,x\>\le \sum_i\<v^i,x\>.\]

\end{thm}

\parit{Proof.}
By Theorem~\ref{thm:tan4finite},
$\T_p\in\CBB{m}{\kappa}$; 
in particular $\T_p$ is a geodesic space.

Since $\d_pf\:\T_p\to\RR$ is concave and positive-homogenous,
for any two vectors $u,v\in \T_p$ we have that 
\[\d_pf(w)\ge \d_pf(u) + \d_pf(v)
\eqlbl{eq:df(w)}\]
if $\tfrac12\cdot w$ is the midpoint for a geodesic $[uv]$.

Let us define a sequence of vectors $w^j\in\T_p$ recursively.
Set $w^1=v^1$ 
and $w^{j+1}=\tfrac12\cdot z^{j}$,
where $z^j$ is the midpoint of a geodesic $[v^j w^j]$.
Applying inequality \ref{eq:df(w)} few times, 
we get that $w=w^{m+1}$ satisfies \ref{eq:df(w)>0}.

Now let us turn to the second part of lemma.
Note that we can assume that $x\ne 0$.
Therefore we can choose a sequence of points $a_n\to p$ such that $\dir{p}{a_n}\to x/|x|$ as $n\to\infty$.
Set $f_n=\dist{a_n}{}{}$.
We can assume that the geodesic $[pa_n]$ is unique for all $n$,
so $\d_pf_n(z)=-\<\dir p{a_n},z\>$ for all $z$.
It remains to apply \ref{eq:df(w)>0} for $f_n$
and pass to the limit as $n\to\infty$.
\qeds

\parit{Proof of Proposition~\ref{prop:support}.}
Let $\phi\can F\circ\dist{\bm{a}}{}{}$.
Set $v^i=\partial_i F\cdot\dir{p}{a^i}$
for some choice of geodesics $[pa^i]$.
From \ref{???}, we have
\[d_p\phi(x)\le -\sum_i\<v^i,x\>\] 
for any $x\in\T_p$.
The result then follows from the Sum lemma (\ref{lem:sum}).
\qeds

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Struts revisited}

Our next aim is to define
$\kappa$-strutting array of multidistance functions for a given point.
To do this we need a new comparison function;
it takes two multidistance functions $\phi$ and $\psi$ and returns a real value at given point $p$,
which will be denoted as 
$\sdk\kappa{p}{\phi}{\psi}$.
If $\phi\can F\circ\dist{\bm{a}}{}{}$ 
and $\psi\can G\circ\dist{\bm{b}}{}{}$
then 
$$\sdk\kappa{p}{\phi}{\psi}
\df
\sum_{i,j}\partial_iF\cdot\partial_jG\cdot \cos\angk\kappa p{a^i}{b^j}.$$
The expression $\sdk\kappa{p}{\phi}{\psi}$
should be red \emph{$\kappa$-comparison scalar of $\phi$ and $\psi$ at $p$};
it is a model analog for the scalar product of differentials $\d_p\phi$ and $\d_p\psi$,
although this scalar product may be undefined;
compare with Exercise~\ref{ex:d(grad)<0}.

\begin{thm}{Definition}\label{def:strut-II}
Let $\spc{L}$ be a complete length $\Alex{}$ space.
An array of multidistant functions 
$\bm{\phi}\z=(\phi^0,\phi^1,\dots,\phi^\kay)$
on $\spc{L}$
is \emph{$\kappa$-strutting}\index{strutting array of multidistance functions} for a point $p\in\spc{L}$ if 
\[\sdk\kappa{p}{\phi^i}{\phi^j}<0\]
for all $i\not=j$.

In this case, we say that $p$ is a 
\emph{critical point}\index{critical point} 
for the submap $\bm{\phi}\:\spc{L}\subto \RR^{\kay+1}$
if
\[\min_i\d_p\phi^i\le 0\]
and otherwise $p$ is called 
\emph{regular point}\index{regular point} of $\bm{\phi}$.
\end{thm} 

Note that if there is a point array $(a^0,a^1,\dots,a^\kay)$
such that%
\footnote{More formally, $\phi^i\can F\circ\dist{a^i}{}{}$ where $F(x)=x$ and $\Dom F=(0,\infty)$.} $\phi^i\can\dist{a^i}{}{}$ for each $i$
then $(\phi^0,\phi^1,\dots,\phi^\kay)$
is $\kappa$-strutting $p$
if and only if 
$(a^0,a^1,\dots,a^\kay)$ is $\kappa$-strutting $p$.
I.e., the above definition is a direct generalization of Definition \ref{def:strut-I}.

\begin{thm}{Lemma}\label{lem:multi+rank}
Let $\spc{L}\in\CBB{m}{\kappa}$, 
$p\in  \spc{L}$
and an array of multidistant subfunctions $\bm{\phi}=(\phi^0,\phi^1,\dots,\phi^\kay)$ struts $p$.
Then $\rank_p\ge \kay$
\end{thm}

This lemma, 
together with Corollary~\ref{cor:strong-conc-approx}
and Proposition~\ref{prop:stutt} implies the following.


\begin{thm}{Corollary}\label{cor:multi+rank}
Let $\spc{L}\in\CBB{m}{\kappa}$, 
$p\in  \spc{L}$.
Then $\rank_p\ge \kay$
if and only if there is an array of multidistant functions $\bm{\phi}=(\phi^0,\phi^1,\dots,\phi^\kay)$ which struts $p$.

Moreover, given a real value $\lambda$
we can assume in addition that each $\phi^i$ meets the following conditions:
\begin{itemize}
\item $(\phi^i)''(p)< \lambda$
\item $(\phi_n^i)''(p_n)< \lambda$ for 
any convergence $\spc{L}_n\GHto\spc{L}$,
any lifts $\phi^i_n\:\spc{L}_n\to\RR$ of $\phi^i$,
any lift $p_n\in \spc{L}_n$ of $p$
and all large $n$.
\end{itemize}
\end{thm}

\parit{Proof of Lemma~\ref{lem:multi+rank}.}
Assume that 
an array of multidistant functions $(\phi^0,\phi^1,\dots,\phi^\kay)$ is $\kappa$-stratting $p$.
Without loss of generality, we may assume that 
$\phi^i\can F^i\circ\dist{\bm{a}}{}{}$ for a fixed point array $\bm{a}=(a^1,a^2,\dots,a^\kay)$.

Consider vectors $v^i_j=\partial_jF^i\cdot\dir{p}{a^j}$ for some choice of geodesics $[pa^j]$.
Applying the hinge comparison (\ref{angle})
and then Sum lemma (\ref{lem:sum}), 
we get that there are vector array 
$(w^1,w^2,\dots w^\kay)$  in $\T_p$
such that 
\begin{align*}
0&>\sdk\kappa{p}{\phi^i}{\phi^j}
\ge
\\
&\ge\sum_{n,m}\<v^i_n,v^j_m\>\ge
\\
&\ge\sum_n\<v^i_n,w^j\>\ge
\\
&\ge\<w^i,w^j\>
\end{align*}
for all $i\ne j$.
In particular, $\mangle(w^i,w^j)>\tfrac\pi2$ for all $i\ne j$;
that is, $\rank_p\ge \kay$.
\qeds



\begin{thm}{Proposition}\label{prop:regular=+1}
Let $\spc{L}\in\CBB{m}{\kappa}$, 
$p\in  \spc{L}$.
$(\phi^0,\phi^1,\dots,\phi^\kay)$
be an array of multidistant functions which is $\kappa$-strutting $p$.

Then $p$ is a regular point of $\bm{\phi}$ if and only if there is a multidistance subfunction $\psi$ such that 
the array 
$(\phi^0,\phi^1,\dots,\phi^\kay,\psi)$ 
is $\kappa$-strutting $p$.

Moreover, given a real value $\lambda$
we can assume in addition that $\psi$ meets the following conditions:
\begin{itemize}
\item $\psi''(p)< \lambda$
\item $\psi_n''(p_n)< \lambda$ for 
any convergence $\spc{L}_n\GHto\spc{L}$,
any lifts $\psi_n\:\spc{L}_n\to\RR$ of $\psi$,
any lift $p_n\in \spc{L}_n$ of $p$
and all large $n$.
\end{itemize}
\end{thm}



\parit{Proof; ``if''-part.}
Assume $(\phi^0,\phi^1,\dots,\phi^\kay,\psi)$ is $\kappa$-strutting $p$.
Assume $\psi\can G\circ\dist{\bm{b}}{}{}$;
$\bm{b}=(b^1,b^2,\dots,b^m)$.
Set 
\[v^j=\partial_jG\cdot \dir{p}{b^j}\] 
for some choice of geodesics $[p b^j]$.
Note that $\sdk\kappa p{\phi^i}\psi<0$ implies that
\[\sum_j\d_p\phi^i(v^j)>0.
\eqlbl{eq:sum df(v)}
\]
Therefore applying Sum lemma (\ref{lem:sum})
we get the needed $w$.
 To show that $p$ is a regular point of $\bm{\phi}$,
we have to produce a vector $w\in\T_p$ such that 
\[\d_p\phi^i(w)>0\] 
for each $i$.

\parit{``Only if''.}
Now assume $p$ is a regular point. 
Then there is a point $z$ such that 
\[d_p\phi^i(\dir{p}{z})>0\]
for each $i$.
If $\bar z\in\l]pz\r]$ and $\bar z\to p$
then
\[\sdk\kappa p{\phi}{\dist{\bar z}{}{}}\to d_p\phi^i(\dir{p}{z}).\]
In particular, 
taking%
\footnote{More formally, $\psi\can G\circ\dist{a^i}{}{}$ where $G(x)=x$ and $\Dom G=(0,\infty)$.} $\psi=\dist{\bar z}{}{}$ we get the first part of the proposition. 

The second part follows once Corollary~\ref{cor:strong-conc-approx} is applyed for the base point $p$ and the point $\bar z$ found above.
\qeds

\begin{thm}{Proposition}\label{prop:strut>strut}
Let $\spc{L}\in\CBB{m}{\kappa}$,
$\lambda\in\RR$,
$p,z^0,z^1,\dots,z^\kay\in \spc{L}$.

Assume $(z^0,z^1,\dots,z^\kay)$ is $\kappa$-strutting $p$.
Then there is a point array
$\bm{a}\z=(a^1,a^2,\dots, a^{n})$
and an array of strongly concave multidistant functions 
$\bm{\phi}=(\phi^0,\phi^1,\dots,\phi^\kay)$, 
$\phi^i\can F^i\circ\dist{\bm{a}}{}{}$
such that 

\begin{subthm}{prop:strut>strut:strut}
The function array $\bm{\phi}=(\phi^0,\phi^1,\dots,\phi^\kay)$ is $\kappa$-strutting $p$.
\end{subthm}

\begin{subthm}{prop:strut>strut:concave}
$(\phi^i)''(p)<\lambda$ for each $i$.
\end{subthm}

Moreover given a sequence of spaces $\spc{L}_n\in\CBB{m}{\kappa}$
such that $\spc{L}_n\GHto \spc{L}$,
the above conditions hold for the liftings.
I.e., if $\phi_n^i\:\spc{L}_n\to\RR$ 
are liftings of $\phi^i$ 
and $p_n\in \spc{L}_n$ is a lifting of $p$
then 
for all large $n$ we have
(\ref{SHORT.prop:strut>strut:strut})
the function array $\bm{\phi}_n=(\phi_n^0,\phi_n^1,\dots,\phi_n^\kay)$ is $\kappa$-strutting $p_n$
and 
(\ref{SHORT.prop:strut>strut:concave}) $(\phi_n^i)''(p_n)<\lambda$ for each $i$.
\end{thm}

\parit{Proof.}
Follows from Corollary~\ref{cor:strong-conc-approx}.
\qeds

\begin{thm}{Corollary}
Let $\spc{L}\in\CBB{m}{\kappa}$ and $p\in  \spc{L}$.
Assume $\rank_p\spc{L}\ge \kay$
then there is an array 
of $\kay+1$ strongly concave
multidistant functions which is $\kappa$-strutting $p$.
\end{thm}

Let $p\in\spc{L}$ and $\kay=\rank_p$.
Let us choose an array of strongly concave multidistant subfunctions $(\phi^0,\phi^1,\dots,\phi^\kay)$ which is $\kappa$-strutting $p$.

According to Theorem on convex neighborhood (\ref{thm:convex-nbhd}) we can choose a compact convex neighborhood $K$ of $p$
which lies in $\Dom\phi^i$ for each $i$.
We also can assume that $K$ is chosen so small that $(\phi^0,\phi^1,\dots,\phi^\kay)$ which is $\kappa$-strutting every point of $K$.
In particular, according to ???, $\rank_x\ge \kay$ for any $x\in K$. 

In the subspace $K$, 
let us consider web for the function array
$-\bm{\phi}$ (the minus-sign is to make the functions strongly \emph{convex}, not \emph{concave}).
Note that $p\in\InWeb(-\bm{\phi})$;
indeed ???.

Note that if for some $x\in\Int K$, 
we have $\rank_x=\kay$ 
then $x\in\InWeb (-\bm{\phi})$.
Indeed, ???

Therefore, by Theorem~\ref{thm:web:bary},
the set 
$$\set{x\in K}{\rank_x=\kay}$$
lies in the image of the barycentric simplex $\spx{(-\bm{\phi})}$.

\begin{thm}{Theorem}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space,
$\bm{\phi}=(\phi^0,\phi^1,\dots,\phi^\kay)$ 
is an array of multidistant functions which 
$\kappa$-struts every point in a compact convex set $K\subset  \spc{L}$.
Denote by $M$ the set critical points of $\bm{\phi}$ in the interior of $K$.

Then $M$
admits a Lipschitz bijective map to an open subset of $\RR^\kay$ with a $C^{\frac12}$-inverse.
In particular from $M$ forms a $C^{\frac12}$ submanifold of $\spc{L}$.

Moreover $M$ lies in an image of a Lipschitz map $\Delta^\kay\to \spc{L}$.
\end{thm}

\parit{Proof.}
Since each function $-\phi^i$ is strongly convex,
one can apply Theorem~\ref{thm:web} to the
subspace $K$
and the array $-\bm{\phi}=(-\phi^0,-\phi^1,-\dots,-\phi^\kay)$.
We obtain that $M=\Int K\cap \Web{(-\bm{\phi})}$.

According to Proposition~\ref{prop:regular=+1}, 
any subarray $\bm{\phi}^{\ne i}$
has no critical points in $K$.
Therefore $M=\Int K\cap\InWeb{(-\bm{\phi})}$.
From \ref{thm:web:Up-convex} the first part of theorem follows.

The second part follows from \ref{thm:web:lip-const}.
\qeds


\section{Remarks and open questions}

The definitions of strut (\ref{def:strut-I})
gives a necessary condition on the model angles
$\angk{\kappa}{p}{a^i}{a^j}$ which ensure that the distance 
map $\dist{\bm{a}^{\ne 0}}{}{}\:\spc{L}\to\RR^m$ 
is a homeomorphism in a neighborhood of $p$.
One may want to exchange this condition to the following.

\begin{thm}{Definition of generalized struts}\label{def:strut-generalized}
Let $\spc{L}$ be a complete length $\Alex{}$ space.
We say that a point array $(a^0,a^1,\dots,a^\kay)\in\spc{L}^{\kay+1}$
is ??? $\kappa$-strutting for a point $p\in\spc{L}$ 
if for any points $\~ p, \~ a^0, \~ a^1,\dots,\~ a^m$ in $\Lob{m}{\kappa}$, 
such that 
$\dist{\~ p}{\~ a^i}{}=\dist{p}{a^i}{}$ for each $i$
and $\dist{\~ a^i}{\~ a^j}{}\ge \dist{a^i}{a^j}{}$ for all $i$ and $j$
the point $\~ p$ is an interior point of the convex hull of $\~ p, \~ a^0, \~ a^1,\dots,\~ a^m$.
\end{thm} 

For example if $p,a^0,a^1,a^2$ be three points in a $\CBB{2}{0}$ space
such that $\angk0p{a^0}{a^1},\angk0p{a^0}{a^2}>\tfrac34\cdot\pi$ 
and $\angk0p{a^1}{a^2}>\tfrac13\cdot\pi$ then $(a^0,a^1,a^2)$ is not strutting $p$ in the sense of definition \ref{def:strut-I}, but it does strutting $p$ in the generalized sense.

Although the generalized definition is more natural,
its formulation is more complicated 
and it is harder to check it directly.


Let us extend a definition of regular value for $\DC$-submaps.
Let $\spc{L}$ be a complete length $\Alex{}$ space 
and $f\: \spc{L}\subto\RR$ is a $\DC$-subfunction.
A point  $p\in \spc{L}$ is called regular point of $f$ if there is a representation $f=a-b$, where $a,b$ are concave such that 
$(\d_p a)(\nabla_p b)<0$ and $(\d_p b)(\nabla_pa)<0$.
Otherwise, $p$ is a critical point of $f$.

Let ${\bm{f}}=(f^1,f^2,\dots,f^\kay)\:\spc{L}\to\RR^\kay$ be an array of  DC-functions. 
We say that $p\in \spc{L}$ is a regular point of ${\bm{f}}$ if it is a regular point of $h\circ \bm{f}$ for any nonzero linear function $h\:\RR^m\to\RR$.

\begin{thm}{Question}\label{q:regular}
Let $\spc{L}$ be a complete length $\Alex{}$ space, 
${\bm{f}}\:\spc{L}\to\RR^m$ be an array of $\DC$-functions and $p\in \spc{L}$ is a regular point of $\bm{f}$.
Is there a righ-inverse of $\bm{f}$ defined in a neighborhood of $\bm{f}(p)\in \RR^m$?
\end{thm}


The following question remains completely open (so far there is no even technique which could approach it in principle).

\begin{thm}{Question}
Assume $\spc{L}\in\CBB\infty\kappa$, 
is it allways possible to construct a bi-Lipschitz embedding $\cBall[1]_{\EE^m}\hookrightarrow \spc{L}$ for any positive integer $m$?
\end{thm}

The following seems to be ``right'' definition of strut.
It is completely analogous to the def in CBA,
but it is  longer and in all applications the above definition is sufficient.%???

\begin{thm}{Definition of struts}\label{def:strut-I+}
Let $\spc{L}$ be a complete length $\Alex{}$ space.
We say that a point array $(a^0,a^1,\dots,a^\kay)\in\spc{L}^{\kay+1}$
is $\kappa$-strutting for a point $p\in\spc{L}$ if 
for any collection of points $\xi^0,\xi^1,\dots,\xi^\kay\in \SS^{\kay-1}$
such that $\dist{\xi^i}{\xi^j}{\SS^{\kay-1}}\ge \mangle\hinge{p}{a^i}{a^j}$ for all $i$ and $j$ 
has radius $>\tfrac\pi2$.
\end{thm} 

Let 
$\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space
and $f\:\spc{L}\to \RR$ be two locally Lipschitz semicaonave function.
Let us denote by $\Diff f$ the set of all points $q\in\spc{L}$ such that
both differential $\d_qf$ is linear;
that is equivalent to $\d_qf(z)=\<\nabla_qf,z\>$ for any $z\in\T_p$.
According to ???, almost all points of $\spc{L}$ lie in $\Diff f$.

Given two locally Lipschitz semiconcave function $f,h\:\spc{L}\to \RR$,
define 
\[
\<\d_qf,\d_qh\>
\df
\<\nabla_qf,\nabla_q h\>
\ \ \t{for any}\ \ 
q\in \Diff f\cap\Diff h,\]
then extend the function $q\mapsto \<\d_qf,\d_qh\>$ to whole $\spc{L}$ as a lower???-semicontinuous function;
that is,
\[
\<\d_pf,\d_ph\>
\df
\limsup\set{\<\d_qf,\d_qh\>}{q\to p,\ q\in \Diff f\cap \Diff h}.
\]

The following inductive definition was used originally in \cite[???]{perelman:DC}; 
it is not hard to see that it gives the same value:

Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space, 
$p\in\spc{L}$ 
and $f,h\:\spc{L}\to \RR$ be two locally Lipschitz semicaonave function.
If $m=1$ define 
\[
\<\d_p f,\d_ph\>
=
\sup\set{\d_pf(\xi)\cdot\d_ph(\xi)}{\xi\in\Sigma_p}.
\]
Further assume we already defined scalar product of gradients for all dimensions $<m$.
Set $\phi=(\d_pf)|\Sigma_p$ and $\psi=(\d_ph)|\Sigma_p$;
since $\Sigma_p\in\CBB{m-1}{1}$ (see ???) the scalar product
$\<\d_\xi\phi,\d_\xi\psi\>$ is well defined for any $\xi\in\Sigma_p$.
Further, 
\[
\<\d_pf,\d_ph\>
\df
\sup
\set{\d_pf(\xi)\cdot\d_ph(\xi)+\<\d_\xi\phi,\d_\xi\psi\>}%
{\xi\in\Sigma_p}.
\]


\section{Exercises}

\begin{thm}{Exercise}
Let $\spc{L}$ be an $m$-dimensional complete length $\Alex{}$ space.
Show that given $\eps>0$,
one can find a countable collection of Lipschitz maps $\map_n\:\spc{L}\to \RR^{\kay_n}$ 
with $\kay_n\le m$ for each $n$
and present $\spc{L}$ as a countable union of closed sets $\mathfrak C_n$ such that each restriction 
$\map_n|\mathfrak C_n$ is $\e^{\pm\eps}$-bi-Lipschitz.
\end{thm}



Hint: Show that for each point $p$ there is a compact neighborhood $K$ and $\delta>0$ such that the set 
\[\mathfrak C_p=\set{x\in K}{\Sigma_x\le \Sigma_p+\delta}\]
admits an bi-Lipschitz embedding into $\RR^\kay$, where $\kay=\dim\Lin_p$.

\begin{thm}{Exercise}
Show that given $\eps>0$, $\kappa\in\RR$ and $n\in\ZZ_{\ge0}$ there is $\delta>0$ such that for any $\spc{L}\in\CBB{n}{\kappa}$ and any point $p\in\spc{L}$ there is a function $f\:\oBall(p,\delta)\to\RR$
such that for any geodesic $[xy]$ with $\dist{x}{y}{}>\eps$ in $\spc{L}$,
the subfunction $f\circ\gamma$ is strongly concave.
\end{thm}






\begin{thm}{Exercise}\label{ex:d(grad)<0}
Let $\spc{L}\in\CBB{m}{\kappa}$ and
$\phi,\psi\:\spc{L}\subto\RR$ be two multidistance functions.
Then 
\[d_p\phi(\nabla_p\psi)
\le
\sdk\kappa{p}{\phi}{\psi}.\]
(Compare with Exercise~\ref{ex:d dist(grad)<0}.)
\end{thm}


