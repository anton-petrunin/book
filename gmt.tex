%%!TEX root = all.tex
%%array^
%arXiv
\chapter{Measure theory}\label{chap:measure-theorey}


\section{Carath\'eodory's construction}\label{sec:mes+balls}

Let $\spc{X}$ be a metric space.
A function $\mu$ with values in $[0,\infty]$,
defined on all subsets of $\spc{X}$
is called \emph{outer measure} if
\begin{itemize}
\item $\mu\,\emptyset=0$;
\item If $A\subset B\subset \spc{X}$, then $\mu\, A\le \mu\, B$; 
\item For any sequence $A_1, A_2,\dots$ of subsets of $\spc{X}$ we have
$$\mu\left(\bigcup_n A_n\right) \le \sum_n \mu\, A_n.$$
\end{itemize}

A subset $E\subset \spc{X}$ is called \index{$\mu$-measurable}\emph{$\mu$-measurable} if 
$$\mu\, A = \mu(A \cap E) + \mu(A \backslash E)$$
for every subset $A\subset\spc{X}$.
 
Recall that given two subsets $A$ and $B$ of a metric space $\spc{X}$,
we define 
$$\dist{A}{B}{\spc{X}}\df \inf\set{\dist{a}{b}{\spc{X}}}{a\in A\ \text{and}\ b\in B}.$$
The following is a classical lemma in measure theory, 
see \cite[2.1.3 and 2.3.2(9)]{federer}.


\begin{thm}{Carath\'eodory's lemma}\label{lem:caratheodory}
Let  $\mu$ be an outer measure on a metric space $\spc{X}$.
Then the $\mu$-measurable sets form a sigma-algebra.

Moreover, if 
\[\mu(A\cup B)=\mu\, A+\mu\, B
\eqlbl{eq:caratheodory}\]
for any two sets $A$ and $B$ 
such that $\dist{A}{B}{}>0$, then any Borel set in $\spc{X}$ is $\mu$-measurable.
\end{thm}

\parbf{Carath\'eodory's construction.}\index{Carath\'eodory's construction}
Fix a function $\rho$, that returns a value in $[0,\infty]$
for any closed subset of $\spc{X}$.
Define outer measure $\Carath_\rho$ of set $W$ in $\spc{X}$ in the following way
$$\Carath_\rho W
\df
\lim_{\eps\to0}
\,
\inf
\set{\sum_{n\in\NN}\rho A_n}
{\begin{aligned}
&\bigcup_{n\in\NN}A_n\supset W, \text{all}\  
A_n
\ \text{are closed,}\ 
\\
&
\text{and}\ \diam A_n<\eps\ \text{for each}\ n.
 \end{aligned}
}.$$
Note that
the value of the infimum above is non-decreasing in $\eps$;
in particular the limit is defined.

An outer measure $\mu$ on $\spc{X}$ is called \emph{Borel regular} if any Borel set in $\spc{X}$ is $\mu$-measurable and for any set $A\subset \spc{X}$ there is a Borel set $B$ such that $A\subset B$ and $\mu\, A=\mu\, B$. 

From Carath\'eodory's lemma (\ref{lem:caratheodory}), we get the following.

\begin{thm}{Corollary}
The Carath\'eodory's construction always produce a Borel regular outer measure.
\end{thm}

Let us apply  the Carath\'eodory's construction for different choices of the function $\rho$.

\begin{thm}{Definitions}
Assume that $A$ is a closed subset of a metric space $\spc{X}$.
Fix a real value $\alpha\ge 0$ and an integer value $\kay\ge0$. 

\begin{subthm}{def:HausMes}
If we take $\rho A=(\diam A)^\alpha$,
then the measure $\Carath_\rho$ is called the \emph{$\alpha$-dimensional Hausdorff measure}\index{Hausdorff measure} and denoted as $\HausMes_\alpha$.
\end{subthm}

\begin{subthm}{def:SphMes}
If $\rho A=(\rad A)^\alpha$, the measure $\Carath_\rho$ is called the \emph{$\alpha$-dimensional spherical measure}\index{spherical measure} and denoted as 
$\SphMes_\alpha$.
\end{subthm}

%\item Let us denote by $\overline\vol_\kay$ the Lebesgue outer measure on $\RR^\kay$.
%Consider the function
%$$\rho A
%=
%\sup
%\set{\overline\vol_\kay f(A)}{f\:A\to\RR^\kay\ \text{and}\ \lip f\le 1}.$$
%The measure $\Carath_\rho$ is called $\kay$-dimensional \emph{short measure}\index{short measure} and it will be denoted as $\ShortMes$.

\begin{subthm}{def:LongMes}
Assume $\rho A$ is the least lower bound for the Lebesgue measure of a compact set $K$ in $\EE^\kay$ 
such that $f(K)\supset A$ for some short map $f\:K\to \spc{X}$
(if no such $K$ exists, 
we set $\rho A=\infty$).
For this choice of $\rho$,
the measure $\Carath_\rho$ will be called $\kay$-dimensional 
\emph{long measure}\index{long measure} 
and it will be denoted as $\LongMes_\kay$.
\end{subthm}

If we need to emphasize that the measure is defined on the space $\spc{X}$, we use $\spc{X}$ as the index.
For example, we may write $\HausMes_\alpha(A)_\spc{X}$ for the $\alpha$-dimensional Hausdorff measure of set $A$ in $\spc{X}$.
\end{thm}

The following proposition follows since
\[2\cdot\rad A
\ge
\diam A
\ge
\rad A\]
holds for any set $A$ in a metric space.

\begin{thm}{Proposition}
Let $\spc{X}$ be a metric space and the subset $A\subset \spc{X}$ is arbitrary subset
then
\begin{subthm}{}
For any $\alpha\ge 0$, we have
\[2^\alpha\cdot\SphMes_\alpha A\ge\HausMes_\alpha A\ge \SphMes_\alpha A.\]
\end{subthm}

\begin{subthm}{}
For any integer $m\ge 0$ we
have 
\[\LongMes_m A\ge \tfrac{\alpha_m}{2^m}\cdot\HausMes_m A.\]
where $\alpha_m$ is the Lebesgue measure of the unit ball in $\EE^m$.
\end{subthm}
\end{thm}

The following proposition trivially follows from the definitions

\begin{thm}{Proposition}\label{prop:bilip-measure}
Let $\spc{X}$ and $\spc{Y}$ be metric spaces, $A\subset \spc{X}$
and
 $f\: \spc{X}\to \spc{Y}$ be a $\Lip$-Lipschitz map. 
Then 
\[\HausMes_\alpha f(A)\le \Lip^\alpha\cdot\HausMes_\alpha A,\]
\[\LongMes_\kay f(A)\le \Lip^\alpha \cdot\LongMes_\kay A\] 
and 
\[\SphMes_\alpha f(A)\le \Lip^\alpha\cdot \SphMes_\alpha A.\]
If the map $f$ is $\Lip^{\mp1}$-bi-Lipschitz
then we have in addition
\[\HausMes_\alpha f(A)\ge \Lip^{-\alpha}\cdot\HausMes_\alpha A,\]
\[\LongMes_\kay f(A)\ge \Lip^{-\alpha} \cdot\LongMes_\kay A\] 
and 
\[\SphMes_\alpha f(A)\le (2\cdot \Lip)^{-\alpha}\cdot \SphMes_\alpha A.\]
\end{thm}




\section{Measurable functions}

\begin{thm}{Definition}\label{def:meas-funct}
Let $\spc{X}$ be a metric space equipped with Borel regular measure $\mu$.
A function $f\:\spc{X}\to\RR$ is called measurable if $f^{-1}(C)$ is $\mu$-measurable for any Borel subset $C\subset \RR$.
\end{thm}

%???REF???

\begin{thm}{Lusin's theorem}\label{thm:lusin}
Let $\spc{X}$ be a metric space equipped with Borel regular measure $\mu$.
Assume $\spc{X}$ can be covered by countable number of open sets with finite $\mu$-measure.
Then for any $\mu$-measurable function $f\:\spc{X}\to\RR$ and $\eps>0$
there is a continuous function $g\:\spc{X}\to\RR$ 
such that 
\[\mu\set{x\in \spc{X}}{f(x)\ne g(x)}<\eps.\]

\end{thm}


\section{Volume}

The following classical result follows directly from \cite[2.7.7]{federer}.
%???MORE-REF???

\begin{thm}{Lebesgue's theorem}\label{thm:lebesgue}
There is a unique Borel regular  measure on $\EE^m$
that is invariant with respect to translations
and such that the measure of unit cube $[0,1]^n$ is $1$.
\end{thm}

The measure on $\EE^m$ described in the Lebesgue's theorem is called \index{Euclidean volume}\emph{Euclidean volume};
it will be denoted by $\vol_m$.

Recall that $\alpha_m$ denotes the volume of a unit ball in $\EE^m$.
Let us define volume in general metric space.


\begin{thm}{Definition}\label{def:vol}
Assume $A$ is a Borel subset of metric space and $m$ is a nonnegative integer.
The $m$-dimensional volume of $A$ is defined as 
\[\vol_mA=\tfrac{\alpha_m}{2^m}\cdot\HausMes_m\]
\end{thm}

The constant $\tfrac{\alpha_m}{2^m}$ is needed to make this definition  agree with the 
the definition of volume on the Euclidean spaces.





\section{Doubling spaces and measures}\label{sec:doubling-spaces}

\begin{thm}{Definition}\label{def:doubling-space}
A metric space $\spc{X}$ is called 
\index{doubling space}\emph{doubling} 
if there is $r_0>0$ 
and a positive integer $N$ 
such that 
$$\pack_{\frac r2} B<N$$
for any ball $B$ of radius $r\le r_0$ in $\spc{X}$.
\end{thm}

\begin{thm}{Proposition}\label{prop:2ble=>loc.compact}
Any complete doubling metric space is locally compact.
\end{thm}

\parit{Proof.} Let $\spc{X}$ be a complete doubling metric space 
and the values $r_0$ and $N$ are as in  Definition~\ref{def:doubling-space}.

Fix a ball $B$ with radius $r\le r_0$ in $\spc{X}$.
Applying the definition of doubling space recursively,
we get that for any positive integer $n$ 
the ball $B$ can be covered by $N^n$ balls of radius $\tfrac{r}{2^n}$.
In particular, $B$ is uniformly bounded 
and therefore compact.
\qeds

\begin{thm}{Proposition}\label{prop:2ble=>global}
Let $\spc{X}$ be a complete length space.
Assume $\spc{X}$ and $r_0$ and $N$ are as in the definition \ref{def:doubling-space}.
Then 
\[
\pack_{r}(\cBall[x,n\cdot r])\le N^{n-1}\]
for any $n$ and $r\le \frac{r_0}2$.
\end{thm}

%%%???do we need it???

\parit{Proof.}
Let us apply induction on $n$; the base $n=2$ follows from Definition \ref{def:doubling-space}.

By the induction hypothesis, that the ball $\cBall[x,n\cdot r]$ can be covered by $N^{n-1}$ balls of radius $r$.
Therefore the ball $\cBall[x,(n+1)\cdot r]$ can be covered by $N^{n-1}$ balls of radius $2\cdot r$.
From doubling; each ball of radius $2\cdot r$ can be covered by $N$ balls of radius $r$ --- hence the statement.
\qeds

\section{Doubling measures}\label{sec:doubling-mes}

Given a closed ball $B=\cBall[x,R]$,
and a positive real number $\lam$,
let us denote by $\lam \cdot B$ the ball $\cBall[x,\lam\cdot R]$.
(When we speak of a ball $B$, 
it has to be understood that it comes with a fixed center and radius, 
even if these are not uniquely determined by $B$ as a set.)



\begin{thm}{Definition}\label{def:doubling-measure}
Let $\spc{X}$ be a metric space. 
A Borel regular measure $\mu$ on $\spc{X}$ is called 
\index{doubling measure}\emph{doubling} 
if 
(1) $\mu\,\Omega>0$ for any open set $\Omega$ 
and
(2) there are real numbers $r_0>0$ and $\Const$ such that
\[\mu (2\cdot B)
<
\Const\cdot \mu\, B\]
for any ball $B$ in $\spc{X}$ with radius at most $r_0$.
\end{thm}

Note that since the inequality is strict, the definition implies that $2\cdot B$ has finite measure.


\begin{thm}{Proposition}\label{prop:doubling-measure=>space}
Let $\spc{X}$ be a metric space with a doubling measure $\mu$.
Then $\spc{X}$ is doubling.

In particular, by Proposition~\ref{prop:2ble=>loc.compact}, 
it is locally compact.
\end{thm}

\parit{Proof.}
Assume that the values $r_0$ and $\Const$ are as in the Definition~\ref{def:doubling-measure}.

Fix a ball $B=\cBall[p,r]$ with the radius $r<\tfrac {r_0}2$.
Assume the points $x_1,x_2,\dots,x_n\in B$ are
such that $\dist{x_i}{x_j}{}>\tfrac r2$ for any $i\ne j$.
In other words the balls $B_i=\cBall[x_i,\tfrac r4]$ are mutually disjoint.

Note that $8\cdot B_i\supset B$
for any $i$.
Since $\mu$ is doubling, we get 
\[\mu\, B_i>\tfrac1{\Const^3}\cdot \mu\, B\eqlbl{eq:4-ling}\]
On the other hand 
$B_i\subset 2\cdot B$ for each $i$.
Therefore 
\begin{align*}
\sum_{i=1}^n\mu\, B_i
&\le 
\mu(2\cdot B)
<
\\
&<\Const\cdot \mu\, B.
\end{align*}
Together with \ref{eq:4-ling}, 
the later implies 
\[n< \Const^4\]
--- hence the result.
\qeds


\begin{thm}{Proposition}\label{prop:bounded=>finite-measure}
Let $\spc{X}$ be a complete length space with doubling measure $\mu$.
Then any bounded set in $\spc{X}$ has finite $\mu$-measure.
\end{thm}

\parit{Proof.}
Let $A$ be a bounded set in $\spc{X}$;
we need to show that $\mu\, A<\infty$.
Without loss of generality we may assume that $A$ is closed;
otherwise pass to the closure of $A$.

By Proposition~\ref{prop:2ble=>loc.compact},
$\spc{X}$ is locally compact.
Since $\spc{X}$ is a complete length space,
by Hopf--Rinow theorem (\ref{thm:Hopf-Rinow}), 
it has to be proper.
In particular, $A$ has to be compact.

From the definition of doubling measure, there is a positive real value $r_0$ such that 
any ball of radius $r_0$ in $\spc{X}$ has finite measure
(see the remark after the Definition~\ref{def:doubling-measure}).

Since $A$ is compact it can be covered by a finite number of such balls. 
Hence the result follows.
\qeds

\begin{thm}{Proposition}\label{prop:doubling&balls-comparison}
Let $\spc{X}$ be a complete length space with doubling measure $\mu$
then the ratio
$$\frac{\mu (\cBall[a,r_a])}{\mu (\cBall[b,r_b])}$$
can be bounded in terms of $\dist{a}{b}{\spc{X}}$, $r_a$ and $r_b$.
\end{thm}

\parit{Proof.}
Let $r_0$ and $\Const$ be as in the definition of  doubling measure (\ref{def:doubling-measure}).

Note that if $B$ is a ball of radius at most $r_0$, then
\[1
\le
\frac{\mu\, B}{\mu \left(\tfrac1{2^\kay}\cdot B\right)}
\le c^\kay.\]
By Proposition~\ref{prop:2ble=>global}, therefore, it is sufficient to prove the statement in the case  $r_a=r_b\z=r_0$.

Set $A=\cBall[a,r_0]$ 
and $B=\cBall[b,r_0]$.
Note that if $\dist{a}{b}{}<r_0$
then $A\subset 2\cdot B$;
in particular, $\mu\, A\le \mu (2\cdot B)$.
Since $\mu$ is doubling, we get
\[\frac{\mu\, A}{\mu\, B}<c.
\eqlbl{eq:muA/muB-1}
\]

Since $\spc{X}$ is a length space,
any two points $x$ and $y$ in  $\spc{X}$
can be joint by a chain 
$x=x_0,x_1,\dots x_n=y$
such that 
$\dist{x_{i-1}}{x_i}{}
<
r_0$
for all $i$.
Applying the inequality \ref{eq:muA/muB-1} few times, we get that if $r_a=r_b=r_0$, then
\[\frac{\mu\, A}{\mu\, B}<c^N,
\eqlbl{eq:muA/muB-2}
\]
where $N=\lceil\frac{\dist{x}{y}{}}{r_0}\rceil$.
\qeds

\section{Covering theorems}

Let $A\subset \spc{X}$.
A family of closed balls $\mathfrak{B}$ in $\spc{X}$ is called 
\index{Vitali covering}\emph{Vitali covering}%
\footnote{Our definition of Vitali covering is among the most restrictive ones. More general definitions are given in the Federer's book \cite{federer}.}
of $A$ if for every $a\in A$ and $\eps > 0$, 
there is a ball from $\mathfrak{B}$ 
centered at $a$ and 
radius $R<\eps$.

In this section will discuss two closely related covering theorems.

\begin{thm}{Vitali covering theorem}\label{thm:vitali}
Let 
$\mu$ be a doubling measure on a metric space $\spc{X}$
and let
$\mathfrak{B}$ be a Vitali covering
of a set $A\subset \spc{X}$.
Assume $\mu\, A<\infty$,
then there is a countable collection of disjoint balls 
$\{B_n\}_{n\in\IndexSet}\subset\mathfrak{B}$ such that
$$\mu\left(A\left\backslash\bigcup_{n\in\IndexSet}B_n\right.\right)=0.$$
\end{thm}

For the proof see for example \cite[Theorem 1.6]{heinonen};
in a more general form it appears in \cite[Section 2.8]{federer}

Next covering theorem makes a stronger condition on metric space
but relax the condition on the measure.
To formulate this theorem we need 
the notion of \emph{directionally limited metric spaces}.
This class of spaces was introduced in \cite[2.8.9]{federer};
essentially these are the spaces where proof of Besicovitch covering theorem
works.
We state the definition is a slightly less general form, but it will be sufficient for our needs;
compare \cite[page 7]{heinonen}).

\begin{thm}{Definition}\label{def:directionally-limited}
A metric space $\spc{X}$
is called \emph{directionally limited}\index{directionally limited}
if there is $\eps>0$ and a positive integer $M$
such that for any point $p\in \spc{X}$
there are at most $M$ distinct points $a_1,\dots a_n$
such that if for some $i\ne j$ we have a point $x\in [pa_i]$ such that $|p-x|=|p-a_j|$
then $|x-a_j|\ge\tfrac14\cdot|p-a_j|$.
\end{thm}
%??? the def seems to be right, but not very natural --- any space without geodesics is not directionally limited.



\begin{thm}{Besicovitch covering theorem}
Let $\spc{X}$ be a directionally limited metric space 
and $\mu$ be a Borel regular measure on $\spc{X}$.
Assume $A$ is a subset in $\spc{X}$ such that $\mu\, A<\infty$
and let $\mathfrak{B}$ be a Vitali covering of $A$.
Then there is at most countable collection of disjointed balls 
$\{B_n\}_{n\in\IndexSet}\subset\mathfrak{B}$ such that
$$\mu\left(A\left\backslash\bigcup_{n\in\IndexSet}B_n\right.\right)=0.$$

\end{thm}

\section{Coarea formulas}\label{sec:coarea-prelim}

In order to formulate the coarea formula,
first we need to define Jacobians.


\parbf{Linear algebra.}
Let $V$ be a finite dimensional real vector space, equipped with inner product $\<{*},{*}\>$.
Consider the norm on $V$ is defined as $|v|\df\sqrt{\<v,v\>}$.

We denote by \index{$V^{\wedge n}$}$V^{\wedge n}$ the $n$-th \index{exterior power}\emph{exterior power} of $V$;
that is,
\[V^{\wedge n}=\underbrace{V\wedge V\wedge\dots\wedge V}_{\mbox{$n$ times}}.\]

Note that the inner product
$\<{*},{*}\>$
on $V$
leads to canonical inner product on $V^{\wedge n}$.
This is the (necessary unique) inner product such that
\[\left\< v^1\wedge\cdots\wedge v^n, v^1\wedge\cdots\wedge v^n\right\> 
=
1\]
for any orthonormal system of vectors $v^1,\cdots,v^n$ in $V$.

Assume $W$ is an other finite dimensional real vector space, equipped with inner product.
Let $L\:V\to W$ be a linear operator.
Then one can consider \emph{operator norm} of $L$ defined as 
\[|L|\df\inf\set{c\ge 0}{|L(v)|\le c\cdot|v|\ \t{for any}\ v\in V}.\]
In other words, 
\[|L|=\lip L,\] 
where, $\lip L$ denotes the best Lipschitz constant of $L$.

The $n$-th exterior power of a  linear map $L\:V\to W$
is defined as the (necessary unique) 
linear map $L^{\wedge n}\:V^{\wedge n}\to W^{\wedge n}$
such that the following identity
\[
L^{\wedge n}(v^1\wedge v^2\wedge\dots\wedge v^n)
=
L(v^1)\wedge L(v^2)\wedge\dots\wedge L(v^n)
\]
holds for any $v^1,v^2,\dots, v^n\in V$.

Note that
\[|L^{\wedge n}|
=
\sup_A
\left\{
\vol_n [L(A)]
\right\}
\]
where $A$ runs along all $n$-dimesional parallelepipeds in $V$ 
with unit $n$-volume.


\parbf{Coarea formula.}
Let $\kay\ge m$ 
and $f\:\EE^\kay\subto\EE^m$ be smooth submap
then
\[
\int\limits_Q|(\dd_x f)^{\wedge m}|\cdot\dd_x\vol_\kay
=
\int\limits_{f(Q)}\vol_{\kay-m}( f^{-1}(y)\cap Q)\cdot\dd_y\vol_m.
\eqlbl{eq:coarea}
\]
for any Borel set $Q\subset \Dom f$.

The identity \ref{eq:coarea} is called  \emph{the coarea formula}; 
the right hand side in \ref{eq:coarea} is called \emph{the coarea of the restriction $f|Q$}.

The coarea formula is a standard result in multivariate calculus.
It admits a number of generalizations,
in particular Federer showed that this formula holds for  Lipschitz maps.
Namely he proved the following


\begin{thm}{Federer's coarea formula}\label{thm:coarea-federer}
Let $f\:\EE^\kay\subto\EE^m$ be a locally Lipschitz submap
then coarea formula \ref{eq:coarea} holds
for any Borel set $Q\subset \Dom f$.
\end{thm}

The case $\kay>m$ is proved in \cite[3.2.11]{federer}
and for $\kay=m$ it follows from \cite[3.2.3]{federer} since in this case 
$\vol_{\kay-m}=\vol_0$ is the counting measure.

The following exercise includes a version of the so called \index{Besicovitch inequality}\emph{Besicovitch inequality}.

\begin{thm}{Advanced exercise}
\label{ex:besicovitch-inq}
Let $\spc{X}$ be a metric space and 
$\map\:[0,1]^{\times m}\to \spc{X}$
be a continuous map.
Set 
\begin{align*}
A^i&=\set{(x^1,\dots,x^m)\in [0,1]^{\times m}}{x^i=0},
\\
B^i&=\set{(x^1,\dots,x^m)\in [0,1]^{\times m}}{x^i=1},
\\
a^i&=\dist{\map(A^i)}{\map(B^i)}{\spc{X}}
\end{align*}
\begin{subthm}{}
Show that
\[\LongMes_m (\Im\map) \ge a^1\cdot a^2\cdots a^m.\]
\end{subthm}
\begin{subthm}{}
Show that in general, the inequality
\[\vol_m (\Im\map) \ge a^1\cdot a^2\cdots a^m\]
does not hold.
\end{subthm}

\end{thm}












\section{Singularities of convex functions on $\RR^m$}%ready
\label{sec:sing-of-conv}

\begin{thm}{Definition}
 Let $\spc{X}$ be a metric space,
$E\subset \spc{X}$ and $n$ is an integer.
\begin{subthm}{}
The subset $E$ is called 
\emph{$n$-rectifiable}\index{rectifiable set}
if  there exists a noncontacting map from $E$ to a bounded subset in $\EE^n$
\end{subthm}

\begin{subthm}{}
Let $\Omega$ be an open subset in $\spc{X}$.
The subset $E$ is called 
\emph{locally $n$-rectifiable}\index{rectifiable set!locally rectifiable}
in $\Omega$
 if for any point $x\in \Omega$ there is a neigborhood $N\ni x$ such that $E\cap N$ is rectifible.
\end{subthm}

\begin{subthm}{}
The subset $E$ is called is called \emph{countably $n$-rectifiable}\index{rectifiable set!countably rectifiable} 
if it can be presented as a countable union of rectifible sets.
\end{subthm}

\end{thm}

The following proposition follows directly from definition above.

\begin{thm}{Proposition}\label{prop:finite-union-is-rectifiable}
A finite union of $n$-rectifiable sets is $n$-rectifiable.
\end{thm}

\begin{thm}{Exercise}
Give an example of a set $A$ in $\RR^m$ space with finite  
such that $\LongMes_\kay A<\infty$, but $A$ is not $\kay$-rectifiable
for some $\kay<m$.
\end{thm}

%??? We have to find where principle idea of this proof appears.
%Before Zaj\'{\i}\v{c}ek, I see the following refs:
%(1) K. Reidemeister: \"Uber die singul\"aren Randpunkte eines konvexen K\"orpers, Math. Ann. 55(1921), 116--118.
%(2) G. Durand: Sur une generalisation des surfaces convexes, J. Math. Pures Appl. (9), vol. 10 (1931), 335--414.
%(3)  Anderson and V. L. Klee, Jr.: Convex functions and upper semi-continuous collections, Duke Math. J. 19 (1952), 349--357.
%(4) A. S. Besicovitch: On singular points of convex surfaces, Convexity, Proceddings of Symposia in pure mathematics, Vol. VII, Providence, Rhode Island 1963. ???

Let $f\:\RR^m\subto\RR$ be a semiconvex subfunction.
In this case the differential 
\[\dd_xf\:\RR^m\subto\RR\] 
can be defined as the limit
\[\dd_xf(v)=\lim_{\eps\to0}\frac{f(x+\eps\cdot v)-f(x)}{\eps}.\]
It is defined for any $x\in \Dom f$ and it is a convex 
homogineus function;
that is,
\[\lam\cdot\dd_xf(v)=\dd_xf(\lam\cdot v)\]
for any 
$\lam\ge0$.

A point $x\in\Dom f$ is called 
\emph{regular point of $f$}\index{regular point of semiconvex function} 
if $\dd_xf$ is linear.
We say that $x$ is 
\emph{$\kay$-regular}\index{regular!$\kay$-regular} 
if $\dd_xf$ is linear on a $\kay$-dimensional subspace of $\RR^m$.
We say that $x$ is 
\emph{$(\kay,\eps)$-regular}\index{regular!$(\kay,\eps)$-regular}
if there is a  $\kay$-dimensional subspace $V$ of $\RR^m$ 
such that the restriction $\dd_xf|V$ is \emph{$\eps$-linear}\index{$\eps$-linear function};
that is, there is a linear function $\ell\:V\to\RR$ such that 
\[\ell(v)\le\dd_xf(v)< \ell(v)+\eps\cdot|v|\]
for any nonzero vector $v\in V$. 

The subsets of 
regular, 
$\kay$-regular, 
$(\kay,\eps)$-regular,
singular,
$\kay$-singular,
$(\kay,\eps)$-singular
of $\Dom f$
will be denoted as
$\Reg_f$,
$\Reg_f(\kay)$,
$\Reg_f(\kay,\eps)$,
$\Sing_f$,
$\Sing_f(\kay)$,
$\Sing_f(\kay,\eps)$
respectively.


\begin{thm}{Zaj\'{\i}\v{c}ek's theorem}\label{thm:zajicek}
Let $f\:\RR^m\subto\RR$ be a locally Lipschitz 
semiconvex subfunction.
Then for any $\kay\le m$ and $\eps>0$ the set 
$\Sing_f(\kay,\eps)$ is locally $(\kay-1)$-rectifiable in $\Dom f$.

In particular, for any $\kay\le m$, the set $\Sing_f(\kay)$ is countably $(\kay-1)$-rectifiable
and 
$\Sing_f$ is countably $(m-1)$-rectifiable.
\end{thm}

In the proof we will need the following definition.

\begin{thm}{Definition}
A function $f\:\RR^m\to\RR$ is called DC-function if it can be presented as a \emph{difference} $f=a-b$ of two \emph{convex} functions $a,b\:\RR^m\subto\RR$.

A map $\bm{f}=(f^1,\dots,f^\kay)\:\RR^m\to\RR^\kay$ is called DC-map if each of its coordinates $f^i$ is a DC-function.
\end{thm}

Since convex function are locally Lipschiz,
we get the following.

\begin{thm}{Proposition}\label{prop:DC=>loc-lip}
Any DC-function $f\:\RR^m\to\RR$ is locally Lipschitz.
\end{thm}

Further we repeat Zaj\'{\i}\v{c}ek's proof from \cite{zajicek}.
First we will show  that $\Sing_f(\kay,\eps)$ locally lies in a finite collection of graphs of 
DC-functions $\RR^{\kay-1}\to \RR^{m-k+1}$ and then apply Proposition~\ref{prop:DC=>loc-lip}.



\parit{Proof.}
Without loss of generality, we may assume that 
$\Dom f$ is convex bounded open set,
$f$ is $\lambda$-concave and  $\Lip$-Lipschitz for some for some $\lambda$ and $\Lip$.
Further, passing to a new function
 \[f_{\t{new}}(\bm{x})
\df
f(\bm{x})-\tfrac{\lambda}{2}\cdot\|\bm{x}\|_2^2,\] 
if nesessury, we may assume that $f$ is concave. 

Given a linear subspace $V\subset\RR^m$ 
and a linear function $\ell\:V\to\RR$ 
consider the envelop subfunction 
$h_{V,\ell}\:\RR^m\subto\RR$ defined as
\[h_{V, \ell}(\bm{x})
=
\sup
\set{f(\bm{x}+\bm{v})+\ell(\bm{v})}%
{\bm{v}\in V};\]
 $h_{V, \ell}$ is set to be defined at $\bm{x}$
if $\bm{x}+\bm{v}\in\Dom f$ for some $\bm{v}\in V$. 
Let us prove couple of claims.

\begin{clm}{}\label{h-for-zajicek}
The subfunction $h_{V,\ell}(\bm{x})$ is concave.
\end{clm}

Indeed, 
let $\bm{x}_0,\bm{x}_1\in\Dom h_{V,\ell}$. 
Set $\bm{x}_t=(1-t)\cdot\bm{x}_0+t\cdot\bm{x}_1$.
Clearly $x_t\in \Dom h_{V,\ell}$ for all $t\in[0,1]$.

Let us show that
\[h_{V, \ell}(\bm{x}_t)
\ge
(1-t)\cdot h_{V, \ell}(\bm{x}_0)
+
t\cdot h_{V, \ell}(\bm{x}_1).
\eqlbl{eq:Jensen-for-zajicek}\]

Fix $y_0,y_1\in\RR$ such that $y_i<h_{V, \ell}(\bm{x}_i)$ for $i\in\{1,2\}$.
Then there are $\bm{z}_0,\bm{z}_1\in\Dom f$ 
such that $\bm{z}_i-\bm{x}_i\in V$  
and
\[f(\bm{z}_i)+\ell(\bm{z}_i-\bm{x}_i)>y_i.\]
Set $\bm{z}_t=(1-t)\cdot\bm{z}_0+t\cdot\bm{z}_1$.
Clearly $\bm{z}_t-\bm{x}_t\in V$.
Since $\Dom f$ is convex,
$\bm{z}_t\in \Dom f$ for any $t\in[0,1]$. 
Thus
\begin{align*}
h_{V, \ell}(\bm{x}_t)&\ge f(\bm{z}_t)+\ell(\bm{z}_t-\bm{x}_t)
\ge
\\
&\ge(1-t)\cdot[f(\bm{z}_0)+\ell(\bm{z}_0-\bm{x}_0)]
+
t\cdot[f(\bm{z}_1)+\ell(\bm{z}_1-\bm{x}_1)]>
\\
&>(1-t)\cdot y_0+t\cdot y_1.
\end{align*}
Recall that the last inequality holds for any $y_0$ and $y_1$ such that $y_i\z<h_{V, \ell}(\bm{x}_i)$;
hence \ref{eq:Jensen-for-zajicek} follows.
\claimqeds

Let us show that

\begin{clm}{}\label{Zk-for-zajicek}
Let $V$ be a $n$-dimensional subspace of $\EE^m$
and $\bm{\ell}=(\ell^0,\ell^1,\dots\ell^n)\:V\to\RR^{n+1}$
be an array of linear functions such that 
$\ell^1,\dots,\ell^n$ are linearly independent and
$\ell^0+\ell^1+\dots+\ell^n=0$.
Then the  set $Z[V,\bm{\ell}]$ of all solutions of
\[h_{V, \ell^0}(\bm{x})
=
h_{V, \ell^1}(\bm{x})
=
\dots
=
h_{V, \ell^n}(\bm{x})
\] 
forms a subset of a graph of a $\DC$-submap $H\:V^\bot\subto V$.
\end{clm}

Indeed, set $h^i=h_{V,\ell^i}$.

Note that for fixed $\bm{x}\in V^\bot$ 
and 
$\bm{v}\in V$,
\[h^i(\bm{x}+\bm{v})
=
h^i(\bm{x})-\ell^i(\bm{v}).\]
It follows that for each $\bm{x}\in V^\bot$ there is  unique $\bm{v}\in V$ such that 
\[h^0(\bm{x}+\bm{v})
=
h^1(\bm{x}+\bm{v})
=
\dots
=
h^n(\bm{x}+\bm{v})
\eqlbl{eq:h_(V-ell)}
\] 
More over there is a linear operator $L\:\RR^{n+1}\to V$
such that \ref{eq:h_(V-ell)} hols for 
\[\bm{v}\z=L\circ\bm{h}(x).\]

Since the restrictions  $h^i|V^\bot$ are concave, 
we get that $\bm{x}\mapsto \bm{v}(\bm{x})$ is a DC-map. 
Applying Proposition~\ref{prop:DC=>loc-lip}, we get \ref{Zk-for-zajicek}.
\claimqeds

Note that for any point $z\in \Sing_f(\kay,\eps)$ there is a subspace $V$ of dimension $n\df m-\kay+1$
and an array of linear functions $\ell^0,\ell^1,\dots\ell^{n}$ as above such that $z\in Z(V,\bm{\ell})$.
Moreover any point $x\in \Dom f$ has a neigborhood $\oBall(\eps,x)$ such that 
all points in $\oBall(\eps,x)\cap\Sing_f(\kay,\eps)$ are covered by finite number of sets $Z(V,\bm{\ell})$ as above. %???WHY???
According to Claim~\ref{Zk-for-zajicek}, sets $Z(V,\bm{\ell})$ is $(\kay-1)$-rectifable.
According to Proposition~\ref{prop:finite-union-is-rectifiable},
$\Sing_f(\kay,\eps)$ is locally $(\kay-1)$-rectifable in $\Dom f$.

Since 
\[\Sing_f(\kay)=\bigcup_{n\in\ZZ_>}\Sing_f(\kay,\tfrac1n),\] 
the set $\Sing_f(\kay)$ is countably $(\kay-1)$-rectifable.
Since 
\[\Sing_f=\Sing_f(m),\]
the set $\Sing_f$ is countably $(m-1)$-rectifable.
\qeds
